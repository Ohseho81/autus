(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[385],{2067:e=>{"use strict";e.exports=require("node:async_hooks")},6195:e=>{"use strict";e.exports=require("node:buffer")},9346:(e,s,r)=>{"use strict";r.r(s),r.d(s,{ComponentMod:()=>T,default:()=>j});var t={};r.r(t),r.d(t,{GET:()=>y,OPTIONS:()=>p,POST:()=>h,PUT:()=>f,runtime:()=>m});var a={};r.r(a),r.d(a,{originalPathname:()=>v,patchFetch:()=>E,requestAsyncStorage:()=>k,routeModule:()=>x,serverHooks:()=>w,staticGenerationAsyncStorage:()=>O});var n=r(932),o=r(2561),i=r(4828),u=r(6631),c=r(9985),d=r(8621),l=r(8178);let m="edge",g={"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, PUT, DELETE, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization"};async function p(){return new c.xk(null,{status:200,headers:g})}async function y(e){try{let{searchParams:s}=new URL(e.url),r=s.get("userId"),t=s.get("id");if(t){let e=await d.db.getOrganism(t);if(!e)return c.xk.json({success:!1,error:"Organism not found"},{status:404,headers:g});let s={mint:e.mint,tax:e.tax,synergy:e.synergy,entropy:e.entropy,velocity:e.velocity,friction:e.friction};return c.xk.json({success:!0,data:{...e,computed_v:(0,l.q$)(e.mint,e.tax,e.synergy),summary:(0,l.wb)(s),recommended_impulse:(0,l.Kl)(s)}},{status:200,headers:g})}if(!r)return c.xk.json({success:!1,error:"userId is required"},{status:400,headers:g});let a=await d.db.getOrganisms(r);return c.xk.json({success:!0,data:a.map(e=>({...e,computed_v:(0,l.q$)(e.mint,e.tax,e.synergy)}))},{status:200,headers:g})}catch(e){return console.error("Organisms GET Error:",e),c.xk.json({success:!1,error:e.message},{status:500,headers:g})}}async function h(e){try{let{userId:s,name:t,type:a,emoji:n,mint:o,tax:i,synergy:u}=await e.json();if(!s||!t||!a)return c.xk.json({success:!1,error:"userId, name, type are required"},{status:400,headers:g});let{getSupabaseAdmin:d}=await Promise.resolve().then(r.bind(r,8621)),l=d(),{data:m,error:p}=await l.from("organisms").insert({user_id:s,name:t,type:a,emoji:n||"\uD83D\uDC64",mint:o||1e6,tax:i||5e5,synergy:u||.1,entropy:.3,velocity:.05,friction:.1,sync_rate:.7,status:"stable",urgency:.3}).select().single();if(p)return c.xk.json({success:!1,error:p.message},{status:500,headers:g});return c.xk.json({success:!0,data:m},{status:201,headers:g})}catch(e){return console.error("Organisms POST Error:",e),c.xk.json({success:!1,error:e.message},{status:500,headers:g})}}async function f(e){try{let{id:s,...r}=await e.json();if(!s)return c.xk.json({success:!1,error:"id is required"},{status:400,headers:g});if(void 0!==r.mint||void 0!==r.tax||void 0!==r.synergy){let e=await d.db.getOrganism(s);e&&(r.value_v=(0,l.q$)(r.mint??e.mint,r.tax??e.tax,r.synergy??e.synergy))}if(!await d.db.updateOrganism(s,r))return c.xk.json({success:!1,error:"Update failed"},{status:500,headers:g});let t=await d.db.getOrganism(s);return c.xk.json({success:!0,data:t},{status:200,headers:g})}catch(e){return console.error("Organisms PUT Error:",e),c.xk.json({success:!1,error:e.message},{status:500,headers:g})}}let x=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/organisms/route",pathname:"/api/organisms",filename:"route",bundlePath:"app/api/organisms/route"},resolvedPagePath:"/Users/oseho/Desktop/autus/vercel-api/app/api/organisms/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:k,staticGenerationAsyncStorage:O,serverHooks:w}=x,v="/api/organisms/route";function E(){return(0,u.XH)({serverHooks:w,staticGenerationAsyncStorage:O})}let T=a,j=n.a.wrap(x)}},e=>{var s=s=>e(e.s=s);e.O(0,[546,956,629],()=>s(9346));var r=e.O();(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_app/api/organisms/route"]=r}]);
//# sourceMappingURL=route.js.map