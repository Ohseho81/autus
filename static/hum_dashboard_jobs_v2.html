<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AUTUS OS · HUM Dashboard – Jobs Edition v2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #050711; --bg-card: #101522; --accent: #38bdf8; --accent-warm: #f97316;
      --text-main: #f9fafb; --text-muted: #9ca3af; --radius-card: 18px; --radius-pill: 999px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.75);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: system-ui, -apple-system, sans-serif; background: radial-gradient(circle at top, #111827 0, #020617 55%, #000 100%); color: var(--text-main); min-height: 100vh; display: flex; justify-content: center; padding: 24px; }
    .page { width: 100%; max-width: 1200px; background: linear-gradient(145deg, var(--bg) 0%, #020617 100%); border-radius: 28px; box-shadow: var(--shadow-soft); padding: 22px 24px 26px; border: 1px solid rgba(148, 163, 184, 0.35); display: flex; flex-direction: column; gap: 18px; }
    .page-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(31, 41, 55, 0.9); padding-bottom: 14px; }
    .brand { display: flex; align-items: center; gap: 8px; font-size: 13px; letter-spacing: 0.16em; text-transform: uppercase; color: var(--text-muted); }
    .brand-mark { width: 22px; height: 22px; border-radius: 7px; background: radial-gradient(circle at 30% 20%, #f97316, #0ea5e9 65%, #0f172a 100%); }
    .header-right { display: flex; align-items: center; gap: 16px; }
    .route-pill { padding: 5px 11px; border-radius: var(--radius-pill); background: rgba(15, 23, 42, 0.8); border: 1px solid rgba(148, 163, 184, 0.4); font-size: 11px; color: var(--text-muted); display: flex; align-items: center; gap: 6px; }
    .route-pill .code { font-weight: 600; color: var(--text-main); }
    .success-chip { display: flex; align-items: baseline; gap: 4px; padding: 4px 10px; border-radius: var(--radius-pill); background: rgba(15, 23, 42, 0.85); border: 1px solid rgba(56, 189, 248, 0.5); font-size: 11px; color: var(--accent); }
    .success-chip strong { font-size: 13px; font-weight: 600; color: var(--text-main); }
    .page-main { display: grid; grid-template-columns: 1.7fr 1.3fr; gap: 18px; }
    @media (max-width: 900px) { .page-main { grid-template-columns: 1fr; } }
    .left-column, .right-column { display: flex; flex-direction: column; gap: 14px; }
    .identity-card { background: radial-gradient(circle at top left, #111827 0, var(--bg-card) 50%, #020617 100%); border-radius: var(--radius-card); border: 1px solid rgba(148, 163, 184, 0.55); padding: 14px 16px; display: flex; justify-content: space-between; align-items: center; }
    .identity-main { display: flex; gap: 12px; align-items: center; }
    .avatar { width: 42px; height: 42px; border-radius: 14px; background: linear-gradient(135deg, #38bdf8, #0f172a); display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: 600; color: #e5faff; }
    .id-texts { display: flex; flex-direction: column; gap: 2px; }
    .id-label { font-size: 11px; text-transform: uppercase; letter-spacing: 0.18em; color: var(--text-muted); }
    .id-name { font-size: 17px; font-weight: 600; }
    .id-role { font-size: 12px; color: var(--text-muted); }
    .status-pill { padding: 4px 10px; border-radius: var(--radius-pill); background: rgba(22, 163, 74, 0.16); border: 1px solid rgba(22, 163, 74, 0.5); font-size: 11px; color: #bbf7d0; }
    .phase-card, .timeline-card, .risk-card { background: var(--bg-card); border-radius: var(--radius-card); border: 1px solid rgba(148, 163, 184, 0.45); padding: 12px 14px; display: flex; flex-direction: column; gap: 10px; }
    .section-title { font-size: 12px; text-transform: uppercase; letter-spacing: 0.12em; color: var(--text-muted); display: flex; justify-content: space-between; align-items: center; }
    .section-title .badge { padding: 2px 8px; border-radius: var(--radius-pill); border: 1px solid rgba(148, 163, 184, 0.55); font-size: 10px; }
    .phase-progress-row { display: flex; align-items: center; gap: 10px; }
    .phase-progress-bar-wrapper { flex: 1; height: 8px; border-radius: 999px; background: rgba(15, 23, 42, 0.9); overflow: hidden; }
    .phase-progress-bar { height: 100%; background: linear-gradient(90deg, #f97316, #facc15); transition: width 0.5s; }
    .pill-row { display: flex; flex-wrap: wrap; gap: 8px; }
    .mini-pill { padding: 3px 9px; border-radius: var(--radius-pill); background: rgba(15, 23, 42, 0.85); border: 1px solid rgba(148, 163, 184, 0.5); font-size: 11px; color: var(--text-muted); }
    .mini-pill strong { color: var(--text-main); margin-left: 4px; }
    .timeline-steps { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; }
    .timeline-step { padding: 6px 8px; border-radius: 12px; background: rgba(15, 23, 42, 0.9); border: 1px solid rgba(31, 41, 55, 0.9); font-size: 11px; color: var(--text-muted); }
    .timeline-step .label { font-size: 10px; text-transform: uppercase; letter-spacing: 0.14em; display: block; }
    .timeline-step .name { color: var(--text-main); }
    .timeline-step.current { border-color: var(--accent); background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.25), rgba(15, 23, 42, 0.95)); }
    .timeline-step.next { border-style: dashed; border-color: rgba(56, 189, 248, 0.55); }
    .success-ring-card { background: var(--bg-card); border-radius: var(--radius-card); border: 1px solid rgba(148, 163, 184, 0.6); padding: 14px; display: flex; gap: 10px; align-items: center; }
    .success-ring { width: 110px; height: 110px; border-radius: 50%; background: conic-gradient(from 220deg, #22c55e 0 20%, #f97316 20% 60%, #ef4444 60% 100%); padding: 12px; display: flex; align-items: center; justify-content: center; }
    .success-ring-inner { width: 100%; height: 100%; border-radius: 50%; background: #020617; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    .success-ring-inner .label { font-size: 10px; text-transform: uppercase; letter-spacing: 0.18em; color: var(--text-muted); }
    .success-ring-inner .value { font-size: 22px; font-weight: 600; }
    .success-info { flex: 1; }
    .success-info h2 { font-size: 13px; text-transform: uppercase; letter-spacing: 0.16em; color: var(--text-muted); margin-bottom: 6px; }
    .vector-bars { display: flex; flex-direction: column; gap: 4px; }
    .vector-row { display: flex; align-items: center; gap: 6px; font-size: 11px; }
    .vector-label { width: 26px; color: var(--text-muted); }
    .vector-bar { flex: 1; height: 6px; border-radius: 999px; background: rgba(15, 23, 42, 0.95); overflow: hidden; }
    .vector-fill { height: 100%; border-radius: 999px; background: linear-gradient(90deg, #38bdf8, #a855f7); transition: width 0.5s; }
    .vector-value { width: 30px; text-align: right; color: var(--text-muted); }
    .risk-row { display: flex; justify-content: space-between; font-size: 12px; color: var(--text-muted); }
    .risk-level-chip { padding: 3px 9px; border-radius: var(--radius-pill); border: 1px solid rgba(248, 113, 113, 0.6); color: #fecaca; background: rgba(127, 29, 29, 0.4); font-size: 11px; }
    .risk-tags { display: flex; flex-wrap: wrap; gap: 6px; }
    .risk-tag { padding: 3px 8px; border-radius: 12px; background: rgba(15, 23, 42, 0.9); border: 1px solid rgba(148, 163, 184, 0.4); font-size: 11px; color: var(--text-muted); }
    .actions-card { background: radial-gradient(circle at top left, #0b1120 0, #020617 100%); border-radius: var(--radius-card); border: 1px solid rgba(148, 163, 184, 0.55); padding: 12px 14px; }
    .actions-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 10px; }
    .action-card { border-radius: 14px; border: 1px solid rgba(148, 163, 184, 0.55); background: rgba(15, 23, 42, 0.98); padding: 8px 9px; cursor: pointer; transition: all 0.2s; }
    .action-card:hover { border-color: var(--accent); transform: translateY(-2px); }
    .action-card-header { display: flex; justify-content: space-between; font-size: 10px; margin-bottom: 4px; }
    .action-label { text-transform: uppercase; letter-spacing: 0.14em; color: var(--text-muted); }
    .action-impact { color: var(--accent); }
    .action-impact.high { color: #22c55e; }
    .action-impact.medium { color: #f97316; }
    .action-copy { font-size: 11px; color: var(--text-muted); line-height: 1.4; margin-bottom: 8px; }
    .action-cta-row { display: flex; gap: 6px; }
    .action-button { padding: 4px 10px; border-radius: var(--radius-pill); border: none; background: var(--accent); color: #020617; font-size: 11px; font-weight: 600; cursor: pointer; }
    .action-button.secondary { background: transparent; color: var(--text-muted); border: 1px solid rgba(148, 163, 184, 0.6); }
    .page-footer { display: flex; justify-content: space-between; font-size: 10px; color: var(--text-muted); border-top: 1px solid rgba(15, 23, 42, 0.9); padding-top: 8px; }
    .notification { position: fixed; bottom: 20px; right: 20px; padding: 12px 20px; border-radius: 12px; color: white; font-size: 13px; font-weight: 500; z-index: 1000; animation: slideIn 0.3s ease; }
    .notification.success { background: #22c55e; }
    .notification.error { background: #ef4444; }
    @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
  </style>
</head>
<body>
  <main class="page">
    <header class="page-header">
      <div class="brand"><div class="brand-mark"></div><span>AUTUS OS · HUM</span> · Jobs Edition v2</div>
      <div class="header-right">
        <div class="route-pill"><span class="code">PH027</span> PH → KR · Healthcare Assistant</div>
        <div class="success-chip">Success <strong id="success-rate">19.1%</strong></div>
      </div>
    </header>

    <section class="page-main">
      <div class="left-column">
        <section class="identity-card">
          <div class="identity-main">
            <div class="avatar">M</div>
            <div class="id-texts">
              <span class="id-label">HUM Spotlight</span>
              <span class="id-name">Maria Santos</span>
              <span class="id-role">Candidate · Healthcare Assistant</span>
            </div>
          </div>
          <div class="status-pill">● Phase: Placement · Active</div>
        </section>

        <section class="phase-card">
          <div class="section-title"><span>Journey Phase</span><span class="badge" id="phase-badge">Phase 71% · LIME 29</span></div>
          <div class="phase-progress-row">
            <div class="phase-progress-bar-wrapper"><div class="phase-progress-bar" id="phase-bar" style="width:71%"></div></div>
            <span style="font-size:12px;color:var(--text-muted)" id="phase-value">71%</span>
          </div>
          <div class="pill-row" id="vector-pills">
            <div class="mini-pill">DIR<strong>33%</strong></div>
            <div class="mini-pill">FOR<strong>40%</strong></div>
            <div class="mini-pill">GAP<strong>71%</strong></div>
            <div class="mini-pill">UNC<strong>60%</strong></div>
            <div class="mini-pill">TEM<strong>50%</strong></div>
            <div class="mini-pill">INT<strong>27%</strong></div>
          </div>
        </section>

        <section class="timeline-card">
          <div class="section-title"><span>Journey Timeline</span><span class="badge">Bottleneck: VISA</span></div>
          <div class="timeline-steps">
            <div class="timeline-step"><span class="label">Hum</span><span class="name">Created</span></div>
            <div class="timeline-step"><span class="label">Edu</span><span class="name">Training</span></div>
            <div class="timeline-step current"><span class="label">Emp</span><span class="name">Matched</span></div>
            <div class="timeline-step next"><span class="label">Gov</span><span class="name">Visa</span></div>
            <div class="timeline-step"><span class="label">Emp</span><span class="name">Started</span></div>
            <div class="timeline-step"><span class="label">Soc</span><span class="name">Community</span></div>
          </div>
        </section>
      </div>

      <div class="right-column">
        <section class="success-ring-card">
          <div class="success-ring"><div class="success-ring-inner"><span class="label">Success</span><span class="value" id="success-ring">19.1%</span></div></div>
          <div class="success-info">
            <h2>6D Vector · Lime v3</h2>
            <div class="vector-bars" id="vector-bars">
              <div class="vector-row"><span class="vector-label">DIR</span><div class="vector-bar"><div class="vector-fill" id="bar-dir" style="width:33%"></div></div><span class="vector-value" id="val-dir">33</span></div>
              <div class="vector-row"><span class="vector-label">FOR</span><div class="vector-bar"><div class="vector-fill" id="bar-for" style="width:40%"></div></div><span class="vector-value" id="val-for">40</span></div>
              <div class="vector-row"><span class="vector-label">GAP</span><div class="vector-bar"><div class="vector-fill" id="bar-gap" style="width:71%;background:#f97316"></div></div><span class="vector-value" id="val-gap">71</span></div>
              <div class="vector-row"><span class="vector-label">UNC</span><div class="vector-bar"><div class="vector-fill" id="bar-unc" style="width:60%;background:#eab308"></div></div><span class="vector-value" id="val-unc">60</span></div>
              <div class="vector-row"><span class="vector-label">TEM</span><div class="vector-bar"><div class="vector-fill" id="bar-tem" style="width:50%"></div></div><span class="vector-value" id="val-tem">50</span></div>
              <div class="vector-row"><span class="vector-label">INT</span><div class="vector-bar"><div class="vector-fill" id="bar-int" style="width:27%"></div></div><span class="vector-value" id="val-int">27</span></div>
            </div>
          </div>
        </section>

        <section class="risk-card">
          <div class="section-title"><span>Risk & Readiness</span><span class="badge">OS Score: 62</span></div>
          <div class="risk-row"><span>Risk level</span><span class="risk-level-chip">Medium · Visa-heavy</span></div>
          <div class="risk-tags">
            <span class="risk-tag">High GAP (71)</span>
            <span class="risk-tag">Uncertainty (60)</span>
            <span class="risk-tag">Low INT (27)</span>
          </div>
        </section>

        <section class="actions-card">
          <div class="section-title"><span>Next Best Action</span><span class="badge">AI · Lime v3</span></div>
          <div class="actions-grid">
            <div class="action-card" data-action="visa">
              <div class="action-card-header"><span class="action-label">Visa</span><span class="action-impact high">▲ High</span></div>
              <div class="action-copy">Submit visa documents. Reduces UNC and GAP.</div>
              <div class="action-cta-row"><button class="action-button">Apply</button></div>
            </div>
            <div class="action-card" data-action="employment">
              <div class="action-card-header"><span class="action-label">Employment</span><span class="action-impact medium">▲ Med</span></div>
              <div class="action-copy">Lock start date with employer.</div>
              <div class="action-cta-row"><button class="action-button">Apply</button></div>
            </div>
            <div class="action-card" data-action="training">
              <div class="action-card-header"><span class="action-label">Training</span><span class="action-impact medium">▲ Med</span></div>
              <div class="action-copy">Assign KR-specific module.</div>
              <div class="action-cta-row"><button class="action-button">Apply</button></div>
            </div>
            <div class="action-card" data-action="community">
              <div class="action-card-header"><span class="action-label">Community</span><span class="action-impact">▲ Long</span></div>
              <div class="action-copy">Connect to KR caregiver community.</div>
              <div class="action-cta-row"><button class="action-button">Apply</button></div>
            </div>
          </div>
        </section>
      </div>
    </section>

    <footer class="page-footer">
      <span>Now: EMP Matched → Next: GOV Visa</span>
      <span>AUTUS HUM Kernel v3</span>
    </footer>
  </main>

  <script>
    const API = window.location.origin;
    const HUM = 'PH027';

    const events = {
      visa: { source: 'GOV', code: 'GOV:VisaApproved', delta: { DIR: 0.20, UNC: -0.25, FOR: 0.15 } },
      employment: { source: 'EMP', code: 'EMP:Started', delta: { DIR: 0.15, FOR: 0.20, INT: 0.15 } },
      training: { source: 'EDU', code: 'EDU:Completed', delta: { DIR: 0.15, GAP: -0.20, UNC: -0.15, INT: 0.10 } },
      community: { source: 'SOC', code: 'SOC:CommunityJoined', delta: { INT: 0.25, GAP: -0.15 } }
    };

    function notify(msg, type) {
      const el = document.createElement('div');
      el.className = 'notification ' + type;
      el.textContent = msg;
      document.body.appendChild(el);
      setTimeout(() => el.remove(), 3000);
    }

    function updateUI(vector, success) {
      ['dir','for','gap','unc','tem','int'].forEach(k => {
        const v = vector[k.toUpperCase()] || 0;
        const pct = Math.round(v * 100);
        document.getElementById('bar-' + k).style.width = pct + '%';
        document.getElementById('val-' + k).textContent = pct;
      });
      document.getElementById('success-rate').textContent = success.toFixed(1) + '%';
      document.getElementById('success-ring').textContent = success.toFixed(1) + '%';
      
      const pills = ['DIR','FOR','GAP','UNC','TEM','INT'].map(k => {
        const v = Math.round((vector[k] || 0) * 100);
        return '<div class="mini-pill">' + k + '<strong>' + v + '%</strong></div>';
      }).join('');
      document.getElementById('vector-pills').innerHTML = pills;
    }

    async function applyAction(type) {
      const e = events[type];
      if (!e) return;
      
      try {
        const res = await fetch(API + '/kernel/lime/v3/event/apply', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            hum_id: HUM,
            source: e.source,
            event_code: e.code,
            event_delta: e.delta,
            days_since_last: 7
          })
        });
        const data = await res.json();
        if (data.vectors && data.vectors.after) {
          updateUI(data.vectors.after, data.analysis?.success_probability || 20);
          notify(e.code + ' applied! Success: ' + (data.analysis?.success_probability || 20).toFixed(1) + '%', 'success');
        }
      } catch (err) {
        console.error(err);
        notify('Error: ' + err.message, 'error');
      }
    }

    document.querySelectorAll('.action-card').forEach(card => {
      card.addEventListener('click', function() {
        const action = this.getAttribute('data-action');
        applyAction(action);
      });
    });
  </script>
</body>
</html>
