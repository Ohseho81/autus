{
  "name": "AUTUS ERP ë™ê¸°í™” (í•™ì›ë‚˜ë¼ â†’ Supabase)",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours",
              "hoursInterval": 1
            }
          ]
        }
      },
      "id": "schedule-trigger",
      "name": "â° ë§¤ì‹œê°„ ì‹¤í–‰",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [220, 300]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "https://api.hagnara.com/v1/students",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpBasicAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-Academy-ID",
              "value": "={{ $env.HAGNARA_ACADEMY_ID }}"
            }
          ]
        },
        "options": {
          "timeout": 30000
        }
      },
      "id": "hagnara-students",
      "name": "ğŸ“š í•™ì›ë‚˜ë¼ í•™ìƒ ëª©ë¡",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [440, 200],
      "notesInFlow": true,
      "notes": "í•™ì›ë‚˜ë¼ APIì—ì„œ í•™ìƒ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°"
    },
    {
      "parameters": {
        "method": "GET",
        "url": "https://api.hagnara.com/v1/payments",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpBasicAuth",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "status",
              "value": "overdue"
            }
          ]
        },
        "options": {
          "timeout": 30000
        }
      },
      "id": "hagnara-payments",
      "name": "ğŸ’³ ë¯¸ë‚© ëª©ë¡ ì¡°íšŒ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [440, 400],
      "notesInFlow": true,
      "notes": "ë¯¸ë‚© í•™ìƒ ëª©ë¡"
    },
    {
      "parameters": {
        "jsCode": "// í•™ìƒ ë°ì´í„°ë¥¼ AUTUS í˜•ì‹ìœ¼ë¡œ ë³€í™˜\nconst students = $input.all().map(item => item.json);\n\nconst transformed = students.map(student => ({\n  id: student.student_id,\n  name: student.name,\n  grade: student.grade,\n  attendance_rate: parseFloat(student.attendance_rate || 100),\n  homework_rate: parseFloat(student.homework_submission_rate || 100),\n  grade_trend: parseFloat(student.grade_change || 0),\n  payment_status: student.payment_status || 'paid'\n}));\n\nreturn [{\n  json: {\n    event_type: 'erp_sync',\n    source: 'hagnara_sync_workflow',\n    timestamp: new Date().toISOString(),\n    data: {\n      academy_id: $env.AUTUS_ACADEMY_ID,\n      students: transformed,\n      sync_type: 'students'\n    }\n  }\n}];"
      },
      "id": "transform-students",
      "name": "ğŸ”„ í•™ìƒ ë°ì´í„° ë³€í™˜",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [660, 200]
    },
    {
      "parameters": {
        "jsCode": "// ë¯¸ë‚© ë°ì´í„°ë¥¼ AUTUS í˜•ì‹ìœ¼ë¡œ ë³€í™˜\nconst payments = $input.all().map(item => item.json);\n\nconst overdueItems = payments.map(p => ({\n  student_id: p.student_id,\n  student_name: p.student_name,\n  amount_due: parseFloat(p.amount),\n  days_overdue: parseInt(p.days_overdue || 0),\n  due_date: p.due_date\n}));\n\n// ê°œë³„ ë¯¸ë‚© ì•Œë¦¼ ìƒì„±\nconst alerts = overdueItems.map(item => ({\n  json: {\n    event_type: 'payment_overdue',\n    source: 'hagnara_sync_workflow',\n    timestamp: new Date().toISOString(),\n    data: item\n  }\n}));\n\nreturn alerts.length > 0 ? alerts : [{ json: { skip: true } }];"
      },
      "id": "transform-payments",
      "name": "ğŸ”„ ë¯¸ë‚© ë°ì´í„° ë³€í™˜",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [660, 400]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "leftValue": "={{ $json.skip }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        }
      },
      "id": "filter-empty",
      "name": "ğŸ” ë¹ˆ ë°ì´í„° í•„í„°",
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2,
      "position": [880, 400]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $env.AUTUS_WEBHOOK_URL || 'https://vercel-8w2fohodh-ohsehos-projects.vercel.app/api/webhook/n8n' }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "X-Webhook-Secret",
              "value": "={{ $env.N8N_WEBHOOK_SECRET }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify($json) }}",
        "options": {
          "timeout": 30000
        }
      },
      "id": "webhook-students",
      "name": "ğŸš€ AUTUS í•™ìƒ ë™ê¸°í™”",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [880, 200]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $env.AUTUS_WEBHOOK_URL || 'https://vercel-8w2fohodh-ohsehos-projects.vercel.app/api/webhook/n8n' }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "X-Webhook-Secret",
              "value": "={{ $env.N8N_WEBHOOK_SECRET }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify($json) }}",
        "options": {
          "timeout": 30000
        }
      },
      "id": "webhook-payments",
      "name": "ğŸš€ AUTUS ë¯¸ë‚© ì•Œë¦¼",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1100, 400]
    },
    {
      "parameters": {
        "channel": "#autus-alerts",
        "text": "âœ… AUTUS ERP ë™ê¸°í™” ì™„ë£Œ\n\ní•™ìƒ ë™ê¸°í™”: {{ $json.data?.result?.students_updated || 0 }}ëª…\në¯¸ë‚© ì•Œë¦¼: {{ $('webhook-payments').json?.data?.result?.days_overdue ? 'ë°œì†¡ë¨' : 'ì—†ìŒ' }}\n\nì‹œê°„: {{ new Date().toLocaleString('ko-KR') }}",
        "otherOptions": {}
      },
      "id": "slack-notify",
      "name": "ğŸ“¢ Slack ì•Œë¦¼",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.2,
      "position": [1100, 200],
      "credentials": {
        "slackApi": {
          "id": "slack-cred",
          "name": "Slack Account"
        }
      }
    }
  ],
  "connections": {
    "â° ë§¤ì‹œê°„ ì‹¤í–‰": {
      "main": [
        [
          {
            "node": "ğŸ“š í•™ì›ë‚˜ë¼ í•™ìƒ ëª©ë¡",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸ’³ ë¯¸ë‚© ëª©ë¡ ì¡°íšŒ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“š í•™ì›ë‚˜ë¼ í•™ìƒ ëª©ë¡": {
      "main": [
        [
          {
            "node": "ğŸ”„ í•™ìƒ ë°ì´í„° ë³€í™˜",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ’³ ë¯¸ë‚© ëª©ë¡ ì¡°íšŒ": {
      "main": [
        [
          {
            "node": "ğŸ”„ ë¯¸ë‚© ë°ì´í„° ë³€í™˜",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”„ í•™ìƒ ë°ì´í„° ë³€í™˜": {
      "main": [
        [
          {
            "node": "ğŸš€ AUTUS í•™ìƒ ë™ê¸°í™”",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”„ ë¯¸ë‚© ë°ì´í„° ë³€í™˜": {
      "main": [
        [
          {
            "node": "ğŸ” ë¹ˆ ë°ì´í„° í•„í„°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” ë¹ˆ ë°ì´í„° í•„í„°": {
      "main": [
        [
          {
            "node": "ğŸš€ AUTUS ë¯¸ë‚© ì•Œë¦¼",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸš€ AUTUS í•™ìƒ ë™ê¸°í™”": {
      "main": [
        [
          {
            "node": "ğŸ“¢ Slack ì•Œë¦¼",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": ""
  },
  "staticData": null,
  "tags": [
    {
      "name": "AUTUS",
      "id": "autus-tag"
    },
    {
      "name": "ERP Sync",
      "id": "erp-tag"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2026-01-20T12:00:00.000Z",
  "versionId": "1"
}
