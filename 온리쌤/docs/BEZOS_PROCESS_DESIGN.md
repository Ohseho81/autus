# 🔵 온리쌤 프로세스 설계서 (베조스 방식)

## 핵심 원칙

> "고객 경험의 모든 마찰을 제거하라. 측정할 수 없으면 개선할 수 없다."
> — Jeff Bezos

---

## 1️⃣ 출석 체크 프로세스 (촘촘한 단계별 정의)

### Customer Journey Map

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 학생 도착 Journey (16단계)                                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  [사전]                                                                     │
│  ① 수업 24시간 전 → 리마인더 알림 발송                                       │
│  ② 수업 2시간 전 → 출발 알림 발송                                            │
│  ③ 학부모 앱에서 "출발" 버튼 터치 (선택)                                      │
│  ④ 예상 도착 시간 계산 (거리 기반)                                           │
│                                                                             │
│  [도착]                                                                     │
│  ⑤ 체육관 반경 100m 진입 감지 (위치 기반, 선택)                              │
│  ⑥ 학생 키오스크에서 출석번호 입력                                           │
│  ⑦ 시스템이 학생 정보 조회 (0.3초 이내)                                      │
│  ⑧ 출석 유효성 검증 (수업 시간, 등록 여부)                                   │
│  ⑨ 출석 상태 업데이트 (DB 저장)                                             │
│  ⑩ 성공/실패 피드백 (진동 + 화면 표시)                                       │
│                                                                             │
│  [알림]                                                                     │
│  ⑪ 학부모 앱 실시간 알림 발송 (0.5초 이내)                                   │
│  ⑫ 카카오톡 알림 발송 (3초 이내)                                            │
│  ⑬ 코치 대시보드 실시간 업데이트                                            │
│                                                                             │
│  [후처리]                                                                   │
│  ⑭ 회차 차감 처리 (오픈반의 경우)                                           │
│  ⑮ 출석 통계 업데이트                                                       │
│  ⑯ 출석 로그 저장 (감사 추적용)                                             │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 측정 지표 (Metrics)

| 지표 | 목표 | 측정 방법 |
|------|------|----------|
| 출석 체크 소요 시간 | < 3초 | 번호 입력 ~ 완료까지 |
| 알림 도달 시간 | < 5초 | 체크 완료 ~ 학부모 수신 |
| 시스템 오류율 | < 0.1% | 실패 건수 / 전체 건수 |
| 학부모 확인율 | > 80% | 알림 읽음 / 발송 |

### 예외 처리 (Edge Cases)

```typescript
enum AttendanceError {
  INVALID_NUMBER = 'E001',      // 잘못된 출석번호
  NOT_ENROLLED = 'E002',        // 미등록 학생
  WRONG_CLASS = 'E003',         // 다른 수업 시간
  ALREADY_CHECKED = 'E004',     // 이미 출석 완료
  SESSION_EXPIRED = 'E005',     // 수업 종료됨
  PAYMENT_OVERDUE = 'E006',     // 미납 상태
  SESSIONS_DEPLETED = 'E007',   // 회차 소진
  SYSTEM_ERROR = 'E999',        // 시스템 오류
}

// 각 에러별 처리 방안
const errorHandlers = {
  E001: '출석번호를 다시 확인해주세요',
  E002: '등록되지 않은 학생입니다. 데스크에 문의하세요',
  E003: '현재 시간에 배정된 수업이 없습니다',
  E004: '이미 출석 처리되었습니다',
  E005: '수업이 이미 종료되었습니다',
  E006: '수강료 미납 상태입니다. 데스크에 문의하세요',
  E007: '잔여 회차가 없습니다. 충전이 필요합니다',
  E999: '시스템 오류입니다. 잠시 후 다시 시도하세요',
};
```

---

## 2️⃣ 결석 처리 프로세스 (촘촘한 단계별 정의)

### 결석 감지 → 처리 Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 결석 처리 Journey (20단계)                                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  [감지 단계]                                                                │
│  ① 수업 시작 10분 전: 미출석 학생 목록 생성                                  │
│  ② 수업 시작 시점: 미출석자 확정                                            │
│  ③ 수업 시작 +5분: "지각 가능" 상태로 전환                                   │
│  ④ 수업 시작 +15분: "결석 확정" 상태로 전환                                  │
│                                                                             │
│  [알림 단계]                                                                │
│  ⑤ +5분: 학부모에게 "출석 미확인" 알림                                       │
│  ⑥ +15분: 학부모에게 "결석 처리됨" 알림                                      │
│  ⑦ 코치 대시보드에 결석자 표시 (빨간색)                                      │
│  ⑧ 관리자 대시보드에 결석 통계 업데이트                                      │
│                                                                             │
│  [학부모 응답 처리]                                                         │
│  ⑨ 학부모가 "사전 결석 신고" 한 경우                                        │
│     → 보강권 자동 발급                                                      │
│     → 결석 사유 기록                                                        │
│  ⑩ 학부모가 무응답인 경우                                                   │
│     → 24시간 후 2차 알림                                                    │
│     → 48시간 후 상담 전화 필요 플래그                                        │
│                                                                             │
│  [후처리]                                                                   │
│  ⑪ 결석 패턴 분석 (AI)                                                     │
│     - 연속 결석 체크                                                        │
│     - 특정 요일 결석 패턴                                                   │
│     - 이탈 위험도 계산                                                      │
│  ⑫ 이탈 위험 학생 관리자 알림                                               │
│  ⑬ 월간 출석 리포트 반영                                                    │
│  ⑭ 보강 가능 기간 설정 (결석일로부터 30일)                                   │
│                                                                             │
│  [보강 처리]                                                                │
│  ⑮ 학부모가 보강 신청                                                       │
│  ⑯ 가능한 보강 수업 목록 제공                                               │
│  ⑰ 보강 예약 확정                                                          │
│  ⑱ 보강 수업 리마인더 발송                                                  │
│  ⑲ 보강 출석 처리                                                          │
│  ⑳ 보강권 차감 및 기록 완료                                                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 3️⃣ 결제 프로세스 (촘촘한 단계별 정의)

### Payment Flywheel (선순환 구조)

```
        ┌──────────────┐
        │   쉬운 결제   │
        └──────┬───────┘
               │
               ▼
   ┌───────────────────────┐
   │ 회차 충분 → 출석 용이  │
   └───────────┬───────────┘
               │
               ▼
      ┌────────────────┐
      │  꾸준한 출석    │
      └───────┬────────┘
              │
              ▼
    ┌──────────────────┐
    │ 실력 향상 → 만족  │
    └────────┬─────────┘
             │
             ▼
       ┌───────────┐
       │  재결제   │ ←──────┐
       └─────┬─────┘        │
             │              │
             └──────────────┘
```

### 결제 Journey (25단계)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 결제 처리 Journey                                                           │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  [예측 및 안내]                                                             │
│  ① 잔여 회차 5회: 1차 안내 (앱 내 배너)                                      │
│  ② 잔여 회차 3회: 2차 안내 (카카오 알림)                                     │
│  ③ 잔여 회차 1회: 3차 안내 (긴급 알림 + 할인 제안)                           │
│  ④ 잔여 회차 0회: 수업 참여 시 현장 결제 안내                                │
│                                                                             │
│  [결제 요청]                                                                │
│  ⑤ 학부모가 결제 버튼 터치                                                  │
│  ⑥ 결제 상품 선택 (10회/20회/무제한)                                        │
│  ⑦ 할인/프로모션 자동 적용                                                  │
│  ⑧ 최종 금액 확인                                                          │
│  ⑨ 결제 수단 선택                                                          │
│                                                                             │
│  [결제 처리]                                                                │
│  ⑩ PG사 결제 요청                                                          │
│  ⑪ 결제 승인 대기 (타임아웃: 5분)                                           │
│  ⑫ 결제 결과 수신                                                          │
│  ⑬ 성공 시: 회차 충전 + 영수증 발급                                         │
│  ⑭ 실패 시: 실패 사유 안내 + 재시도 유도                                     │
│                                                                             │
│  [결제 완료 후]                                                             │
│  ⑮ 학부모 앱에 결제 완료 표시                                               │
│  ⑯ 카카오 알림 발송 (영수증 포함)                                           │
│  ⑰ 관리자 대시보드 수납 현황 업데이트                                        │
│  ⑱ 회계 시스템 연동 (일매출 집계)                                           │
│                                                                             │
│  [정기결제 (선택)]                                                          │
│  ⑲ 정기결제 등록 안내                                                       │
│  ⑳ 카드 정보 저장 (토큰화)                                                  │
│  ㉑ 매월 자동 결제 스케줄 등록                                               │
│  ㉒ 결제 3일 전 사전 안내                                                   │
│  ㉓ 자동 결제 실행                                                          │
│  ㉔ 실패 시 3회 재시도 (D+1, D+3, D+7)                                      │
│  ㉕ 최종 실패 시 수동 결제 안내                                              │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 4️⃣ 학부모 요청 프로세스 (촘촘한 SLA 관리)

### Request Handling Matrix

| 요청 유형 | 우선순위 | SLA | 자동처리 | 담당자 |
|----------|---------|-----|---------|--------|
| 결석 신고 | Normal | 즉시 | ✅ 100% | 시스템 |
| 보강 신청 | Normal | 즉시 | ✅ 100% | 시스템 |
| 스케줄 변경 | Normal | 4시간 | ⚠️ 80% | 시스템+관리자 |
| 환불 요청 | High | 24시간 | ❌ 0% | 관리자 |
| 컴플레인 | Urgent | 4시간 | ❌ 0% | 대표 |
| 일반 문의 | Low | 48시간 | ⚠️ 50% | FAQ봇+관리자 |

### Escalation Flow

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 에스컬레이션 정책                                                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Level 1: 시스템 자동 처리 (0분)                                             │
│  ├── 결석 신고 → 즉시 접수 + 보강권 발급                                     │
│  ├── 보강 신청 → 가용 수업 조회 + 예약 확정                                  │
│  └── 스케줄 조회 → 실시간 응답                                              │
│                                                                             │
│  Level 2: 담당 코치 처리 (SLA 50% 경과)                                      │
│  ├── 스케줄 변경 요청                                                       │
│  ├── 레벨 변경 요청                                                         │
│  └── 코치 변경 요청                                                         │
│                                                                             │
│  Level 3: 관리자 처리 (SLA 80% 경과)                                         │
│  ├── 환불 요청                                                              │
│  ├── 복잡한 스케줄 조정                                                     │
│  └── 미해결 요청                                                            │
│                                                                             │
│  Level 4: 대표 처리 (SLA 100% 경과 또는 Urgent)                              │
│  ├── 컴플레인                                                               │
│  ├── 장기 미해결 요청                                                       │
│  └── VIP 고객 요청                                                          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 5️⃣ 오픈팀 예약 프로세스 (촘촘한 재고 관리)

### Inventory Management (재고 = 잔여석)

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 오픈팀 재고 관리 (실시간)                                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  정원: 15명                                                                 │
│                                                                             │
│  재고 상태:                                                                 │
│  ├── 0-5명: 🔴 마감 임박 (빨간 표시)                                        │
│  ├── 6-10명: 🟡 여유 있음 (노란 표시)                                       │
│  └── 11-15명: 🟢 충분 (초록 표시)                                           │
│                                                                             │
│  예약 Flow:                                                                 │
│  ① 학부모 앱에서 날짜/시간 선택                                             │
│  ② 실시간 잔여석 확인 (0.1초 갱신)                                          │
│  ③ 예약 버튼 터치                                                          │
│  ④ 결제 여부 확인 (회차 있으면 즉시, 없으면 결제)                            │
│  ⑤ 좌석 임시 확보 (5분 타임아웃)                                            │
│  ⑥ 결제/회차 차감 완료                                                     │
│  ⑦ 예약 확정 + 알림 발송                                                   │
│                                                                             │
│  취소 정책:                                                                 │
│  ├── 24시간 전: 전액 환불 (회차 복구)                                       │
│  ├── 12시간 전: 50% 환불                                                    │
│  ├── 6시간 전: 환불 불가                                                    │
│  └── No-show: 회차 차감 + 패널티 기록                                       │
│                                                                             │
│  대기자 관리:                                                               │
│  ① 정원 초과 시 대기자 등록                                                 │
│  ② 대기 순번 실시간 표시                                                    │
│  ③ 취소 발생 시 1번 대기자에게 알림 (10분 응답 기한)                         │
│  ④ 미응답 시 다음 대기자에게 순차 알림                                       │
│  ⑤ 대기자 승격 시 자동 예약 확정                                            │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 6️⃣ 알림 프로세스 (촘촘한 발송 관리)

### Notification Priority Queue

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 알림 우선순위 큐                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  Priority 1 (즉시 발송, 0초):                                               │
│  ├── 출석 완료 알림                                                         │
│  ├── 결제 완료 알림                                                         │
│  └── 긴급 공지                                                              │
│                                                                             │
│  Priority 2 (빠른 발송, 5초 이내):                                          │
│  ├── 결석 알림                                                              │
│  ├── 예약 확정 알림                                                         │
│  └── 요청 처리 완료 알림                                                    │
│                                                                             │
│  Priority 3 (일반 발송, 1분 이내):                                          │
│  ├── 리마인더                                                               │
│  ├── 회차 부족 안내                                                         │
│  └── 성과 영상 알림                                                         │
│                                                                             │
│  Priority 4 (배치 발송, 지정 시간):                                          │
│  ├── 주간 리포트 (매주 일요일 20:00)                                        │
│  ├── 월간 리포트 (매월 1일 10:00)                                           │
│  └── 프로모션 (지정 시간)                                                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 알림 발송 실패 처리

```
실패 → 1분 후 재시도 → 실패 → 5분 후 재시도 → 실패 → 30분 후 재시도
                                                        ↓
                                              실패 로그 기록 +
                                              대체 채널 시도 (SMS)
```

---

## 📊 전체 시스템 메트릭스 대시보드

### Key Performance Indicators

| 카테고리 | 지표 | 목표 | 현재 | 상태 |
|----------|------|------|------|------|
| **출석** | 체크 소요시간 | < 3초 | - | 🔵 |
| | 알림 도달률 | > 99% | - | 🔵 |
| | 오류율 | < 0.1% | - | 🔵 |
| **결제** | 전환율 | > 90% | - | 🔵 |
| | 미납률 | < 3% | - | 🔵 |
| | 정기결제 비율 | > 50% | - | 🔵 |
| **요청** | 자동처리율 | > 80% | - | 🔵 |
| | SLA 준수율 | > 95% | - | 🔵 |
| | 만족도 | > 4.5/5 | - | 🔵 |
| **오픈팀** | 정원 가동률 | > 85% | - | 🔵 |
| | No-show율 | < 5% | - | 🔵 |
| | 대기자 전환율 | > 70% | - | 🔵 |

---

## 🔄 Continuous Improvement Cycle

```
      ┌─────────────┐
      │   Measure   │ ← 모든 단계 측정
      └──────┬──────┘
             │
             ▼
      ┌─────────────┐
      │   Analyze   │ ← 병목 구간 분석
      └──────┬──────┘
             │
             ▼
      ┌─────────────┐
      │   Improve   │ ← 프로세스 개선
      └──────┬──────┘
             │
             ▼
      ┌─────────────┐
      │   Deploy    │ ← 배포 및 모니터링
      └──────┬──────┘
             │
             └──────────────┐
                            │
                            ▼
                      다시 Measure
```

---

*문서 작성: 2026-02-05*
*방법론: Jeff Bezos Working Backwards*
