# ì˜¨ë¦¬ìŒ¤ ì•± ì‹¤ì‚¬ìš© ìµœì í™” ê³„íš

**ë‚ ì§œ**: 2026-02-14
**í˜„ì¬ ìƒíƒœ**: 17ê°œ í™”ë©´ êµ¬í˜„, 262ê°œ í…ŒìŠ¤íŠ¸, 780ëª… í•™ìƒ ë°ì´í„° ì—°ë™ ì™„ë£Œ

---

## ğŸ¯ ìµœì í™” ëª©í‘œ

### 1ë‹¨ê³„: ì¦‰ì‹œ ë°°í¬ ê°€ëŠ¥ ìƒíƒœ (P0)
- ì•ˆì •ì ì¸ ë°ì´í„° ë¡œë”©
- ê¸°ë³¸ UX ì™„ì„±ë„
- ì—ëŸ¬ ì²˜ë¦¬ ì™„ë¹„

### 2ë‹¨ê³„: ì‹¤ì‚¬ìš© í¸ì˜ì„± (P1)
- ê²€ìƒ‰/í•„í„° ê³ ë„í™”
- ì˜¤í”„ë¼ì¸ ëª¨ë“œ
- Push ì•Œë¦¼

### 3ë‹¨ê³„: í†µí•© ì™„ì„± (P2)
- ê²°ì œì„ ìƒ API
- ì¹´ì¹´ì˜¤í†¡ ì•Œë¦¼í†¡
- ìë™í™” ì›Œí¬í”Œë¡œìš°

---

## ğŸ“Š í˜„ì¬ ìƒíƒœ ë¶„ì„

### âœ… ì™„ë£Œëœ ê²ƒ
1. **Supabase ì—°ë™**: ì˜¬ë°”ë¥¸ í”„ë¡œì íŠ¸ (`dcobyicibvhpwcjqkmgw`) ì—°ê²° ì™„ë£Œ
2. **780ëª… í•™ìƒ ë°ì´í„°**: Supabaseì— ì—…ë¡œë“œ ì™„ë£Œ
3. **17ê°œ í™”ë©´**: ëª¨ë“  í•µì‹¬ í™”ë©´ êµ¬í˜„ ì™„ë£Œ
   - CoachHomeScreen (ì½”ì¹˜ í™ˆ)
   - AttendanceAutoScreen (QR ì¶œì„)
   - EntityListScreen/DetailScreen (í•™ìƒ ê´€ë¦¬)
   - PaymentScreen (ê²°ì œ)
   - ParentSelfServiceScreen (í•™ë¶€ëª¨ìš©)
   - AdminMonitorScreen (ê´€ë¦¬ì)
   - DashboardScreen (ëŒ€ì‹œë³´ë“œ)
4. **262ê°œ í…ŒìŠ¤íŠ¸**: ë†’ì€ ì½”ë“œ ì»¤ë²„ë¦¬ì§€
5. **Sentry í†µí•©**: ì—ëŸ¬ ëª¨ë‹ˆí„°ë§ ì¤€ë¹„

### âš ï¸ ìµœì í™” í•„ìš”
1. **ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬**: 780ëª… â†’ í˜ì´ì§€ë„¤ì´ì…˜, ê°€ìƒí™”
2. **ê²€ìƒ‰ ì„±ëŠ¥**: ì‹¤ì‹œê°„ ê²€ìƒ‰ ë””ë°”ìš´ì‹±
3. **ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬**: ì¬ì‹œë„ ë¡œì§, ì˜¤í”„ë¼ì¸ ëª¨ë“œ
4. **ë¡œë”© ìƒíƒœ**: ìŠ¤ì¼ˆë ˆí†¤ UI, í”„ë¡œê·¸ë ˆìŠ¤
5. **ìºì‹±**: React Query ì„¤ì • ìµœì í™”

### âŒ ë¯¸ì™„ì„±
1. **PaymentScreen**: ê²°ì œì„ ìƒ API ì—°ë™ (TODO ìƒíƒœ)
2. **ì¹´ì¹´ì˜¤í†¡ ì•Œë¦¼**: ì•Œë¦¼í†¡ í…œí”Œë¦¿ ë“±ë¡ ëŒ€ê¸°
3. **Push ì•Œë¦¼**: Expo Notifications ì„¤ì •
4. **Edge Functions**: 16ê°œ í•¨ìˆ˜ ë¯¸ë°°í¬

---

## ğŸ”§ P0 - ì¦‰ì‹œ ë°°í¬ ê°€ëŠ¥ ìƒíƒœ (ì˜¤ëŠ˜)

### 1. ë°ì´í„° ë¡œë”© ìµœì í™” (2ì‹œê°„)

#### EntityListScreen.tsx
**ë¬¸ì œ**: 780ëª…ì„ í•œ ë²ˆì— ë¡œë“œí•˜ë©´ ëŠë¦¼

**í•´ê²°**:
```typescript
// í˜ì´ì§€ë„¤ì´ì…˜
const ITEMS_PER_PAGE = 50;
const { data, fetchNextPage, hasNextPage } = useInfiniteQuery({
  queryKey: ['students'],
  queryFn: async ({ pageParam = 0 }) => {
    const from = pageParam * ITEMS_PER_PAGE;
    const to = from + ITEMS_PER_PAGE - 1;

    const { data, error } = await supabase
      .from('profiles')
      .select('*')
      .eq('type', 'student')
      .order('name')
      .range(from, to);

    if (error) throw error;
    return data;
  },
  getNextPageParam: (lastPage, pages) => {
    return lastPage.length === ITEMS_PER_PAGE ? pages.length : undefined;
  },
  staleTime: 5 * 60 * 1000, // 5ë¶„ ìºì‹±
});

// FlatList ê°€ìƒí™” (ì´ë¯¸ êµ¬í˜„ë¨)
<FlatList
  data={data?.pages.flatMap(p => p)}
  onEndReached={() => hasNextPage && fetchNextPage()}
  onEndReachedThreshold={0.5}
  initialNumToRender={20}
  maxToRenderPerBatch={20}
  windowSize={10}
/>
```

#### ê²€ìƒ‰ ë””ë°”ìš´ì‹±
```typescript
import { useDebouncedValue } from '@/hooks/useDebouncedValue';

const [searchText, setSearchText] = useState('');
const debouncedSearch = useDebouncedValue(searchText, 300);

// debouncedSearchë¥¼ queryKeyì— ì‚¬ìš©
const { data } = useQuery({
  queryKey: ['students', debouncedSearch],
  queryFn: () => searchStudents(debouncedSearch),
});
```

---

### 2. ì—ëŸ¬ ì²˜ë¦¬ ê°•í™” (1ì‹œê°„)

#### ì „ì—­ ì—ëŸ¬ ë°”ìš´ë”ë¦¬
```typescript
// src/components/ErrorBoundary.tsx
import * as Sentry from '@sentry/react-native';

export class ErrorBoundary extends React.Component {
  componentDidCatch(error, errorInfo) {
    Sentry.captureException(error, { extra: errorInfo });
  }

  render() {
    if (this.state.hasError) {
      return (
        <View>
          <Text>ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</Text>
          <Button onPress={() => this.setState({ hasError: false })}>
            ë‹¤ì‹œ ì‹œë„
          </Button>
        </View>
      );
    }
    return this.props.children;
  }
}
```

#### ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ì¬ì‹œë„
```typescript
// React Query ì „ì—­ ì„¤ì •
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      retry: 3,
      retryDelay: (attemptIndex) => Math.min(1000 * 2 ** attemptIndex, 30000),
      staleTime: 5 * 60 * 1000,
    },
  },
});
```

---

### 3. ë¡œë”© ìƒíƒœ UI (1ì‹œê°„)

#### ìŠ¤ì¼ˆë ˆí†¤ ìŠ¤í¬ë¦°
```typescript
// src/components/SkeletonCard.tsx
export const SkeletonCard = () => (
  <View style={styles.card}>
    <SkeletonLoader width={60} height={60} borderRadius={30} />
    <View style={styles.content}>
      <SkeletonLoader width="60%" height={20} />
      <SkeletonLoader width="40%" height={16} style={{ marginTop: 8 }} />
    </View>
  </View>
);

// EntityListScreen.tsx
{isLoading ? (
  <FlatList
    data={Array(10).fill(0)}
    renderItem={() => <SkeletonCard />}
  />
) : (
  <FlatList data={students} renderItem={renderStudent} />
)}
```

---

## ğŸš€ P1 - ì‹¤ì‚¬ìš© í¸ì˜ì„± (ì´ë²ˆ ì£¼)

### 4. ì˜¤í”„ë¼ì¸ ëª¨ë“œ (2ì‹œê°„)

#### AsyncStorage ìºì‹±
```typescript
// src/services/offlineCache.ts
import AsyncStorage from '@react-native-async-storage/async-storage';

export const cacheService = {
  async saveStudents(students) {
    await AsyncStorage.setItem('cached_students', JSON.stringify(students));
  },

  async getCachedStudents() {
    const cached = await AsyncStorage.getItem('cached_students');
    return cached ? JSON.parse(cached) : null;
  },
};

// EntityListScreen.tsx
const { data } = useQuery({
  queryKey: ['students'],
  queryFn: async () => {
    try {
      const data = await fetchStudents();
      await cacheService.saveStudents(data);
      return data;
    } catch (error) {
      // ë„¤íŠ¸ì›Œí¬ ì‹¤íŒ¨ ì‹œ ìºì‹œ ì‚¬ìš©
      const cached = await cacheService.getCachedStudents();
      if (cached) return cached;
      throw error;
    }
  },
});
```

---

### 5. Push ì•Œë¦¼ ì„¤ì • (2ì‹œê°„)

#### Expo Notifications
```typescript
// src/services/pushNotifications.ts
import * as Notifications from 'expo-notifications';

export const registerForPushNotifications = async () => {
  const { status } = await Notifications.requestPermissionsAsync();
  if (status !== 'granted') return null;

  const token = await Notifications.getExpoPushTokenAsync({
    projectId: 'your-expo-project-id',
  });

  // Supabaseì— í† í° ì €ì¥
  await supabase
    .from('push_tokens')
    .upsert({ user_id: userId, token: token.data });

  return token.data;
};

// ì•Œë¦¼ í•¸ë“¤ëŸ¬
Notifications.setNotificationHandler({
  handleNotification: async () => ({
    shouldShowAlert: true,
    shouldPlaySound: true,
    shouldSetBadge: true,
  }),
});
```

---

### 6. ê³ ê¸‰ ê²€ìƒ‰/í•„í„° (2ì‹œê°„)

#### ë©€í‹° í•„í„°
```typescript
// src/hooks/useStudentFilters.ts
export const useStudentFilters = () => {
  const [filters, setFilters] = useState({
    search: '',
    classes: [],
    status: 'all',
    sortBy: 'name',
  });

  const { data } = useQuery({
    queryKey: ['students', filters],
    queryFn: async () => {
      let query = supabase
        .from('profiles')
        .select('*')
        .eq('type', 'student');

      if (filters.search) {
        query = query.or(`name.ilike.%${filters.search}%,phone.ilike.%${filters.search}%`);
      }

      if (filters.classes.length > 0) {
        query = query.contains('metadata->classes', filters.classes);
      }

      if (filters.status !== 'all') {
        query = query.eq('status', filters.status);
      }

      query = query.order(filters.sortBy);

      const { data, error } = await query;
      if (error) throw error;
      return data;
    },
  });

  return { data, filters, setFilters };
};
```

---

## ğŸ’³ P2 - í†µí•© ì™„ì„± (ë‹¤ìŒ ì£¼)

### 7. ê²°ì œì„ ìƒ API ì—°ë™

#### PaymentScreen.tsx ì™„ì„±
```typescript
// src/services/paymentService.ts
import { PAYSSAM_API_KEY } from '@env';

export const paymentService = {
  async createInvoice(studentId: string, items: InvoiceItem[]) {
    const response = await fetch('https://api.payssam.kr/v1/invoices', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${PAYSSAM_API_KEY}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        student_id: studentId,
        items,
        due_date: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000), // 7ì¼ í›„
      }),
    });

    if (!response.ok) throw new Error('Invoice creation failed');
    return response.json();
  },

  async getPaymentStatus(invoiceId: string) {
    const response = await fetch(`https://api.payssam.kr/v1/invoices/${invoiceId}`, {
      headers: { 'Authorization': `Bearer ${PAYSSAM_API_KEY}` },
    });
    return response.json();
  },
};
```

---

### 8. ì¹´ì¹´ì˜¤í†¡ ì•Œë¦¼í†¡

#### 12ê°œ í…œí”Œë¦¿ ë“±ë¡
1. `payment_notice` - ì²­êµ¬ì„œ ë°œì†¡
2. `payment_receipt` - ê²°ì œ ì™„ë£Œ
3. `payment_reminder_1day` - ë¯¸ë‚© D+1
4. `attendance_completed` - ì¶œì„ ì™„ë£Œ
5. `attendance_absent` - ê²°ì„ ì•Œë¦¼
6. `class_reminder` - ìˆ˜ì—… ì‹œì‘ ì•Œë¦¼
7. ... (ë‚˜ë¨¸ì§€ 6ê°œ)

#### Supabase Edge Function ì—°ë™
```typescript
// webhook-kakao/index.ts
export default async (req: Request) => {
  const { type, phone, data } = await req.json();

  const template = templates[type];

  await fetch('https://api.coolsms.co.kr/messages/v4/send', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${SOLAPI_API_KEY}`,
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      to: phone,
      from: '0212345678',
      kakaoOptions: {
        pfId: KAKAO_PFID,
        templateId: template.id,
        variables: data,
      },
    }),
  });
};
```

---

## ğŸ“± ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

### iOS (TestFlight)
- [ ] Apple Developer ê³„ì • í™•ì¸
- [ ] Bundle ID: `com.autus.onlyssam`
- [ ] EAS Build ì„¤ì • (`eas.json`)
- [ ] ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ URL
- [ ] ìŠ¤í¬ë¦°ìƒ· (6.5", 5.5")
- [ ] ì•± ì•„ì´ì½˜ (1024x1024)

### Android (Google Play)
- [ ] Google Play Console ê³„ì •
- [ ] Package name: `com.autus.onlyssam`
- [ ] ì„œëª… í‚¤ ìƒì„±
- [ ] ìŠ¤í¬ë¦°ìƒ· (phone, tablet)
- [ ] Feature graphic (1024x500)

### í™˜ê²½ ë³€ìˆ˜ (EAS Secrets)
```bash
eas secret:create --name EXPO_PUBLIC_SUPABASE_URL --value https://dcobyicibvhpwcjqkmgw.supabase.co
eas secret:create --name EXPO_PUBLIC_SUPABASE_ANON_KEY --value eyJh...
eas secret:create --name SENTRY_DSN --value https://xxx@sentry.io/xxx
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. í•™ìƒ ëª©ë¡ ì¡°íšŒ
- [ ] 780ëª… í•™ìƒ ë¡œë”© < 3ì´ˆ
- [ ] ìŠ¤í¬ë¡¤ ë¶€ë“œëŸ¬ì›€ (60fps)
- [ ] ê²€ìƒ‰ ë°˜ì‘ < 500ms
- [ ] ì˜¤í”„ë¼ì¸ ëª¨ë“œ ìºì‹œ ì‘ë™

### 2. ì¶œì„ ì²´í¬
- [ ] QR ìŠ¤ìº” < 1ì´ˆ
- [ ] ì¶œì„ ê¸°ë¡ ì €ì¥ < 2ì´ˆ
- [ ] í•™ë¶€ëª¨ ì•Œë¦¼ < 5ì´ˆ
- [ ] ì¤‘ë³µ ì²´í¬ ë°©ì§€

### 3. ê²°ì œ ì¡°íšŒ
- [ ] ê²°ì œ ë‚´ì—­ ë¡œë”© < 2ì´ˆ
- [ ] ë¯¸ë‚© í•„í„° ì‘ë™
- [ ] ì˜ìˆ˜ì¦ PDF ìƒì„±

### 4. ì—ëŸ¬ ì²˜ë¦¬
- [ ] ë„¤íŠ¸ì›Œí¬ ëŠê¹€ ì‹œ ìºì‹œ ì‚¬ìš©
- [ ] ì¬ì‹œë„ ë¡œì§ ì‘ë™
- [ ] ì‚¬ìš©ì ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€
- [ ] Sentry ì—ëŸ¬ ì „ì†¡

---

## ğŸ“ˆ ì„±ëŠ¥ ëª©í‘œ

| ì§€í‘œ | ëª©í‘œ | í˜„ì¬ | ìƒíƒœ |
|------|------|------|------|
| ì•± ì‹œì‘ ì‹œê°„ | < 3ì´ˆ | ? | ì¸¡ì • í•„ìš” |
| í•™ìƒ ëª©ë¡ ë¡œë”© | < 3ì´ˆ | ? | ì¸¡ì • í•„ìš” |
| ê²€ìƒ‰ ë°˜ì‘ ì‹œê°„ | < 500ms | ? | ì¸¡ì • í•„ìš” |
| FPS (ìŠ¤í¬ë¡¤) | 60fps | ? | ì¸¡ì • í•„ìš” |
| ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ | < 200MB | ? | ì¸¡ì • í•„ìš” |
| í¬ë˜ì‹œìœ¨ | < 1% | 0% | âœ… |

---

## ğŸ”’ ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] Supabase Row Level Security (RLS) í™œì„±í™”
- [x] API í‚¤ í™˜ê²½ ë³€ìˆ˜ ë¶„ë¦¬
- [ ] SSL Pinning (í”„ë¡œë•ì…˜)
- [ ] ë¯¼ê° ë°ì´í„° ì•”í˜¸í™” (AsyncStorage)
- [ ] ìƒì²´ ì¸ì¦ ì˜µì…˜
- [ ] ì„¸ì…˜ ë§Œë£Œ ì²˜ë¦¬

---

## ğŸ“… íƒ€ì„ë¼ì¸

### ì˜¤ëŠ˜ (2026-02-14)
- [x] Supabase í”„ë¡œì íŠ¸ ìˆ˜ì •
- [ ] ë°ì´í„° ë¡œë”© ìµœì í™”
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ê°•í™”
- [ ] ë¡œë”© UI ê°œì„ 

### ì£¼ë§ (2ì›” 15-16ì¼)
- [ ] ì˜¤í”„ë¼ì¸ ëª¨ë“œ
- [ ] Push ì•Œë¦¼ ì„¤ì •
- [ ] ê³ ê¸‰ ê²€ìƒ‰/í•„í„°
- [ ] ì„±ëŠ¥ ì¸¡ì •

### ë‹¤ìŒ ì£¼ (2ì›” 17-21ì¼)
- [ ] ê²°ì œì„ ìƒ API ì—°ë™
- [ ] ì¹´ì¹´ì˜¤í†¡ ì•Œë¦¼í†¡
- [ ] TestFlight ë² íƒ€ ë°°í¬
- [ ] ìœ ë¹„ ë°°êµ¬ ì•„ì¹´ë°ë¯¸ ë‚´ë¶€ í…ŒìŠ¤íŠ¸

### 2ì£¼ ì°¨ (2ì›” 24-28ì¼)
- [ ] í”¼ë“œë°± ë°˜ì˜
- [ ] ë²„ê·¸ ìˆ˜ì •
- [ ] Google Play ì •ì‹ ì¶œì‹œ
- [ ] App Store ì •ì‹ ì¶œì‹œ

---

**ëª©í‘œ**: 2ì£¼ ë‚´ ì •ì‹ ì¶œì‹œ, ìœ ë¹„ ë°°êµ¬ ì•„ì¹´ë°ë¯¸ ì‹¤ì‚¬ìš©
