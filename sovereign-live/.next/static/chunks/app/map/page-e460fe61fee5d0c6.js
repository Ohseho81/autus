(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[883],{23010:function(e,t,r){Promise.resolve().then(r.bind(r,86091))},86091:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r(57437),s=r(2265),a=r(66365),i=r(48934),o=r(7683),l=r(70838);let d={1:"#22c55e",2:"#3b82f6",3:"#64748b"};function c(){var e,t;let r=(0,s.useRef)(null),c=(0,a.yR)(()=>i.ledger.nodes.toArray(),[]),u=(0,a.yR)(()=>i.ledger.motions.toArray(),[]),f=(0,s.useMemo)(()=>{if(!c)return{nodes:[],links:[]};let e=c.map(e=>{var t;return{id:e.node_id,label:e.label,kind:e.kind,tier:null!==(t=e.tier)&&void 0!==t?t:3,r:1===e.tier?24:2===e.tier?16:12}}),t=[],r=e.filter(e=>1===e.tier),n=e.filter(e=>2===e.tier),s=e.filter(e=>3===e.tier);return n.forEach(e=>{r[0]&&t.push({source:r[0].id,target:e.id})}),s.forEach((e,r)=>{let s=n[r%n.length];s&&t.push({source:s.id,target:e.id})}),null==u||u.forEach(e=>{c.find(t=>t.node_id===e.source_node_id)&&c.find(t=>t.node_id===e.target_node_id)&&t.push({source:e.source_node_id,target:e.target_node_id})}),{nodes:e,links:t}},[c,u]);return(0,s.useEffect)(()=>{if(!r.current||0===f.nodes.length)return;let e=l.Ys(r.current);e.selectAll("*").remove(),e.attr("viewBox","0 0 ".concat(800," ").concat(500));let t=l.A4v(f.nodes).force("link",l.Fsl(f.links).id(e=>e.id).distance(120)).force("charge",l.q5i().strength(-400)).force("center",l.wqt(400,250)).force("collision",l.Hh().radius(e=>e.r+10)),n=e.append("g").selectAll("line").data(f.links).enter().append("line").attr("stroke","#334155").attr("stroke-width",1.5).attr("stroke-opacity",.6),s=e.append("g").selectAll("g").data(f.nodes).enter().append("g").style("cursor","pointer");s.append("circle").attr("r",e=>e.r).attr("fill",e=>d[e.tier]||d[3]).attr("fill-opacity",.8).attr("stroke",e=>d[e.tier]||d[3]).attr("stroke-width",2);let a=e.append("g").selectAll("text").data(f.nodes).enter().append("text").text(e=>e.label).attr("font-size",11).attr("fill","#94a3b8").attr("text-anchor","middle").attr("dy",e=>e.r+16);return t.on("tick",()=>{n.attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>e.target.x).attr("y2",e=>e.target.y),s.attr("transform",e=>"translate(".concat(e.x,",").concat(e.y,")")),a.attr("x",e=>e.x).attr("y",e=>e.y)}),s.call(l.ohM().on("start",(e,r)=>{e.active||t.alphaTarget(.3).restart(),r.fx=r.x,r.fy=r.y}).on("drag",(e,t)=>{t.fx=e.x,t.fy=e.y}).on("end",(e,r)=>{e.active||t.alphaTarget(0),r.fx=null,r.fy=null})),()=>{t.stop()}},[f]),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)(o.Zb,{title:"Relationship Map",subtitle:"1-12-144 구조 시각화 \xb7 드래그로 노드 이동",children:(0,n.jsx)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/30 p-2",children:(0,n.jsx)("svg",{ref:r,className:"w-full h-[500px]"})})}),(0,n.jsxs)(o.Zb,{title:"범례",children:[(0,n.jsxs)("div",{className:"flex flex-wrap gap-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"h-4 w-4 rounded-full bg-green-500"}),(0,n.jsx)("span",{className:"text-sm",children:"Tier 1 (핵심)"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"h-4 w-4 rounded-full bg-blue-500"}),(0,n.jsx)("span",{className:"text-sm",children:"Tier 2 (중요)"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"h-4 w-4 rounded-full bg-slate-500"}),(0,n.jsx)("span",{className:"text-sm",children:"Tier 3 (확장)"})]})]}),(0,n.jsxs)("div",{className:"mt-4 text-xs text-slate-500",children:["노드: ",null!==(e=null==c?void 0:c.length)&&void 0!==e?e:0,"개 / 모션: ",null!==(t=null==u?void 0:u.length)&&void 0!==t?t:0,"개"]})]}),(0,n.jsx)(o.Zb,{title:"노드 목록",children:(0,n.jsx)("div",{className:"grid grid-cols-3 gap-2 max-h-64 overflow-y-auto scrollbar-thin",children:null==c?void 0:c.map(e=>{var t,r;return(0,n.jsxs)("div",{className:"rounded-lg border border-slate-800 p-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:d[null!==(t=e.tier)&&void 0!==t?t:3]}}),(0,n.jsx)("span",{className:"text-sm truncate",children:e.label})]}),(0,n.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:[e.kind," \xb7 T",null!==(r=e.tier)&&void 0!==r?r:3]})]},e.node_id)})})})]})}},7683:function(e,t,r){"use strict";r.d(t,{Ct:function(){return o},Zb:function(){return a},zx:function(){return i}});var n=r(57437),s=r(94508);function a(e){let{children:t,className:r,title:a,subtitle:i,action:o}=e;return(0,n.jsxs)("div",{className:(0,s.cn)("rounded-xl border border-slate-800 bg-slate-900/50 p-5",r),children:[(a||o)&&(0,n.jsxs)("div",{className:"mb-4 flex items-start justify-between",children:[(0,n.jsxs)("div",{children:[a&&(0,n.jsx)("div",{className:"text-sm font-medium text-slate-400",children:a}),i&&(0,n.jsx)("div",{className:"mt-1 text-xs text-slate-500",children:i})]}),o]}),t]})}function i(e){let{children:t,variant:r="secondary",size:a="md",className:i,...o}=e;return(0,n.jsx)("button",{className:(0,s.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-colors","disabled:opacity-50 disabled:pointer-events-none",{"bg-slate-100 text-slate-900 hover:bg-slate-200":"primary"===r,"border border-slate-700 text-slate-300 hover:bg-slate-800":"secondary"===r,"text-slate-400 hover:text-slate-200 hover:bg-slate-800/50":"ghost"===r},{"px-3 py-1.5 text-xs":"sm"===a,"px-4 py-2 text-sm":"md"===a,"px-6 py-3 text-base":"lg"===a},i),...o,children:t})}function o(e){let{children:t,variant:r="default"}=e;return(0,n.jsx)("span",{className:(0,s.cn)("inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium",{"bg-slate-700 text-slate-300":"default"===r,"bg-green-500/20 text-green-400":"success"===r,"bg-yellow-500/20 text-yellow-400":"warning"===r,"bg-red-500/20 text-red-400":"error"===r}),children:t})}},48934:function(e,t,r){"use strict";r.r(t),r.d(t,{AutusLedger:function(){return s},exportLedger:function(){return u},getActiveTasks:function(){return o},getLedgerStats:function(){return c},getLogsForTask:function(){return l},getProofsForRelated:function(){return d},getRecentDecisions:function(){return i},importLedger:function(){return f},ledger:function(){return a}});var n=r(35966);class s extends n.ZP{constructor(){super("autus_sovereign_ledger"),this.version(1).stores({nodes:"node_id, kind, tier, created_at",motions:"motion_id, kind, source_node_id, target_node_id, created_at",decisions:"event_id, decision, created_at, linked_task_id",tasks:"task_id, status, priority, source_decision_id, created_at, due_at",actionLogs:"log_id, task_id, action_status, logged_at",proofs:"proof_id, related_id, related_type, kind, created_at",logic:"config_id, updated_at",syncMessages:"message_id, type, sender_id, created_at"})}}let a=new s;async function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return a.decisions.orderBy("created_at").reverse().limit(e).toArray()}async function o(){return a.tasks.where("status").anyOf(["pending","active"]).toArray()}async function l(e){return a.actionLogs.where("task_id").equals(e).toArray()}async function d(e){return a.proofs.where("related_id").equals(e).toArray()}async function c(){let[e,t,r,n]=await Promise.all([a.decisions.count(),a.tasks.count(),a.actionLogs.count(),a.proofs.count()]);return{decisions:e,tasks:t,logs:r,proofs:n,delayedLogs:await a.actionLogs.where("action_status").equals("delayed").count(),needsDecisionLogs:await a.actionLogs.where("action_status").equals("needs_decision").count(),completedLogs:await a.actionLogs.where("action_status").equals("completed").count()}}async function u(){return JSON.stringify({version:1,exported_at:Date.now(),nodes:await a.nodes.toArray(),motions:await a.motions.toArray(),decisions:await a.decisions.toArray(),tasks:await a.tasks.toArray(),actionLogs:await a.actionLogs.toArray(),proofs:await a.proofs.toArray(),logic:await a.logic.toArray()},null,2)}async function f(e){let t=JSON.parse(e);await a.transaction("rw",[a.nodes,a.motions,a.decisions,a.tasks,a.actionLogs,a.proofs,a.logic],async()=>{var e,r,n,s,i,o,l;await Promise.all([a.nodes.clear(),a.motions.clear(),a.decisions.clear(),a.tasks.clear(),a.actionLogs.clear(),a.proofs.clear(),a.logic.clear()]),(null===(e=t.nodes)||void 0===e?void 0:e.length)&&await a.nodes.bulkAdd(t.nodes),(null===(r=t.motions)||void 0===r?void 0:r.length)&&await a.motions.bulkAdd(t.motions),(null===(n=t.decisions)||void 0===n?void 0:n.length)&&await a.decisions.bulkAdd(t.decisions),(null===(s=t.tasks)||void 0===s?void 0:s.length)&&await a.tasks.bulkAdd(t.tasks),(null===(i=t.actionLogs)||void 0===i?void 0:i.length)&&await a.actionLogs.bulkAdd(t.actionLogs),(null===(o=t.proofs)||void 0===o?void 0:o.length)&&await a.proofs.bulkAdd(t.proofs),(null===(l=t.logic)||void 0===l?void 0:l.length)&&await a.logic.bulkAdd(t.logic)})}},94508:function(e,t,r){"use strict";r.d(t,{Pq:function(){return c},SY:function(){return i},_$:function(){return o},cn:function(){return a},jm:function(){return d},z2:function(){return l}});var n=r(61994),s=r(53335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}function i(e){let t=Math.floor(Math.floor((Date.now()-e)/1e3)/60),r=Math.floor(t/60),n=Math.floor(r/24);return n>0?"".concat(n,"일 전"):r>0?"".concat(r,"시간 전"):t>0?"".concat(t,"분 전"):"방금 전"}function o(e){switch(e){case"high":return"text-red-400";case"medium":return"text-yellow-400";default:return"text-slate-400"}}function l(e){switch(e){case"completed":case"done":return"text-green-400";case"delayed":return"text-red-400";case"needs_decision":return"text-yellow-400";case"in_progress":case"active":return"text-blue-400";case"pending":default:return"text-slate-400";case"cancelled":return"text-slate-500"}}function d(e){switch(e){case"do":return"실행";case"delegate":return"위임";case"stop":return"중단";default:return e}}function c(e){switch(e){case"do":return"bg-green-500/20 text-green-400 border-green-500/30";case"delegate":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"stop":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400"}}}},function(e){e.O(0,[439,216,744],function(){return e(e.s=23010)}),_N_E=e.O()}]);