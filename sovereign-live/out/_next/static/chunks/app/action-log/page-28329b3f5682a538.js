(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{97540:function(e,t,s){Promise.resolve().then(s.bind(s,62669))},62669:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var n=s(57437),a=s(2265),r=s(73619),i=s(66365),o=s(48934),l=s(7683),c=s(94508),d=s(41671),u=s(33276),x=s(91723),g=s(49322),m=s(99397);let f=[{value:"completed",label:"완료",icon:d.Z},{value:"in_progress",label:"진행중",icon:u.Z},{value:"delayed",label:"지연",icon:x.Z},{value:"needs_decision",label:"판단 필요",icon:g.Z}];function p(){var e,t;let[s,c]=(0,a.useState)("all"),[d,u]=(0,a.useState)(!1),[x,g]=(0,a.useState)(""),f=(0,i.yR)(()=>o.ledger.tasks.orderBy("created_at").reverse().toArray(),[]),p=(0,i.yR)(()=>o.ledger.actionLogs.orderBy("logged_at").reverse().toArray(),[]);async function v(){x.trim()&&(await o.ledger.tasks.add({task_id:(0,r.x0)(),created_at:Date.now(),title:x,priority:"medium",due_at:null,status:"pending"}),g(""),u(!1))}async function y(e,t){await o.ledger.actionLogs.add({log_id:(0,r.x0)(),task_id:e,actor_role:"employee",action_status:t,time_spent_min:null,used_tools:[],logged_at:Date.now()}),"completed"===t?await o.ledger.tasks.update(e,{status:"done"}):"in_progress"===t&&await o.ledger.tasks.update(e,{status:"active"})}let _=null==f?void 0:f.filter(e=>"all"===s||e.status===s);return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("div",{className:"rounded-lg border border-blue-500/30 bg-blue-500/10 px-4 py-3",children:(0,n.jsx)("div",{className:"text-sm text-blue-400",children:"ℹ️ 본 기록은 개인 평가에 활용되지 않으며, 구조적 병목 파악에만 사용됩니다."})}),(0,n.jsxs)(l.Zb,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-lg font-medium",children:"Action Log"}),(0,n.jsxs)("div",{className:"text-sm text-slate-500",children:[null!==(e=null==f?void 0:f.length)&&void 0!==e?e:0,"개 태스크 / ",null!==(t=null==p?void 0:p.length)&&void 0!==t?t:0,"개 로그"]})]}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsxs)(l.zx,{variant:"secondary",size:"sm",onClick:()=>u(!d),children:[(0,n.jsx)(m.Z,{className:"h-4 w-4 mr-1"}),"태스크 추가"]})})]}),d&&(0,n.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,n.jsx)("input",{type:"text",placeholder:"새 태스크 제목",value:x,onChange:e=>g(e.target.value),onKeyDown:e=>"Enter"===e.key&&v(),className:"flex-1 rounded-lg border border-slate-700 bg-slate-800 px-4 py-2 text-sm focus:border-slate-600 focus:outline-none"}),(0,n.jsx)(l.zx,{onClick:v,children:"추가"})]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(l.zx,{variant:"all"===s?"primary":"ghost",size:"sm",onClick:()=>c("all"),children:"전체"}),(0,n.jsx)(l.zx,{variant:"pending"===s?"primary":"ghost",size:"sm",onClick:()=>c("pending"),children:"대기"}),(0,n.jsx)(l.zx,{variant:"active"===s?"primary":"ghost",size:"sm",onClick:()=>c("active"),children:"진행중"}),(0,n.jsx)(l.zx,{variant:"done"===s?"primary":"ghost",size:"sm",onClick:()=>c("done"),children:"완료"})]}),(0,n.jsx)("div",{className:"space-y-3",children:_&&_.length>0?_.map(e=>{var t;return(0,n.jsx)(h,{task:e,onLog:y,logs:null!==(t=null==p?void 0:p.filter(t=>t.task_id===e.task_id))&&void 0!==t?t:[]},e.task_id)}):(0,n.jsx)(l.Zb,{children:(0,n.jsx)("div",{className:"py-8 text-center text-sm text-slate-500",children:"all"===s?"태스크가 없습니다. Decision Console에서 결정을 내리거나 직접 추가하세요.":"해당 상태의 태스크가 없습니다."})})})]})}function h(e){let{task:t,onLog:s,logs:r}=e,[i,o]=(0,a.useState)(!1);return(0,n.jsxs)(l.Zb,{className:"animate-fade-in",children:[(0,n.jsx)("div",{className:"flex items-start justify-between",children:(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)("span",{className:"text-sm font-medium ".concat((0,c._$)(t.priority)),children:["[",t.priority.toUpperCase(),"]"]}),(0,n.jsx)("span",{className:"text-base",children:t.title})]}),t.description&&(0,n.jsx)("div",{className:"mt-1 text-sm text-slate-500",children:t.description}),(0,n.jsxs)("div",{className:"mt-2 flex items-center gap-3 text-xs text-slate-600",children:[(0,n.jsx)("span",{children:(0,c.SY)(t.created_at)}),(0,n.jsx)(l.Ct,{variant:"done"===t.status?"success":"active"===t.status?"warning":"default",children:t.status}),r.length>0&&(0,n.jsxs)("span",{className:"cursor-pointer hover:text-slate-400",onClick:()=>o(!i),children:[r.length,"개 로그 ",i?"▲":"▼"]})]})]})}),"done"!==t.status&&"cancelled"!==t.status&&(0,n.jsx)("div",{className:"mt-4 flex gap-2",children:f.map(e=>(0,n.jsxs)("button",{onClick:()=>s(t.task_id,e.value),className:"flex items-center gap-1 rounded-lg border border-slate-700 px-3 py-2 text-xs hover:bg-slate-800 ".concat((0,c.z2)(e.value)),children:[(0,n.jsx)(e.icon,{className:"h-3 w-3"}),e.label]},e.value))}),i&&r.length>0&&(0,n.jsxs)("div",{className:"mt-4 border-t border-slate-800 pt-4",children:[(0,n.jsx)("div",{className:"text-xs text-slate-500 mb-2",children:"실행 기록"}),(0,n.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between rounded-lg bg-slate-800/50 px-3 py-2 text-xs",children:[(0,n.jsx)("span",{className:(0,c.z2)(e.action_status),children:e.action_status}),(0,n.jsx)("span",{className:"text-slate-500",children:(0,c.SY)(e.logged_at)})]},e.log_id))})]})]})}},7683:function(e,t,s){"use strict";s.d(t,{Ct:function(){return o},Zb:function(){return r},zx:function(){return i}});var n=s(57437),a=s(94508);function r(e){let{children:t,className:s,title:r,subtitle:i,action:o}=e;return(0,n.jsxs)("div",{className:(0,a.cn)("rounded-xl border border-slate-800 bg-slate-900/50 p-5",s),children:[(r||o)&&(0,n.jsxs)("div",{className:"mb-4 flex items-start justify-between",children:[(0,n.jsxs)("div",{children:[r&&(0,n.jsx)("div",{className:"text-sm font-medium text-slate-400",children:r}),i&&(0,n.jsx)("div",{className:"mt-1 text-xs text-slate-500",children:i})]}),o]}),t]})}function i(e){let{children:t,variant:s="secondary",size:r="md",className:i,...o}=e;return(0,n.jsx)("button",{className:(0,a.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-colors","disabled:opacity-50 disabled:pointer-events-none",{"bg-slate-100 text-slate-900 hover:bg-slate-200":"primary"===s,"border border-slate-700 text-slate-300 hover:bg-slate-800":"secondary"===s,"text-slate-400 hover:text-slate-200 hover:bg-slate-800/50":"ghost"===s},{"px-3 py-1.5 text-xs":"sm"===r,"px-4 py-2 text-sm":"md"===r,"px-6 py-3 text-base":"lg"===r},i),...o,children:t})}function o(e){let{children:t,variant:s="default"}=e;return(0,n.jsx)("span",{className:(0,a.cn)("inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium",{"bg-slate-700 text-slate-300":"default"===s,"bg-green-500/20 text-green-400":"success"===s,"bg-yellow-500/20 text-yellow-400":"warning"===s,"bg-red-500/20 text-red-400":"error"===s}),children:t})}},48934:function(e,t,s){"use strict";s.r(t),s.d(t,{AutusLedger:function(){return a},exportLedger:function(){return u},getActiveTasks:function(){return o},getLedgerStats:function(){return d},getLogsForTask:function(){return l},getProofsForRelated:function(){return c},getRecentDecisions:function(){return i},importLedger:function(){return x},ledger:function(){return r}});var n=s(35966);class a extends n.ZP{constructor(){super("autus_sovereign_ledger"),this.version(1).stores({nodes:"node_id, kind, tier, created_at",motions:"motion_id, kind, source_node_id, target_node_id, created_at",decisions:"event_id, decision, created_at, linked_task_id",tasks:"task_id, status, priority, source_decision_id, created_at, due_at",actionLogs:"log_id, task_id, action_status, logged_at",proofs:"proof_id, related_id, related_type, kind, created_at",logic:"config_id, updated_at",syncMessages:"message_id, type, sender_id, created_at"})}}let r=new a;async function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return r.decisions.orderBy("created_at").reverse().limit(e).toArray()}async function o(){return r.tasks.where("status").anyOf(["pending","active"]).toArray()}async function l(e){return r.actionLogs.where("task_id").equals(e).toArray()}async function c(e){return r.proofs.where("related_id").equals(e).toArray()}async function d(){let[e,t,s,n]=await Promise.all([r.decisions.count(),r.tasks.count(),r.actionLogs.count(),r.proofs.count()]);return{decisions:e,tasks:t,logs:s,proofs:n,delayedLogs:await r.actionLogs.where("action_status").equals("delayed").count(),needsDecisionLogs:await r.actionLogs.where("action_status").equals("needs_decision").count(),completedLogs:await r.actionLogs.where("action_status").equals("completed").count()}}async function u(){return JSON.stringify({version:1,exported_at:Date.now(),nodes:await r.nodes.toArray(),motions:await r.motions.toArray(),decisions:await r.decisions.toArray(),tasks:await r.tasks.toArray(),actionLogs:await r.actionLogs.toArray(),proofs:await r.proofs.toArray(),logic:await r.logic.toArray()},null,2)}async function x(e){let t=JSON.parse(e);await r.transaction("rw",[r.nodes,r.motions,r.decisions,r.tasks,r.actionLogs,r.proofs,r.logic],async()=>{var e,s,n,a,i,o,l;await Promise.all([r.nodes.clear(),r.motions.clear(),r.decisions.clear(),r.tasks.clear(),r.actionLogs.clear(),r.proofs.clear(),r.logic.clear()]),(null===(e=t.nodes)||void 0===e?void 0:e.length)&&await r.nodes.bulkAdd(t.nodes),(null===(s=t.motions)||void 0===s?void 0:s.length)&&await r.motions.bulkAdd(t.motions),(null===(n=t.decisions)||void 0===n?void 0:n.length)&&await r.decisions.bulkAdd(t.decisions),(null===(a=t.tasks)||void 0===a?void 0:a.length)&&await r.tasks.bulkAdd(t.tasks),(null===(i=t.actionLogs)||void 0===i?void 0:i.length)&&await r.actionLogs.bulkAdd(t.actionLogs),(null===(o=t.proofs)||void 0===o?void 0:o.length)&&await r.proofs.bulkAdd(t.proofs),(null===(l=t.logic)||void 0===l?void 0:l.length)&&await r.logic.bulkAdd(t.logic)})}},94508:function(e,t,s){"use strict";s.d(t,{Pq:function(){return d},SY:function(){return i},_$:function(){return o},cn:function(){return r},jm:function(){return c},z2:function(){return l}});var n=s(61994),a=s(53335);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,n.W)(t))}function i(e){let t=Math.floor(Math.floor((Date.now()-e)/1e3)/60),s=Math.floor(t/60),n=Math.floor(s/24);return n>0?"".concat(n,"일 전"):s>0?"".concat(s,"시간 전"):t>0?"".concat(t,"분 전"):"방금 전"}function o(e){switch(e){case"high":return"text-red-400";case"medium":return"text-yellow-400";default:return"text-slate-400"}}function l(e){switch(e){case"completed":case"done":return"text-green-400";case"delayed":return"text-red-400";case"needs_decision":return"text-yellow-400";case"in_progress":case"active":return"text-blue-400";case"pending":default:return"text-slate-400";case"cancelled":return"text-slate-500"}}function c(e){switch(e){case"do":return"실행";case"delegate":return"위임";case"stop":return"중단";default:return e}}function d(e){switch(e){case"do":return"bg-green-500/20 text-green-400 border-green-500/30";case"delegate":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"stop":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400"}}}},function(e){e.O(0,[216,744],function(){return e(e.s=97540)}),_N_E=e.O()}]);