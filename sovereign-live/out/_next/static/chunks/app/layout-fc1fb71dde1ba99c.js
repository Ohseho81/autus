(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{24838:function(e,t,s){Promise.resolve().then(s.t.bind(s,47960,23)),Promise.resolve().then(s.bind(s,5464))},5464:function(e,t,s){"use strict";s.d(t,{AppShell:function(){return q}});var a=s(57437),n=s(2265),r=s(99376),i=s(27648),o=s(25466),l=s(80221),c=s(70525),d=s(43044),u=s(98728),x=s(13420),g=s(87117),m=s(32364),p=s(94508);let f=[{href:"/status",label:"1. Status",icon:o.Z,description:"현재 상태"},{href:"/console",label:"2. Console",icon:l.Z,description:"결정 입력"},{href:"/path",label:"3. Path",icon:c.Z,description:"미래 경로"},{href:"/action-log",label:"4. Action Log",icon:d.Z,description:"실행 기록"},{href:"/setup",label:"5. Setup",icon:u.Z,description:"연결 설정"},{href:"/map",label:"6. Map",icon:x.Z,description:"관계 맵"},{href:"/proof",label:"7. Proof",icon:g.Z,description:"증빙 보관"},{href:"/logic",label:"8. Logic",icon:m.Z,description:"규칙 편집"}];function h(){let e=(0,r.usePathname)();return(0,a.jsxs)("aside",{className:"w-64 flex-shrink-0 border-r border-slate-800 bg-slate-900/50",children:[(0,a.jsx)("div",{className:"flex h-16 items-center border-b border-slate-800 px-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-8 w-8 rounded-lg bg-gradient-to-br from-green-400 to-cyan-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-semibold",children:"AUTUS"}),(0,a.jsx)("div",{className:"text-xs text-slate-500",children:"v15.1 Sovereign"})]})]})}),(0,a.jsx)("nav",{className:"p-4 space-y-1",children:f.map(t=>{let s=e===t.href,n=t.icon;return(0,a.jsxs)(i.default,{href:t.href,className:(0,p.cn)("flex items-center gap-3 rounded-lg px-3 py-2.5 text-sm transition-colors",s?"bg-slate-800 text-slate-50":"text-slate-400 hover:bg-slate-800/50 hover:text-slate-200"),children:[(0,a.jsx)(n,{className:"h-4 w-4"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("div",{className:(0,p.cn)(s?"font-medium":""),children:t.label})})]},t.href)})}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 w-64 border-t border-slate-800 p-4",children:(0,a.jsxs)("div",{className:"rounded-lg border border-slate-800 bg-slate-900/50 p-3",children:[(0,a.jsx)("div",{className:"text-xs text-slate-500",children:"Local Storage"}),(0,a.jsx)("div",{className:"mt-1 text-sm text-slate-300",children:"서버 저장 0"}),(0,a.jsx)("div",{className:"mt-2 text-xs text-slate-600",children:"모든 데이터는 이 기기에만 저장됩니다"})]})})]})}var v=s(66365),b=s(48934),y=s(50091),w=s(62926),k=s(75395),j=s(88906);function N(){let e=(0,v.yR)(()=>(0,b.getLedgerStats)(),[]);return(0,a.jsxs)("header",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold tracking-tight",children:"Sovereign Live"}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Decision → Action → Proof Loop"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)(y.Z,{className:"h-3.5 w-3.5 text-slate-400"}),(0,a.jsx)("span",{className:"text-slate-400",children:"Ledger:"}),(0,a.jsx)("span",{className:"text-slate-200",children:e?"".concat(e.decisions,"D / ").concat(e.tasks,"T / ").concat(e.proofs,"P"):"..."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)(k.Z,{className:"h-3.5 w-3.5 text-slate-500"}),(0,a.jsx)("span",{className:"text-slate-400",children:"P2P:"}),(0,a.jsx)("span",{className:"text-slate-500",children:"Offline"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,a.jsx)(j.Z,{className:"h-3.5 w-3.5 text-green-400"}),(0,a.jsx)("span",{className:"text-green-400",children:"Local Only"})]})]})]})}var _=s(64719),L=s(32489);let A=[{category:"네비게이션",items:[{keys:["1"],description:"Status 페이지"},{keys:["2"],description:"Console 페이지"},{keys:["3"],description:"Path 페이지"},{keys:["4"],description:"Action Log 페이지"},{keys:["5"],description:"Setup 페이지"},{keys:["6"],description:"Map 페이지"},{keys:["7"],description:"Proof 페이지"},{keys:["8"],description:"Logic 페이지"}]},{category:"결정 (Console)",items:[{keys:["Y"],description:"실행 (Yes)"},{keys:["D"],description:"위임 (Delegate)"},{keys:["N"],description:"중단 (No)"},{keys:["←","→"],description:"이전/다음 결정"}]},{category:"글로벌",items:[{keys:["⌘","K"],description:"검색"},{keys:["?"],description:"단축키 도움말"},{keys:["⌘","E"],description:"데이터 내보내기"}]}];function E(){let[e,t]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{let e=e=>{"?"===e.key&&e.shiftKey&&(e.preventDefault(),t(!0)),"Escape"===e.key&&t(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),e)?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:()=>t(!1),children:(0,a.jsxs)("div",{className:"relative w-full max-w-lg rounded-2xl border border-slate-700 bg-slate-900 p-6",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(_.Z,{className:"h-5 w-5 text-green-400"}),(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"키보드 단축키"})]}),(0,a.jsx)("button",{onClick:()=>t(!1),className:"rounded-lg p-2 hover:bg-slate-800",children:(0,a.jsx)(L.Z,{className:"h-4 w-4"})})]}),(0,a.jsx)("div",{className:"space-y-6",children:A.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider mb-3",children:e.category}),(0,a.jsx)("div",{className:"space-y-2",children:e.items.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,a.jsx)("span",{className:"text-sm text-slate-400",children:e.description}),(0,a.jsx)("div",{className:"flex gap-1",children:e.keys.map((e,t)=>(0,a.jsx)("kbd",{className:"min-w-[24px] px-2 py-1 text-xs font-mono bg-slate-800 rounded border border-slate-700 text-center",children:e},t))})]},t))})]},e.category))}),(0,a.jsx)("div",{className:"mt-6 pt-4 border-t border-slate-800 text-center",children:(0,a.jsxs)("span",{className:"text-xs text-slate-500",children:["Press ",(0,a.jsx)("kbd",{className:"px-1 bg-slate-800 rounded",children:"?"})," to toggle"]})})]})}):null}var S=s(11239),P=s(92735);async function Z(){if(!("serviceWorker"in navigator))return null;try{let e=await navigator.serviceWorker.register("/sw.js",{scope:"/"});return e.addEventListener("updatefound",()=>{let t=e.installing;t&&t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&dispatchEvent(new CustomEvent("pwa-update-available"))})}),e}catch(e){return null}}function D(){return"undefined"==typeof navigator||navigator.onLine}function C(){let e=(0,r.usePathname)(),[t,s]=(0,n.useState)(D());async function o(){try{let e=await (0,b.exportLedger)(),t=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="autus-".concat(new Date().toISOString().split("T")[0],".json"),a.click(),URL.revokeObjectURL(s)}catch(e){}}return(0,a.jsxs)("div",{className:"fixed bottom-6 right-6 z-40",children:[(0,a.jsx)("div",{className:"absolute -top-8 right-0 flex items-center gap-2 text-xs",children:t?(0,a.jsxs)("span",{className:"flex items-center gap-1 text-green-400",children:[(0,a.jsx)(w.Z,{className:"h-3 w-3"})," Online"]}):(0,a.jsxs)("span",{className:"flex items-center gap-1 text-yellow-400",children:[(0,a.jsx)(k.Z,{className:"h-3 w-3"})," Offline"]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 rounded-full bg-slate-800/90 backdrop-blur border border-slate-700 p-1.5 shadow-lg",children:["/console"!==e&&(0,a.jsxs)(i.default,{href:"/console",className:"flex items-center gap-2 rounded-full bg-green-500 px-4 py-2 text-sm font-medium text-slate-900 hover:bg-green-400 transition-colors",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4"}),"결정"]}),"/proof"!==e&&(0,a.jsx)(i.default,{href:"/proof",className:"rounded-full p-2 hover:bg-slate-700 transition-colors",title:"증빙 추가",children:(0,a.jsx)(g.Z,{className:"h-4 w-4 text-slate-400"})}),(0,a.jsx)("button",{onClick:o,className:"rounded-full p-2 hover:bg-slate-700 transition-colors",title:"데이터 내보내기 (⌘E)",children:(0,a.jsx)(P.Z,{className:"h-4 w-4 text-slate-400"})}),(0,a.jsx)("button",{onClick:function(){dispatchEvent(new KeyboardEvent("keydown",{key:"?",shiftKey:!0}))},className:"rounded-full p-2 hover:bg-slate-700 transition-colors",title:"단축키 (?)",children:(0,a.jsx)(_.Z,{className:"h-4 w-4 text-slate-400"})})]})]})}var O=s(73619);async function M(){if(await b.ledger.nodes.count()>0)return!1;let e=Date.now(),t=[{node_id:(0,O.x0)(),kind:"person",label:"Master",tier:1,created_at:e},{node_id:(0,O.x0)(),kind:"org",label:"X City / Clark SPC",tier:2,created_at:e},{node_id:(0,O.x0)(),kind:"org",label:"AUTUS Corp",tier:2,created_at:e},{node_id:(0,O.x0)(),kind:"person",label:"Yeon-woo",tier:2,created_at:e},{node_id:(0,O.x0)(),kind:"person",label:"Son",tier:2,created_at:e},{node_id:(0,O.x0)(),kind:"person",label:"Philippine Managers",tier:2,created_at:e},{node_id:(0,O.x0)(),kind:"asset",label:"Capital: 300M KRW",tier:3,created_at:e},{node_id:(0,O.x0)(),kind:"asset",label:"Debt: 800M KRW (1.5%/mo)",tier:3,created_at:e},{node_id:(0,O.x0)(),kind:"power",label:"Decision Authority",tier:1,created_at:e}],s={config_id:(0,O.x0)(),updated_at:e,weights:{mint:1,tax:1,synergy:1},rules:{narrative_mode:"template",auto_delegate_threshold:80,proof_required:!1}},a=[{task_id:(0,O.x0)(),created_at:e,title:"Q1 재무 보고서 검토",description:"분기별 재무 현황 분석 및 이사회 보고 자료 준비",priority:"high",due_at:e+6048e5,status:"pending"},{task_id:(0,O.x0)(),created_at:e,title:"신규 직원 온보딩 프로세스 정비",description:"표준 온보딩 체크리스트 및 교육 자료 업데이트",priority:"medium",due_at:e+12096e5,status:"pending"},{task_id:(0,O.x0)(),created_at:e,title:"월간 운영 비용 최적화 분석",description:"불필요한 SaaS 구독 정리 및 비용 절감 방안 도출",priority:"medium",due_at:null,status:"active"}];return await b.ledger.transaction("rw",[b.ledger.nodes,b.ledger.logic,b.ledger.tasks],async()=>{await b.ledger.nodes.bulkAdd(t),await b.ledger.logic.add(s),await b.ledger.tasks.bulkAdd(a)}),!0}let R=new Map;async function T(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,a=Date.now(),n=R.get(e);if(n&&n.expiry>a)return n.value;let r=await t();return R.set(e,{value:r,expiry:a+s}),r}async function U(){await Promise.all([T("stats",()=>Promise.resolve().then(s.bind(s,48934)).then(e=>e.getLedgerStats())),T("recentDecisions",()=>b.ledger.decisions.orderBy("created_at").reverse().limit(10).toArray()),T("activeTasks",()=>b.ledger.tasks.where("status").anyOf(["pending","active"]).toArray())])}function q(e){let{children:t}=e,s=(0,r.useRouter)(),[i,o]=(0,n.useState)(!1),[l,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!0);return((0,n.useEffect)(()=>{(async()=>{c(await M()),await U(),Z(),window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),dispatchEvent(new CustomEvent("pwa-install-available"))}),u(D()),function(e){let t=()=>e(!0),s=()=>e(!1);window.addEventListener("online",t),window.addEventListener("offline",s),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}(u),o(!0)})()},[]),(0,n.useEffect)(()=>{let e=e=>{let t=e.target;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable)return;let a={1:"/status",2:"/console",3:"/path",4:"/action-log",5:"/setup",6:"/map",7:"/proof",8:"/logic"};if(a[e.key]&&(e.preventDefault(),s.push(a[e.key])),(e.ctrlKey||e.metaKey)&&"e"===e.key){var n;e.preventDefault(),null===(n=document.querySelector('[title*="내보내기"]'))||void 0===n||n.click()}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[s]),i)?(0,a.jsxs)("div",{className:"flex h-screen bg-slate-950 text-slate-50",children:[(0,a.jsx)(h,{}),(0,a.jsxs)("main",{className:"flex-1 overflow-y-auto scrollbar-thin",children:[!d&&(0,a.jsx)("div",{className:"bg-yellow-500/10 border-b border-yellow-500/30 px-6 py-2 text-center text-sm text-yellow-400",children:"⚠️ 오프라인 모드 - 데이터는 로컬에 저장됩니다"}),(0,a.jsx)("div",{className:"sticky top-0 z-10 border-b border-slate-800 bg-slate-950/95 backdrop-blur px-6 py-4",children:(0,a.jsx)(N,{})}),(0,a.jsxs)("div",{className:"p-6 pb-24",children:[l&&(0,a.jsx)("div",{className:"mb-4 rounded-lg border border-green-500/30 bg-green-500/10 px-4 py-3 text-sm text-green-400 animate-fade-in",children:"✓ Ledger 준비 완료. 숫자 키(1-8)로 빠른 이동 가능."}),t]})]}),(0,a.jsx)(E,{}),(0,a.jsx)(C,{})]}):(0,a.jsx)("div",{className:"flex h-screen items-center justify-center bg-slate-950",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-green-400 to-cyan-400 animate-pulse mx-auto"})}),(0,a.jsx)("div",{className:"mt-4 text-xl font-semibold text-slate-200",children:"AUTUS"}),(0,a.jsx)("div",{className:"mt-2 text-sm text-slate-500",children:"Initializing..."}),(0,a.jsx)("div",{className:"mt-4 flex justify-center gap-1",children:[0,1,2].map(e=>(0,a.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-green-400 animate-bounce",style:{animationDelay:"".concat(.15*e,"s")}},e))})]})})}},48934:function(e,t,s){"use strict";s.r(t),s.d(t,{AutusLedger:function(){return n},exportLedger:function(){return u},getActiveTasks:function(){return o},getLedgerStats:function(){return d},getLogsForTask:function(){return l},getProofsForRelated:function(){return c},getRecentDecisions:function(){return i},importLedger:function(){return x},ledger:function(){return r}});var a=s(35966);class n extends a.ZP{constructor(){super("autus_sovereign_ledger"),this.version(1).stores({nodes:"node_id, kind, tier, created_at",motions:"motion_id, kind, source_node_id, target_node_id, created_at",decisions:"event_id, decision, created_at, linked_task_id",tasks:"task_id, status, priority, source_decision_id, created_at, due_at",actionLogs:"log_id, task_id, action_status, logged_at",proofs:"proof_id, related_id, related_type, kind, created_at",logic:"config_id, updated_at",syncMessages:"message_id, type, sender_id, created_at"})}}let r=new n;async function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return r.decisions.orderBy("created_at").reverse().limit(e).toArray()}async function o(){return r.tasks.where("status").anyOf(["pending","active"]).toArray()}async function l(e){return r.actionLogs.where("task_id").equals(e).toArray()}async function c(e){return r.proofs.where("related_id").equals(e).toArray()}async function d(){let[e,t,s,a]=await Promise.all([r.decisions.count(),r.tasks.count(),r.actionLogs.count(),r.proofs.count()]);return{decisions:e,tasks:t,logs:s,proofs:a,delayedLogs:await r.actionLogs.where("action_status").equals("delayed").count(),needsDecisionLogs:await r.actionLogs.where("action_status").equals("needs_decision").count(),completedLogs:await r.actionLogs.where("action_status").equals("completed").count()}}async function u(){return JSON.stringify({version:1,exported_at:Date.now(),nodes:await r.nodes.toArray(),motions:await r.motions.toArray(),decisions:await r.decisions.toArray(),tasks:await r.tasks.toArray(),actionLogs:await r.actionLogs.toArray(),proofs:await r.proofs.toArray(),logic:await r.logic.toArray()},null,2)}async function x(e){let t=JSON.parse(e);await r.transaction("rw",[r.nodes,r.motions,r.decisions,r.tasks,r.actionLogs,r.proofs,r.logic],async()=>{var e,s,a,n,i,o,l;await Promise.all([r.nodes.clear(),r.motions.clear(),r.decisions.clear(),r.tasks.clear(),r.actionLogs.clear(),r.proofs.clear(),r.logic.clear()]),(null===(e=t.nodes)||void 0===e?void 0:e.length)&&await r.nodes.bulkAdd(t.nodes),(null===(s=t.motions)||void 0===s?void 0:s.length)&&await r.motions.bulkAdd(t.motions),(null===(a=t.decisions)||void 0===a?void 0:a.length)&&await r.decisions.bulkAdd(t.decisions),(null===(n=t.tasks)||void 0===n?void 0:n.length)&&await r.tasks.bulkAdd(t.tasks),(null===(i=t.actionLogs)||void 0===i?void 0:i.length)&&await r.actionLogs.bulkAdd(t.actionLogs),(null===(o=t.proofs)||void 0===o?void 0:o.length)&&await r.proofs.bulkAdd(t.proofs),(null===(l=t.logic)||void 0===l?void 0:l.length)&&await r.logic.bulkAdd(t.logic)})}},94508:function(e,t,s){"use strict";s.d(t,{Pq:function(){return d},SY:function(){return i},_$:function(){return o},cn:function(){return r},jm:function(){return c},z2:function(){return l}});var a=s(61994),n=s(53335);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.m6)((0,a.W)(t))}function i(e){let t=Math.floor(Math.floor((Date.now()-e)/1e3)/60),s=Math.floor(t/60),a=Math.floor(s/24);return a>0?"".concat(a,"일 전"):s>0?"".concat(s,"시간 전"):t>0?"".concat(t,"분 전"):"방금 전"}function o(e){switch(e){case"high":return"text-red-400";case"medium":return"text-yellow-400";default:return"text-slate-400"}}function l(e){switch(e){case"completed":case"done":return"text-green-400";case"delayed":return"text-red-400";case"needs_decision":return"text-yellow-400";case"in_progress":case"active":return"text-blue-400";case"pending":default:return"text-slate-400";case"cancelled":return"text-slate-500"}}function c(e){switch(e){case"do":return"실행";case"delegate":return"위임";case"stop":return"중단";default:return e}}function d(e){switch(e){case"do":return"bg-green-500/20 text-green-400 border-green-500/30";case"delegate":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"stop":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400"}}},47960:function(){}},function(e){e.O(0,[587,216,744],function(){return e(e.s=24838)}),_N_E=e.O()}]);