{
  "name": "AUTUS Self-Evolution v13.0",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours",
              "hoursInterval": 6
            }
          ]
        }
      },
      "id": "schedule-trigger",
      "name": "â° 6ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [250, 300]
    },
    {
      "parameters": {
        "url": "https://autus-ai.com",
        "options": {}
      },
      "id": "fetch-site",
      "name": "ğŸŒ ì‚¬ì´íŠ¸ ë¶„ì„",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [450, 300]
    },
    {
      "parameters": {
        "jsCode": "// AUTUS ëˆ„ë½ ê¸°ëŠ¥ ê°ì§€\nconst html = $input.first().json.data || '';\n\nconst requiredFeatures = [\n  { id: 'dashboard', pattern: /dashboard|ëŒ€ì‹œë³´ë“œ/i, name: 'ëŒ€ì‹œë³´ë“œ', impact: 10 },\n  { id: 'feedback', pattern: /feedback|í”¼ë“œë°±|ì œì¶œ|ìˆ˜ì •|íê¸°/i, name: 'í”¼ë“œë°± ì‹œìŠ¤í…œ', impact: 15 },\n  { id: 'auth', pattern: /login|logout|ì¸ì¦|ë¡œê·¸ì¸/i, name: 'ì¸ì¦ ì‹œìŠ¤í…œ', impact: 12 },\n  { id: 'analytics', pattern: /chart|graph|analytics|ë¶„ì„/i, name: 'ë¶„ì„ ì°¨íŠ¸', impact: 8 },\n  { id: 'realtime', pattern: /websocket|realtime|ì‹¤ì‹œê°„/i, name: 'ì‹¤ì‹œê°„ ê¸°ëŠ¥', impact: 10 },\n  { id: 'notification', pattern: /notification|ì•Œë¦¼|toast/i, name: 'ì•Œë¦¼ ì‹œìŠ¤í…œ', impact: 7 },\n  { id: 'search', pattern: /search|ê²€ìƒ‰/i, name: 'ê²€ìƒ‰ ê¸°ëŠ¥', impact: 6 },\n  { id: 'export', pattern: /export|download|ë‚´ë³´ë‚´ê¸°/i, name: 'ë‚´ë³´ë‚´ê¸°', impact: 5 },\n  { id: 'dark_mode', pattern: /dark-mode|theme|í…Œë§ˆ/i, name: 'ë‹¤í¬ ëª¨ë“œ', impact: 4 },\n  { id: 'mobile', pattern: /responsive|mobile|ëª¨ë°”ì¼/i, name: 'ëª¨ë°”ì¼ ìµœì í™”', impact: 9 },\n  { id: 'proof_pack', pattern: /proof|ì¦ë¹™|Proof Pack/i, name: 'Proof Pack ì‹œìŠ¤í…œ', impact: 15 },\n  { id: 'smart_router', pattern: /router|ë¼ìš°í„°|í—Œë²•/i, name: 'Smart Router', impact: 12 }\n];\n\nconst detected = [];\nconst missing = [];\n\nfor (const feature of requiredFeatures) {\n  if (feature.pattern.test(html)) {\n    detected.push(feature);\n  } else {\n    missing.push(feature);\n  }\n}\n\nconst currentScore = detected.reduce((sum, f) => sum + f.impact, 0);\nconst maxScore = requiredFeatures.reduce((sum, f) => sum + f.impact, 0);\n\nreturn {\n  json: {\n    timestamp: new Date().toISOString(),\n    current_score: currentScore,\n    max_score: maxScore,\n    percentage: Math.round((currentScore / maxScore) * 100),\n    detected_count: detected.length,\n    missing_count: missing.length,\n    detected_features: detected.map(f => f.name),\n    missing_features: missing.map(f => ({ id: f.id, name: f.name, impact: f.impact })),\n    should_evolve: missing.length > 0\n  }\n};"
      },
      "id": "analyze-gaps",
      "name": "ğŸ” ëˆ„ë½ ê¸°ëŠ¥ ë¶„ì„",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [650, 300]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.should_evolve }}",
              "value2": true
            }
          ]
        }
      },
      "id": "check-evolve",
      "name": "ì§„í™” í•„ìš”?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [850, 300]
    },
    {
      "parameters": {
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpQueryAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [{\n    \"parts\": [{\n      \"text\": \"AUTUS ìë™í™” ì‹œìŠ¤í…œì— ë‹¤ìŒ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠ” HTML/JavaScript ì½”ë“œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.\\n\\nëˆ„ë½ëœ ê¸°ëŠ¥: {{ $json.missing_features.map(f => f.name).join(', ') }}\\n\\nìš”êµ¬ì‚¬í•­:\\n1. ê¸°ì¡´ AUTUS ë””ìì¸ ì‹œìŠ¤í…œê³¼ ì¼ê´€ëœ ìŠ¤íƒ€ì¼ (ë‹¤í¬ í…Œë§ˆ, ê·¸ë¼ë””ì–¸íŠ¸)\\n2. í•œêµ­ì–´ UI\\n3. ì‹¤ì œ ë™ì‘í•˜ëŠ” JavaScript ì½”ë“œ\\n4. ëª¨ë°”ì¼ ë°˜ì‘í˜•\\n\\nì½”ë“œë§Œ ì¶œë ¥í•´ì£¼ì„¸ìš”.\"\n    }]\n  }],\n  \"generationConfig\": {\n    \"temperature\": 0.7,\n    \"maxOutputTokens\": 8192\n  }\n}"
      },
      "id": "gemini-generate",
      "name": "ğŸ¤– Gemini ì½”ë“œ ìƒì„±",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1050, 200],
      "credentials": {
        "httpQueryAuth": {
          "id": "gemini-api",
          "name": "Gemini API Key"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Gemini ì‘ë‹µì—ì„œ ì½”ë“œ ì¶”ì¶œ\nconst response = $input.first().json;\nconst gapAnalysis = $('ğŸ” ëˆ„ë½ ê¸°ëŠ¥ ë¶„ì„').first().json;\n\nlet generatedCode = '';\ntry {\n  generatedCode = response.candidates?.[0]?.content?.parts?.[0]?.text || '';\n  // ì½”ë“œ ë¸”ë¡ ì¶”ì¶œ\n  const codeMatch = generatedCode.match(/```(?:html|javascript)?\\n([\\s\\S]*?)```/);\n  if (codeMatch) {\n    generatedCode = codeMatch[1];\n  }\n} catch (e) {\n  generatedCode = 'Error extracting code';\n}\n\nreturn {\n  json: {\n    cycle_number: Date.now(),\n    timestamp: new Date().toISOString(),\n    missing_features: gapAnalysis.missing_features,\n    generated_code: generatedCode,\n    score_before: gapAnalysis.current_score,\n    status: generatedCode.length > 100 ? 'SUCCESS' : 'FAILED'\n  }\n};"
      },
      "id": "extract-code",
      "name": "ğŸ“ ì½”ë“œ ì¶”ì¶œ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1250, 200]
    },
    {
      "parameters": {
        "url": "={{ $env.SUPABASE_URL }}/rest/v1/evolution_logs",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"cycle_number\": {{ $json.cycle_number }},\n  \"detected_gaps\": {{ JSON.stringify($json.missing_features) }},\n  \"generated_features\": {{ JSON.stringify($json.missing_features.map(f => f.name)) }},\n  \"code_diff\": {{ JSON.stringify($json.generated_code.substring(0, 5000)) }},\n  \"deploy_status\": \"{{ $json.status }}\",\n  \"score_before\": {{ $json.score_before }}\n}",
        "options": {
          "response": {
            "response": {
              "neverError": true
            }
          }
        }
      },
      "id": "log-supabase",
      "name": "ğŸ’¾ Supabase ë¡œê·¸",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1450, 200],
      "credentials": {
        "httpHeaderAuth": {
          "id": "supabase-api",
          "name": "Supabase API"
        }
      }
    },
    {
      "parameters": {
        "channel": "#autus-evolution",
        "text": "=ğŸ§¬ *AUTUS ìê¸° ì§„í™” ë¦¬í¬íŠ¸*\n\nğŸ“Š *í˜„ì¬ ì ìˆ˜:* {{ $('ğŸ” ëˆ„ë½ ê¸°ëŠ¥ ë¶„ì„').first().json.current_score }} / {{ $('ğŸ” ëˆ„ë½ ê¸°ëŠ¥ ë¶„ì„').first().json.max_score }} ({{ $('ğŸ” ëˆ„ë½ ê¸°ëŠ¥ ë¶„ì„').first().json.percentage }}%)\n\nâœ… *ê°ì§€ëœ ê¸°ëŠ¥:* {{ $('ğŸ” ëˆ„ë½ ê¸°ëŠ¥ ë¶„ì„').first().json.detected_count }}ê°œ\nâŒ *ëˆ„ë½ëœ ê¸°ëŠ¥:* {{ $('ğŸ” ëˆ„ë½ ê¸°ëŠ¥ ë¶„ì„').first().json.missing_count }}ê°œ\n\nğŸ”§ *ëˆ„ë½ ëª©ë¡:*\n{{ $('ğŸ” ëˆ„ë½ ê¸°ëŠ¥ ë¶„ì„').first().json.missing_features.map(f => `â€¢ ${f.name} (+${f.impact}ì )`).join('\\n') }}\n\nğŸ¤– *AI ì½”ë“œ ìƒì„±:* {{ $json.status }}\nâ° {{ $json.timestamp }}",
        "otherOptions": {}
      },
      "id": "slack-notify",
      "name": "ğŸ“¢ Slack ì•Œë¦¼",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.2,
      "position": [1650, 200],
      "credentials": {
        "slackApi": {
          "id": "slack-bot",
          "name": "Slack Bot"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ì§„í™” ë¶ˆí•„ìš” - ìŠ¤í‚µ\nconst gapAnalysis = $('ğŸ” ëˆ„ë½ ê¸°ëŠ¥ ë¶„ì„').first().json;\n\nreturn {\n  json: {\n    status: 'SKIPPED',\n    reason: 'ëª¨ë“  í•µì‹¬ ê¸°ëŠ¥ì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤',\n    current_score: gapAnalysis.current_score,\n    percentage: gapAnalysis.percentage,\n    timestamp: new Date().toISOString()\n  }\n};"
      },
      "id": "skip-evolve",
      "name": "â­ï¸ ì§„í™” ìŠ¤í‚µ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1050, 400]
    },
    {
      "parameters": {
        "channel": "#autus-evolution",
        "text": "=âœ… *AUTUS ìƒíƒœ ì •ìƒ*\n\nğŸ“Š ì ìˆ˜: {{ $json.current_score }} ({{ $json.percentage }}%)\nğŸ’¡ ëª¨ë“  í•µì‹¬ ê¸°ëŠ¥ì´ ì¡´ì¬í•©ë‹ˆë‹¤.\nâ° {{ $json.timestamp }}",
        "otherOptions": {}
      },
      "id": "slack-skip-notify",
      "name": "ğŸ“¢ ìŠ¤í‚µ ì•Œë¦¼",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.2,
      "position": [1250, 400],
      "credentials": {
        "slackApi": {
          "id": "slack-bot",
          "name": "Slack Bot"
        }
      }
    }
  ],
  "connections": {
    "â° 6ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰": {
      "main": [[{"node": "ğŸŒ ì‚¬ì´íŠ¸ ë¶„ì„", "type": "main", "index": 0}]]
    },
    "ğŸŒ ì‚¬ì´íŠ¸ ë¶„ì„": {
      "main": [[{"node": "ğŸ” ëˆ„ë½ ê¸°ëŠ¥ ë¶„ì„", "type": "main", "index": 0}]]
    },
    "ğŸ” ëˆ„ë½ ê¸°ëŠ¥ ë¶„ì„": {
      "main": [[{"node": "ì§„í™” í•„ìš”?", "type": "main", "index": 0}]]
    },
    "ì§„í™” í•„ìš”?": {
      "main": [
        [{"node": "ğŸ¤– Gemini ì½”ë“œ ìƒì„±", "type": "main", "index": 0}],
        [{"node": "â­ï¸ ì§„í™” ìŠ¤í‚µ", "type": "main", "index": 0}]
      ]
    },
    "ğŸ¤– Gemini ì½”ë“œ ìƒì„±": {
      "main": [[{"node": "ğŸ“ ì½”ë“œ ì¶”ì¶œ", "type": "main", "index": 0}]]
    },
    "ğŸ“ ì½”ë“œ ì¶”ì¶œ": {
      "main": [[{"node": "ğŸ’¾ Supabase ë¡œê·¸", "type": "main", "index": 0}]]
    },
    "ğŸ’¾ Supabase ë¡œê·¸": {
      "main": [[{"node": "ğŸ“¢ Slack ì•Œë¦¼", "type": "main", "index": 0}]]
    },
    "â­ï¸ ì§„í™” ìŠ¤í‚µ": {
      "main": [[{"node": "ğŸ“¢ ìŠ¤í‚µ ì•Œë¦¼", "type": "main", "index": 0}]]
    }
  },
  "settings": {"executionOrder": "v1"},
  "tags": [{"id": "1", "name": "AUTUS"}, {"id": "2", "name": "Self-Evolution"}],
  "triggerCount": 1,
  "versionId": "v13.0"
}
