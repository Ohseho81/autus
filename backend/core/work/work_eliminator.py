"""
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ AUTUS v2.5+ - Work Eliminator (í†µí•© ì‹¤í–‰ ì‹œìŠ¤í…œ)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

"ë¬´ìŠ¨ ì¡´ì¬ê°€ ë ì§€ëŠ” ë‹¹ì‹ ì´ ì •í•œë‹¤.
 ê·¸ ì¡´ì¬ë¥¼ ìœ ì§€í•˜ëŠ” ì¼ì€ ìš°ë¦¬ê°€ í•œë‹¤."

í•µì‹¬: AUTUSëŠ” ëŒ€ì‹  ê²°ì •í•˜ì§€ ì•ŠëŠ”ë‹¤. ì˜¤ì§ ì œì•ˆë§Œ í•œë‹¤.
"""

from dataclasses import dataclass, field
from typing import Dict, List, Optional

from .ert_classification import (
    Entity, Relation, TimeType, ERTStrategy,
    ENTITIES, RELATIONS, TIME_TYPES,
    KEY_ERT_PATTERNS,
    get_ert_stats,
)
from .ert_auto_decision import (
    UserVariables,
    Edge,
    ERTWorkInstance,
    DecisionResult,
    BatchDecisionResult,
    Thresholds,
    DEFAULT_THRESHOLDS,
    auto_decide,
    batch_decide,
    generate_proposal_message,
)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“Œ Work Eliminator ìƒíƒœ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

@dataclass
class WorkEliminatorStats:
    """í†µê³„"""
    total_processed: int = 0
    deleted: int = 0
    automated: int = 0
    parallelized: int = 0
    humanized: int = 0
    total_time_saved: int = 0
    total_energy_saved: float = 0.0


@dataclass
class WorkEliminatorConfig:
    """ì„¤ì •"""
    auto_execute: bool = False
    confirm_required: bool = True
    thresholds: Thresholds = field(default_factory=lambda: DEFAULT_THRESHOLDS)


@dataclass
class WorkEliminatorState:
    """Work Eliminator ìƒíƒœ"""
    works: List[ERTWorkInstance] = field(default_factory=list)
    decisions: List[DecisionResult] = field(default_factory=list)
    stats: WorkEliminatorStats = field(default_factory=WorkEliminatorStats)
    config: WorkEliminatorConfig = field(default_factory=WorkEliminatorConfig)


def create_work_eliminator_state() -> WorkEliminatorState:
    """ì´ˆê¸° ìƒíƒœ ìƒì„±"""
    return WorkEliminatorState()


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“Œ ì—…ë¬´ ìƒì„± í—¬í¼
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

_work_counter = 0


def create_ert_work(
    title: str,
    entity: Entity,
    relation: Relation,
    time: TimeType,
    variables: Optional[Dict] = None,
    edges: Optional[List[Edge]] = None,
) -> ERTWorkInstance:
    """ERT ì—…ë¬´ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±"""
    global _work_counter
    _work_counter += 1
    
    # ë³€ìˆ˜ ì„¤ì •
    var_dict = variables or {}
    user_vars = UserVariables(
        pressure=var_dict.get('pressure', 0.5),
        mass=var_dict.get('mass', 1.0),
        entropy=var_dict.get('entropy', 0.3),
        weight=var_dict.get('weight', 0.5),
        velocity=var_dict.get('velocity', 0.0),
    )
    
    # ì„¤ëª… ìƒì„±
    e = ENTITIES[entity]
    r = RELATIONS[relation]
    t = TIME_TYPES[time]
    description = f'{e.name_ko} Ã— {r.name_ko} Ã— {t.name_ko}'
    
    return ERTWorkInstance(
        id=f'work_{_work_counter}',
        entity=entity,
        relation=relation,
        time=time,
        title=title,
        description=description,
        variables=user_vars,
        linked_node_ids=e.linked_nodes,
        edges=edges or [],
        status='pending',
    )


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“Œ ì‹¤í–‰ í•¨ìˆ˜
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def analyze_all_works(state: WorkEliminatorState) -> BatchDecisionResult:
    """ëª¨ë“  ì—…ë¬´ ë¶„ì„"""
    result = batch_decide(state.works, state.config.thresholds)
    
    # ìƒíƒœ ì—…ë°ì´íŠ¸
    state.decisions = result.decisions
    state.stats.total_processed = result.summary.total
    state.stats.deleted = result.summary.by_strategy.get('DELETE', 0)
    state.stats.automated = result.summary.by_strategy.get('AUTOMATE', 0)
    state.stats.parallelized = result.summary.by_strategy.get('PARALLELIZE', 0)
    state.stats.humanized = result.summary.by_strategy.get('HUMANIZE', 0)
    state.stats.total_time_saved = result.summary.total_time_saved
    state.stats.total_energy_saved = result.summary.total_energy_saved
    
    return result


def process_single_work(
    state: WorkEliminatorState,
    work: ERTWorkInstance
) -> DecisionResult:
    """ë‹¨ì¼ ì—…ë¬´ ì²˜ë¦¬"""
    decision = auto_decide(work, state.config.thresholds)
    
    work.status = 'proposed'
    work.proposed_strategy = decision.proposed_strategy
    
    state.decisions.append(decision)
    
    return decision


def accept_proposal(state: WorkEliminatorState, work_id: str) -> None:
    """ì œì•ˆ ìˆ˜ë½"""
    work = next((w for w in state.works if w.id == work_id), None)
    if not work:
        return
    
    work.status = 'accepted'
    
    decision = next((d for d in state.decisions if d.work.id == work_id), None)
    if decision:
        strategy = decision.proposed_strategy
        if strategy == 'DELETE':
            state.stats.deleted += 1
        elif strategy == 'AUTOMATE':
            state.stats.automated += 1
        elif strategy == 'PARALLELIZE':
            state.stats.parallelized += 1
        elif strategy == 'HUMANIZE':
            state.stats.humanized += 1
        
        state.stats.total_time_saved += decision.expected_outcome.time_saved
        state.stats.total_energy_saved += decision.expected_outcome.energy_saved
        state.stats.total_processed += 1


def reject_proposal(state: WorkEliminatorState, work_id: str) -> None:
    """ì œì•ˆ ê±°ì ˆ"""
    work = next((w for w in state.works if w.id == work_id), None)
    if work:
        work.status = 'rejected'


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“Œ ë³´ê³ ì„œ ìƒì„±
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def generate_report(state: WorkEliminatorState) -> str:
    """ë³´ê³ ì„œ ìƒì„±"""
    stats = state.stats
    decisions = state.decisions
    
    delete_works = [d for d in decisions if d.proposed_strategy == 'DELETE']
    automate_works = [d for d in decisions if d.proposed_strategy == 'AUTOMATE']
    parallel_works = [d for d in decisions if d.proposed_strategy == 'PARALLELIZE']
    human_works = [d for d in decisions if d.proposed_strategy == 'HUMANIZE']
    
    total = max(stats.total_processed, 1)
    total_rate = (stats.deleted + stats.automated) / total * 100
    
    # ì‚­ì œ í›„ë³´
    delete_lines = []
    for d in delete_works[:5]:
        v = d.work.variables
        delete_lines.append(f'â”‚ â€¢ {d.work.title[:40]:40} (W={v.weight:.2f}, P={v.pressure:.2f}) â”‚')
    if not delete_lines:
        delete_lines = ['â”‚ (ì—†ìŒ)                                                                       â”‚']
    
    # ìë™í™” í›„ë³´
    automate_lines = []
    for d in automate_works[:5]:
        v = d.work.variables
        automate_lines.append(f'â”‚ â€¢ {d.work.title[:40]:40} (Îµ={v.entropy:.2f}, M={v.mass:.2f}) â”‚')
    if not automate_lines:
        automate_lines = ['â”‚ (ì—†ìŒ)                                                                       â”‚']
    
    # ì¸ê°„ í•„ìˆ˜
    human_lines = []
    for d in human_works[:5]:
        human_lines.append(f'â”‚ â€¢ {d.work.title[:50]:50}                            â”‚')
    if not human_lines:
        human_lines = ['â”‚ (ì—†ìŒ)                                                                       â”‚']
    
    return f"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘        ğŸ¯ AUTUS Work Eliminator Report                                        â•‘
â•‘        "ì¡´ì¬ë¥¼ ìœ ì§€í•˜ëŠ” ì¼ì€ ìš°ë¦¬ê°€ í•œë‹¤"                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š SUMMARY                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Total Works Analyzed: {stats.total_processed:>4}                                              â”‚
â”‚                                                                             â”‚
â”‚ ğŸ—‘ï¸  DELETE      : {stats.deleted:>3} ({stats.deleted / total * 100:>5.1f}%)  - ë¶ˆí•„ìš” ì—…ë¬´ ì‚­ì œ                   â”‚
â”‚ ğŸ¤– AUTOMATE    : {stats.automated:>3} ({stats.automated / total * 100:>5.1f}%)  - AI/ì‹œìŠ¤í…œ ìë™í™”                  â”‚
â”‚ ğŸ”€ PARALLELIZE : {stats.parallelized:>3} ({stats.parallelized / total * 100:>5.1f}%)  - ë¶„ì‚°/ë³‘ë ¬ ì²˜ë¦¬                    â”‚
â”‚ ğŸ‘¤ HUMANIZE    : {stats.humanized:>3} ({stats.humanized / total * 100:>5.1f}%)  - ì¸ê°„ ì°½ì¡°/íŒë‹¨ í•„ìˆ˜                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’° SAVINGS                                                                  â”‚
â”‚                                                                             â”‚
â”‚ â€¢ Time Saved: {stats.total_time_saved} minutes ({stats.total_time_saved / 60:.1f} hours)                          â”‚
â”‚ â€¢ Energy Saved: {stats.total_energy_saved * 100:.1f}%                                                     â”‚
â”‚ â€¢ Elimination Rate: {total_rate:.1f}% (ì‚­ì œ + ìë™í™”)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ—‘ï¸  DELETE CANDIDATES ({len(delete_works)}ê°œ)                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
{chr(10).join(delete_lines)}
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– AUTOMATE CANDIDATES ({len(automate_works)}ê°œ)                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
{chr(10).join(automate_lines)}
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¤ HUMAN REQUIRED ({len(human_works)}ê°œ)                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
{chr(10).join(human_lines)}
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ "ì‚­ì œ 30% + ìë™í™” 40% + ë³‘ë ¬í™” 20% = ì¸ê°„ì€ ì°½ì¡°ë§Œ"                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
""".strip()


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“Œ ERT 288 Matrix ë¦¬í¬íŠ¸
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def generate_ert_matrix_report() -> str:
    """ERT 288 ë§¤íŠ¸ë¦­ìŠ¤ ë³´ê³ ì„œ"""
    stats = get_ert_stats()
    patterns = KEY_ERT_PATTERNS
    
    pattern_lines = []
    for p in patterns[:12]:
        emoji = 'ğŸ—‘ï¸' if p.strategy == 'DELETE' else \
                'ğŸ¤–' if p.strategy == 'AUTOMATE' else \
                'ğŸ”€' if p.strategy == 'PARALLELIZE' else 'ğŸ‘¤'
        pattern_lines.append(f'â”‚ {emoji} {p.name_ko:15} â”‚ {p.pattern:35} â”‚')
    
    return f"""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘        ğŸŒ ERT 288 Matrix (12E Ã— 6R Ã— 4T)                                      â•‘
â•‘        "ì§€êµ¬ìƒ ëª¨ë“  ì—…ë¬´ë¥¼ 288ê°œ ê´€ì ìœ¼ë¡œ ë¶„í•´"                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š GLOBAL STATISTICS                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Total ERT Combinations: {stats.total}                                                â”‚
â”‚                                                                             â”‚
â”‚ Strategy Distribution:                                                      â”‚
â”‚   ğŸ—‘ï¸  DELETE      : {stats.by_strategy['DELETE']:>3} ({stats.delete_rate * 100:>5.1f}%)                                  â”‚
â”‚   ğŸ¤– AUTOMATE    : {stats.by_strategy['AUTOMATE']:>3} ({stats.automate_rate * 100:>5.1f}%)                                  â”‚
â”‚   ğŸ”€ PARALLELIZE : {stats.by_strategy['PARALLELIZE']:>3} ({stats.parallel_rate * 100:>5.1f}%)                                  â”‚
â”‚   ğŸ‘¤ HUMANIZE    : {stats.by_strategy['HUMANIZE']:>3} ({stats.human_rate * 100:>5.1f}%)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Œ ENTITY (12ê°œ) - "ë¬´ì—‡"                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CASH(í˜„ê¸ˆ) PEOPLE(ì‚¬ëŒ) KNOWLEDGE(ì§€ì‹) TIME(ì‹œê°„) ENERGY(ì—ë„ˆì§€) ASSET(ìì‚°)â”‚
â”‚ HEALTH(ê±´ê°•) RELATION(ê´€ê³„) MARKET(ì‹œì¥) RISK(ìœ„í—˜) SPACE(ê³µê°„) DATA(ë°ì´í„°) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”— RELATION (6ê°œ) - "ì–´ë–»ê²Œ"                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OWN(ì†Œìœ ) â†’ ìë™í™” 90%    DEPEND(ì˜ì¡´) â†’ ìë™í™” 80%   EXCHANGE(êµí™˜) â†’ ìë™í™” 95%â”‚
â”‚ COOPERATE(í˜‘ë ¥) â†’ ë³‘ë ¬ 90%  COMPETE(ê²½ìŸ) â†’ ë³‘ë ¬ 70%   INFLUENCE(ì˜í–¥) â†’ ì‚­ì œ 60%â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â° TIME (4ê°œ) - "ì–¸ì œ"                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ POINT(ì‹œì ) â†’ ìë™í™” 70%     DURATION(ê¸°ê°„) â†’ ë³‘ë ¬ 90%                       â”‚
â”‚ FREQUENCY(ë¹ˆë„) â†’ ìë™í™” 95%  SEQUENCE(ìˆœì„œ) â†’ ìë™í™” 85%                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¯ KEY PATTERNS                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
{chr(10).join(pattern_lines)}
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ê²°ë¡ : ì‚­ì œ {stats.delete_rate * 100:.0f}% + ìë™í™” {stats.automate_rate * 100:.0f}% + ë³‘ë ¬ {stats.parallel_rate * 100:.0f}% = {(stats.delete_rate + stats.automate_rate + stats.parallel_rate) * 100:.0f}% ìµœì í™” ê°€ëŠ¥          â•‘
â•‘       ì¸ê°„ì€ ì˜¤ì§ {stats.human_rate * 100:.0f}%ì˜ ì°½ì¡°/íŒë‹¨ ì—…ë¬´ë§Œ ìˆ˜í–‰                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
""".strip()


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“Œ ì‚¬ìš© ì˜ˆì‹œ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

def run_example() -> None:
    """ì‚¬ìš© ì˜ˆì‹œ ì‹¤í–‰"""
    state = create_work_eliminator_state()
    
    # ì—…ë¬´ ì¶”ê°€
    state.works = [
        # ì‚­ì œ ëŒ€ìƒ
        create_ert_work('ë§¤ì¼ ì”ê³  í™•ì¸', 'CASH', 'OWN', 'FREQUENCY',
                       {'pressure': 0.1, 'weight': 0.15, 'entropy': 0.05}),
        create_ert_work('ì¼ì¼ í˜„í™© ë³´ê³ ì„œ', 'DATA', 'INFLUENCE', 'FREQUENCY',
                       {'pressure': 0.1, 'weight': 0.1, 'entropy': 0.02}),
        
        # ìë™í™” ëŒ€ìƒ
        create_ert_work('ì²­êµ¬ì„œ ì²˜ë¦¬', 'CASH', 'EXCHANGE', 'SEQUENCE',
                       {'pressure': 0.4, 'weight': 0.6, 'entropy': 0.3, 'mass': 0.2}),
        create_ert_work('ê²½ìŸì‚¬ ëª¨ë‹ˆí„°ë§', 'MARKET', 'COMPETE', 'FREQUENCY',
                       {'pressure': 0.3, 'weight': 0.5, 'entropy': 0.25, 'mass': 0.3}),
        create_ert_work('ë§ˆê° ì•Œë¦¼', 'TIME', 'DEPEND', 'POINT',
                       {'pressure': 0.5, 'weight': 0.7, 'entropy': 0.4}),
        
        # ë³‘ë ¬í™” ëŒ€ìƒ
        create_ert_work('íŒ€ í”„ë¡œì íŠ¸', 'PEOPLE', 'COOPERATE', 'DURATION',
                       {'pressure': 0.5, 'weight': 0.8, 'mass': 2.5, 'entropy': 0.3}),
        create_ert_work('ì‹œì¥ ì¡°ì‚¬', 'MARKET', 'INFLUENCE', 'DURATION',
                       {'pressure': 0.4, 'weight': 0.6, 'mass': 2.2, 'entropy': 0.2}),
        
        # ì¸ê°„ í•„ìˆ˜
        create_ert_work('íˆ¬ìì ë¯¸íŒ…', 'PEOPLE', 'INFLUENCE', 'POINT',
                       {'pressure': 0.8, 'weight': 0.9, 'mass': 0.5, 'entropy': 0.1}),
        create_ert_work('ì œí’ˆ ì „ëµ ìˆ˜ë¦½', 'KNOWLEDGE', 'OWN', 'POINT',
                       {'pressure': 0.7, 'weight': 0.85, 'mass': 0.4, 'entropy': 0.15}),
    ]
    
    # ë¶„ì„ ì‹¤í–‰
    result = analyze_all_works(state)
    
    # ë³´ê³ ì„œ ì¶œë ¥
    print(generate_report(state))
    print('\n')
    print(generate_ert_matrix_report())
    
    # ê°œë³„ ì œì•ˆ ì¶œë ¥
    print('\n\n=== ê°œë³„ ì œì•ˆ ì˜ˆì‹œ ===\n')
    if result.decisions:
        print(generate_proposal_message(result.decisions[0]))
