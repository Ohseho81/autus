# ğŸ§  MoltBot í†µí•© ì•„í‚¤í…ì²˜

> **MoltBot = ì‹¤í–‰ ê°€ëŠ¥í•œ í•™ì› ìš´ì˜ ë‘ë‡Œ**
> LLMì€ ì…, ê·œì¹™ì€ ì†, ê·¸ë˜í”„ëŠ” ê¸°ì–µ, ê²°ê³¼ëŠ” êµì‚¬.

---

## ğŸ“Š í˜„ì¬ AUTUS í”„ë¡œì íŠ¸ êµ¬ì¡°

```
autus/
â”œâ”€â”€ core/kernel/           # AUTUS í—Œë²• (K1-K5)
â”‚   â”œâ”€â”€ CONSTITUTION.ts    # ì ˆëŒ€ ë¶ˆë³€ 5ëŒ€ ë²•ì¹™
â”‚   â”œâ”€â”€ Enforcer.ts        # í—Œë²• ì§‘í–‰ì
â”‚   â””â”€â”€ Pipeline.ts        # ì…ë ¥â†’ëŒ€ê¸°â†’í‰ê°€â†’ì ìš©
â”‚
â”œâ”€â”€ moltbot-brain/         # ëª°íŠ¸ë´‡ ë‘ë‡Œ (NEW)
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ intervention-log.js   # ê°œì… ê¸°ë¡ (í•™ìŠµì˜ í•µì‹¬)
â”‚   â”‚   â”œâ”€â”€ rule-engine.js        # IF-THEN ê·œì¹™
â”‚   â”‚   â”œâ”€â”€ state-graph.js        # í•™ìƒ-ìˆ˜ì—…-ì½”ì¹˜ ê·¸ë˜í”„
â”‚   â”‚   â””â”€â”€ outcome-evaluator.js  # ê²°ê³¼ í‰ê°€ & í•™ìŠµ
â”‚   â””â”€â”€ index.js           # í†µí•© ì¸í„°í˜ì´ìŠ¤
â”‚
â”œâ”€â”€ moltbot-bridge/        # Telegram ë¸Œë¦¿ì§€
â”‚   â””â”€â”€ index.js           # Telegram â†’ Claude CLI
â”‚
â”œâ”€â”€ allthatbasket/supabase/functions/
â”‚   â”œâ”€â”€ attendance-chain-reaction/  # ì¶œì„ ì²´ì¸ ë°˜ì‘
â”‚   â”œâ”€â”€ payment-webhook/            # ê²°ì œ ì›¹í›…
â”‚   â””â”€â”€ coach-clock-out-chain/      # ì½”ì¹˜ í‡´ê·¼ ì²´ì¸
â”‚
â””â”€â”€ kraton-v2/             # ì›¹ ì•± (React)
    â””â”€â”€ src/pages/allthatbasket/
        â””â”€â”€ views/         # UI ì»´í¬ë„ŒíŠ¸
```

---

## ğŸ”— í†µí•© ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AUTUS CORE KERNEL                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CONSTITUTION (K1-K5)                                        â”‚   â”‚
â”‚  â”‚  â€¢ K1: ì ìˆ˜ë¡œë§Œ ìŠ¹ê²©                                           â”‚   â”‚
â”‚  â”‚  â€¢ K2: ì‚¬ìš©ì ì˜ê²¬ = ì‹ í˜¸                                       â”‚   â”‚
â”‚  â”‚  â€¢ K3: Proof í•„ìˆ˜                                             â”‚   â”‚
â”‚  â”‚  â€¢ K4: 24ì‹œê°„ ëŒ€ê¸°                                            â”‚   â”‚
â”‚  â”‚  â€¢ K5: Standard â‰¤ 10%                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ (í—Œë²• ì¤€ìˆ˜)
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MOLTBOT BRAIN                                â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Interventionâ”‚  â”‚   Rule     â”‚  â”‚   State    â”‚  â”‚  Outcome   â”‚   â”‚
â”‚  â”‚    Log     â”‚  â”‚  Engine    â”‚  â”‚   Graph    â”‚  â”‚ Evaluator  â”‚   â”‚
â”‚  â”‚  (ê¸°ë¡ì)   â”‚  â”‚  (íŒë‹¨ì)   â”‚  â”‚  (ê¸°ì–µì)   â”‚  â”‚  (êµì‚¬)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚        â”‚               â”‚               â”‚               â”‚           â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                              â”‚                                      â”‚
â”‚                        MoltBotBrain                                 â”‚
â”‚                    (í†µí•© ì¸í„°í˜ì´ìŠ¤)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                       â”‚                       â”‚
           â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Edge    â”‚  â”‚  MoltBot Bridge  â”‚  â”‚   KRATON V2      â”‚
â”‚   Functions      â”‚  â”‚   (Telegram)     â”‚  â”‚    (Web UI)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ attendance-    â”‚  â”‚ â€¢ @autus_seho_botâ”‚  â”‚ â€¢ Dashboard      â”‚
â”‚   chain-reaction â”‚  â”‚ â€¢ Claude CLI     â”‚  â”‚ â€¢ Students       â”‚
â”‚ â€¢ payment-       â”‚  â”‚ â€¢ /claude ëª…ë ¹    â”‚  â”‚ â€¢ Attendance     â”‚
â”‚   webhook        â”‚  â”‚                  â”‚  â”‚ â€¢ Payments       â”‚
â”‚ â€¢ coach-clock-   â”‚  â”‚                  â”‚  â”‚                  â”‚
â”‚   out-chain      â”‚  â”‚                  â”‚  â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Supabase      â”‚
                    â”‚   PostgreSQL     â”‚
                    â”‚   (ë°ì´í„° ì €ì¥)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ ë°ì´í„° íë¦„

### 1ï¸âƒ£ ì¶œì„ ì²´ì¸ ë°˜ì‘

```
QR ìŠ¤ìº” â†’ attendance-chain-reaction (Edge Function)
                    â”‚
                    â”œâ”€â”€ 1. í•™ë¶€ëª¨ ì•Œë¦¼ (ì¹´ì¹´ì˜¤/FCM)
                    â”œâ”€â”€ 2. ì„±ì¥ ê¸°ë¡ ì—…ë°ì´íŠ¸
                    â”œâ”€â”€ 3. í”¼ë“œë°± ì„¸ì…˜ ì¤€ë¹„
                    â””â”€â”€ 4. í¬ì¸íŠ¸ ì ë¦½
                    â”‚
                    â–¼
           MoltBot Brain ì—°ë™ (NEW)
                    â”‚
                    â”œâ”€â”€ State Graph ì—…ë°ì´íŠ¸
                    â”œâ”€â”€ Rule Engine í‰ê°€
                    â””â”€â”€ Intervention Log ê¸°ë¡
```

### 2ï¸âƒ£ ê²°ì œ ì›¹í›…

```
PortOne ê²°ì œ â†’ payment-webhook (Edge Function)
                    â”‚
                    â”œâ”€â”€ 1. ê²°ì œ ê²€ì¦
                    â”œâ”€â”€ 2. DB ì—…ë°ì´íŠ¸
                    â”œâ”€â”€ 3. QR í™œì„±í™”
                    â””â”€â”€ 4. í¬ì¸íŠ¸ ì ë¦½
                    â”‚
                    â–¼
           MoltBot Brain ì—°ë™ (NEW)
                    â”‚
                    â”œâ”€â”€ ë¯¸ìˆ˜ê¸ˆ ìƒíƒœ ì—…ë°ì´íŠ¸
                    â”œâ”€â”€ ê²°ì œ ê·œì¹™ í‰ê°€
                    â””â”€â”€ ê°œì… í•„ìš” ì—¬ë¶€ íŒë‹¨
```

### 3ï¸âƒ£ ì½”ì¹˜ í‡´ê·¼ ì²´ì¸

```
ì½”ì¹˜ í‡´ê·¼ â†’ coach-clock-out-chain (Edge Function)
                    â”‚
                    â”œâ”€â”€ 1. ì˜ìƒ ì—…ë¡œë“œ í
                    â”œâ”€â”€ 2. í”¼ë“œë°± ì¼ê´„ ë°œì†¡
                    â”œâ”€â”€ 3. ì½”ì¹˜ ê¸‰ì—¬ ê³„ì‚°
                    â””â”€â”€ 4. ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
                    â”‚
                    â–¼
           MoltBot Brain ì—°ë™ (NEW)
                    â”‚
                    â””â”€â”€ ì¼ì¼ ë¦¬í¬íŠ¸ ìƒì„±
```

---

## ğŸ“‹ ê·œì¹™ ì—”ì§„ (Rule Engine)

### ê¸°ë³¸ ê·œì¹™

| ID | ê·œì¹™ | ëª¨ë“œ | ì•¡ì…˜ |
|---|---|---|---|
| ATT_001 | ì—°ì† ê²°ì„ 2íšŒ | Auto | í•™ë¶€ëª¨ ë¦¬ë§ˆì¸ë” |
| ATT_002 | ì—°ì† ê²°ì„ 3íšŒ | Shadow | ë³´í˜¸ ëª¨ë“œ ì§„ì… |
| ATT_003 | ì¶œì„ë¥  < 70% | Auto | ìœ„í—˜ í”Œë˜ê·¸ |
| PAY_001 | ë§ˆê° 3ì¼ ì „ | Auto | ìˆ˜ë‚© ë¦¬ë§ˆì¸ë” |
| PAY_002 | ë¯¸ë‚© 7ì¼ ê²½ê³¼ | Shadow | ì§ì ‘ ì—°ë½ |
| RISK_001 | ì¶œì„â†“ + ì°¸ì—¬â†“ | Auto | ì´íƒˆ ê²½ê³  |

### Shadow â†’ Auto ìŠ¹ê²© ì¡°ê±´

- 10íšŒ ì´ìƒ íŠ¸ë¦¬ê±°
- ì„±ê³µë¥  70% ì´ìƒ
- ìˆ˜ë™ ìŠ¹ì¸ í•„ìš”

---

## ğŸ¯ ê²°ê³¼ í‰ê°€ (Outcome Evaluator)

### KPI

1. **ì¶œì„ë¥  ê°œì„ ** (attendance_improvement)
2. **ë¯¸ìˆ˜ê¸ˆ íšŒìˆ˜** (payment_recovery)
3. **ì¬ë“±ë¡ë¥ ** (retention_rate)
4. **ê°œì… íšŸìˆ˜ ê°ì†Œ** (intervention_reduction)
5. **ìƒíƒœ ê°œì„ ** (state_improvement)

### í•™ìŠµ ë£¨í”„

```
ê°œì… ì‹¤í–‰ â†’ ê²°ê³¼ ì¸¡ì • â†’ ì„±ê³µ/ì‹¤íŒ¨ íŒì • â†’ ê·œì¹™ ì¡°ì •
    â”‚
    â””â”€â”€ ì„±ê³µë¥  70%+ â†’ Auto ìŠ¹ê²© ì œì•ˆ
    â””â”€â”€ ì„±ê³µë¥  30%- â†’ ì„ê³„ê°’ ì¡°ì • ì œì•ˆ
```

---

## ğŸ”Œ ì—°ë™ í¬ì¸íŠ¸

### 1. Supabase â†’ MoltBot Brain

```javascript
// Edge Functionì—ì„œ Brain API í˜¸ì¶œ
const brainResponse = await fetch(
  'https://autus-api.vercel.app/api/moltbot/process',
  {
    method: 'POST',
    body: JSON.stringify({
      event: 'attendance',
      student_id: studentId,
      data: { status: 'present', class_id: classId }
    })
  }
);
```

### 2. MoltBot Brain â†’ Telegram

```javascript
// Brainì—ì„œ ì•Œë¦¼ í•„ìš” ì‹œ
if (result.needs_human_attention) {
  await sendTelegramNotification({
    chat_id: OWNER_CHAT_ID,
    message: `âš ï¸ [${result.rule_name}] ${result.student_name} í•™ìƒ ì£¼ì˜ í•„ìš”`
  });
}
```

### 3. Telegram â†’ Claude CLI â†’ Brain

```javascript
// /brain ëª…ë ¹
bot.onText(/\/brain status/, async (msg) => {
  const dashboard = moltBotBrain.getDashboard();
  // ëŒ€ì‹œë³´ë“œ í‘œì‹œ
});
```

---

## ğŸ“ íŒŒì¼ êµ¬ì¡° (ìµœì¢…)

```
moltbot-brain/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ intervention-log.js   # ê°œì… ê¸°ë¡
â”‚   â”œâ”€â”€ rule-engine.js        # ê·œì¹™ ì—”ì§„
â”‚   â”œâ”€â”€ state-graph.js        # ìƒíƒœ ê·¸ë˜í”„
â”‚   â””â”€â”€ outcome-evaluator.js  # ê²°ê³¼ í‰ê°€
â”œâ”€â”€ adapters/
â”‚   â”œâ”€â”€ supabase-adapter.js   # Supabase ì—°ë™ (NEW)
â”‚   â”œâ”€â”€ telegram-adapter.js   # Telegram ì•Œë¦¼ (NEW)
â”‚   â””â”€â”€ constitution-adapter.js # Core Kernel ì—°ë™ (NEW)
â”œâ”€â”€ api/
â”‚   â””â”€â”€ routes.js             # API ì—”ë“œí¬ì¸íŠ¸ (NEW)
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ interventions.jsonl   # ê°œì… ë¡œê·¸
â”œâ”€â”€ rules/
â”‚   â””â”€â”€ custom-rules.json     # ì»¤ìŠ¤í…€ ê·œì¹™
â”œâ”€â”€ state/
â”‚   â””â”€â”€ graph.json            # ìƒíƒœ ê·¸ë˜í”„ ì €ì¥
â”œâ”€â”€ index.js                  # í†µí•© ì¸í„°í˜ì´ìŠ¤
â”œâ”€â”€ test.js                   # í…ŒìŠ¤íŠ¸
â””â”€â”€ ARCHITECTURE.md           # ì´ ë¬¸ì„œ
```

---

## âœ… ë‹¤ìŒ ë‹¨ê³„

1. **adapters/supabase-adapter.js** - Edge Function â†” Brain ì—°ë™
2. **adapters/telegram-adapter.js** - ì•Œë¦¼ ë° ëª…ë ¹ ì²˜ë¦¬
3. **adapters/constitution-adapter.js** - AUTUS í—Œë²• ì¤€ìˆ˜ ê²€ì¦
4. **api/routes.js** - REST API ì—”ë“œí¬ì¸íŠ¸
5. **Edge Function ìˆ˜ì •** - Brain í˜¸ì¶œ ì¶”ê°€
