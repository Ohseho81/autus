{
  "name": "AUTUS Parasitic ìë™ ë™ê¸°í™”",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [{ "field": "hours", "hoursInterval": 1 }]
        }
      },
      "id": "schedule",
      "name": "1ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [250, 300]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "={{ $env.AUTUS_API_URL }}/parasitic/status"
      },
      "id": "get_status",
      "name": "Parasitic ìƒíƒœ ì¡°íšŒ",
      "type": "n8n-nodes-base.httpRequest",
      "position": [450, 300]
    },
    {
      "parameters": {
        "functionCode": "// PARASITIC ë‹¨ê³„ ì»¤ë„¥í„° í•„í„°ë§\nconst data = $input.item.json;\nconst connectors = Object.entries(data.connectors || {});\n\nconst parasiticConnectors = connectors.filter(\n  ([id, c]) => c.stage === 'parasitic' && c.sync_count < 10\n);\n\nif (parasiticConnectors.length === 0) {\n  return [{ json: { action: 'skip', reason: 'ë™ê¸°í™” ëŒ€ìƒ ì—†ìŒ' } }];\n}\n\n// ê° ì»¤ë„¥í„°ì— ëŒ€í•´ ì•„ì´í…œ ìƒì„±\nreturn parasiticConnectors.map(([id, c]) => ({\n  json: {\n    connector_id: id,\n    saas_type: c.type,\n    sync_count: c.sync_count,\n    action: 'sync'\n  }\n}));"
      },
      "id": "filter_connectors",
      "name": "ë™ê¸°í™” ëŒ€ìƒ í•„í„°",
      "type": "n8n-nodes-base.function",
      "position": [650, 300]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.action }}",
              "value2": "sync"
            }
          ]
        }
      },
      "id": "need_sync",
      "name": "ë™ê¸°í™” í•„ìš”?",
      "type": "n8n-nodes-base.if",
      "position": [850, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $env.AUTUS_API_URL }}/parasitic/sync/{{ $json.connector_id }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ timestamp: new Date().toISOString() }) }}"
      },
      "id": "sync_data",
      "name": "ë°ì´í„° ë™ê¸°í™”",
      "type": "n8n-nodes-base.httpRequest",
      "position": [1050, 200]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.status }}",
              "value2": "ready_for_absorption"
            }
          ]
        }
      },
      "id": "ready_absorb",
      "name": "í¡ìˆ˜ ì¤€ë¹„?",
      "type": "n8n-nodes-base.if",
      "position": [1250, 200]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $env.SLACK_WEBHOOK_URL }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ text: 'ğŸ¦  *Parasitic í¡ìˆ˜ ì¤€ë¹„ ì™„ë£Œ*\\nì»¤ë„¥í„°: ' + $json.connector_id + '\\në™ê¸°í™” íšŸìˆ˜: 10íšŒ ì´ìƒ\\në‹¤ìŒ ë‹¨ê³„: `/parasitic/absorb/' + $json.connector_id + '`' }) }}"
      },
      "id": "notify_ready",
      "name": "Slack ì•Œë¦¼",
      "type": "n8n-nodes-base.httpRequest",
      "position": [1450, 100]
    },
    {
      "parameters": {
        "functionCode": "console.log('Sync completed:', $json);\nreturn [$input.item];"
      },
      "id": "log_sync",
      "name": "ë¡œê·¸",
      "type": "n8n-nodes-base.function",
      "position": [1450, 300]
    }
  ],
  "connections": {
    "1ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰": {
      "main": [[{ "node": "Parasitic ìƒíƒœ ì¡°íšŒ", "type": "main", "index": 0 }]]
    },
    "Parasitic ìƒíƒœ ì¡°íšŒ": {
      "main": [[{ "node": "ë™ê¸°í™” ëŒ€ìƒ í•„í„°", "type": "main", "index": 0 }]]
    },
    "ë™ê¸°í™” ëŒ€ìƒ í•„í„°": {
      "main": [[{ "node": "ë™ê¸°í™” í•„ìš”?", "type": "main", "index": 0 }]]
    },
    "ë™ê¸°í™” í•„ìš”?": {
      "main": [
        [{ "node": "ë°ì´í„° ë™ê¸°í™”", "type": "main", "index": 0 }],
        [{ "node": "ë¡œê·¸", "type": "main", "index": 0 }]
      ]
    },
    "ë°ì´í„° ë™ê¸°í™”": {
      "main": [[{ "node": "í¡ìˆ˜ ì¤€ë¹„?", "type": "main", "index": 0 }]]
    },
    "í¡ìˆ˜ ì¤€ë¹„?": {
      "main": [
        [{ "node": "Slack ì•Œë¦¼", "type": "main", "index": 0 }],
        [{ "node": "ë¡œê·¸", "type": "main", "index": 0 }]
      ]
    },
    "Slack ì•Œë¦¼": {
      "main": [[{ "node": "ë¡œê·¸", "type": "main", "index": 0 }]]
    }
  }
}


{
  "name": "AUTUS Parasitic ìë™ ë™ê¸°í™”",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [{ "field": "hours", "hoursInterval": 1 }]
        }
      },
      "id": "schedule",
      "name": "1ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [250, 300]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "={{ $env.AUTUS_API_URL }}/parasitic/status"
      },
      "id": "get_status",
      "name": "Parasitic ìƒíƒœ ì¡°íšŒ",
      "type": "n8n-nodes-base.httpRequest",
      "position": [450, 300]
    },
    {
      "parameters": {
        "functionCode": "// PARASITIC ë‹¨ê³„ ì»¤ë„¥í„° í•„í„°ë§\nconst data = $input.item.json;\nconst connectors = Object.entries(data.connectors || {});\n\nconst parasiticConnectors = connectors.filter(\n  ([id, c]) => c.stage === 'parasitic' && c.sync_count < 10\n);\n\nif (parasiticConnectors.length === 0) {\n  return [{ json: { action: 'skip', reason: 'ë™ê¸°í™” ëŒ€ìƒ ì—†ìŒ' } }];\n}\n\n// ê° ì»¤ë„¥í„°ì— ëŒ€í•´ ì•„ì´í…œ ìƒì„±\nreturn parasiticConnectors.map(([id, c]) => ({\n  json: {\n    connector_id: id,\n    saas_type: c.type,\n    sync_count: c.sync_count,\n    action: 'sync'\n  }\n}));"
      },
      "id": "filter_connectors",
      "name": "ë™ê¸°í™” ëŒ€ìƒ í•„í„°",
      "type": "n8n-nodes-base.function",
      "position": [650, 300]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.action }}",
              "value2": "sync"
            }
          ]
        }
      },
      "id": "need_sync",
      "name": "ë™ê¸°í™” í•„ìš”?",
      "type": "n8n-nodes-base.if",
      "position": [850, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $env.AUTUS_API_URL }}/parasitic/sync/{{ $json.connector_id }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ timestamp: new Date().toISOString() }) }}"
      },
      "id": "sync_data",
      "name": "ë°ì´í„° ë™ê¸°í™”",
      "type": "n8n-nodes-base.httpRequest",
      "position": [1050, 200]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.status }}",
              "value2": "ready_for_absorption"
            }
          ]
        }
      },
      "id": "ready_absorb",
      "name": "í¡ìˆ˜ ì¤€ë¹„?",
      "type": "n8n-nodes-base.if",
      "position": [1250, 200]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $env.SLACK_WEBHOOK_URL }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ text: 'ğŸ¦  *Parasitic í¡ìˆ˜ ì¤€ë¹„ ì™„ë£Œ*\\nì»¤ë„¥í„°: ' + $json.connector_id + '\\në™ê¸°í™” íšŸìˆ˜: 10íšŒ ì´ìƒ\\në‹¤ìŒ ë‹¨ê³„: `/parasitic/absorb/' + $json.connector_id + '`' }) }}"
      },
      "id": "notify_ready",
      "name": "Slack ì•Œë¦¼",
      "type": "n8n-nodes-base.httpRequest",
      "position": [1450, 100]
    },
    {
      "parameters": {
        "functionCode": "console.log('Sync completed:', $json);\nreturn [$input.item];"
      },
      "id": "log_sync",
      "name": "ë¡œê·¸",
      "type": "n8n-nodes-base.function",
      "position": [1450, 300]
    }
  ],
  "connections": {
    "1ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰": {
      "main": [[{ "node": "Parasitic ìƒíƒœ ì¡°íšŒ", "type": "main", "index": 0 }]]
    },
    "Parasitic ìƒíƒœ ì¡°íšŒ": {
      "main": [[{ "node": "ë™ê¸°í™” ëŒ€ìƒ í•„í„°", "type": "main", "index": 0 }]]
    },
    "ë™ê¸°í™” ëŒ€ìƒ í•„í„°": {
      "main": [[{ "node": "ë™ê¸°í™” í•„ìš”?", "type": "main", "index": 0 }]]
    },
    "ë™ê¸°í™” í•„ìš”?": {
      "main": [
        [{ "node": "ë°ì´í„° ë™ê¸°í™”", "type": "main", "index": 0 }],
        [{ "node": "ë¡œê·¸", "type": "main", "index": 0 }]
      ]
    },
    "ë°ì´í„° ë™ê¸°í™”": {
      "main": [[{ "node": "í¡ìˆ˜ ì¤€ë¹„?", "type": "main", "index": 0 }]]
    },
    "í¡ìˆ˜ ì¤€ë¹„?": {
      "main": [
        [{ "node": "Slack ì•Œë¦¼", "type": "main", "index": 0 }],
        [{ "node": "ë¡œê·¸", "type": "main", "index": 0 }]
      ]
    },
    "Slack ì•Œë¦¼": {
      "main": [[{ "node": "ë¡œê·¸", "type": "main", "index": 0 }]]
    }
  }
}







