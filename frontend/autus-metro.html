<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AUTUS METRO â€” Decision Physics Interface</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{
      /* ì„œìš¸ì‹œ ê³µì‹ ë…¸ì„  ìƒ‰ìƒ */
      --L1:#0052A4;--L2:#00A84D;--L3:#EF7C1C;--L4:#00A5DE;--L5:#996CAC;
      --L6:#CD7C2F;--L7:#747F00;--L8:#E6186C;--L9:#BDB092;--LS:#D31F5B;
      --LK:#77C4A3;--LB:#F5A200;--LA:#0090D2;--LU:#B0CE18;
      --river:#D4E9F7;--bg:#FAFAFA;--abort:#E74C3C;
    }
    html,body{width:100%;height:100%;background:var(--bg);font-family:'SF Pro Display','Apple SD Gothic Neo',sans-serif;overflow:hidden}
    .app{width:100%;height:100%;display:flex;flex-direction:column}
    
    /* í—¤ë” */
    .hd{display:flex;justify-content:space-between;align-items:center;padding:12px 20px;background:#fff;border-bottom:1px solid #e5e5e5;flex-shrink:0}
    .hd-l{display:flex;align-items:center;gap:12px}
    .hd-l button{width:36px;height:36px;background:none;border:none;font-size:20px;cursor:pointer}
    .hd-title{font-size:16px;font-weight:700;color:#111}
    .hd-sub{font-size:11px;color:#888;margin-left:8px}
    .hd-r{display:flex;align-items:center;gap:10px}
    .badge{padding:5px 12px;border-radius:20px;font-size:11px;font-weight:600;color:#fff}
    .status-bar{display:flex;gap:16px;font-size:11px;color:#666}
    .status-item{display:flex;align-items:center;gap:4px}
    .status-dot{width:8px;height:8px;border-radius:50%}
    
    /* ë©”íŠ¸ë¡œ ë§µ */
    .metro-wrap{flex:1;overflow:auto;background:var(--bg);position:relative}
    .metro-inner{width:1600px;height:1200px;position:relative;margin:20px}
    svg{width:100%;height:100%}
    
    /* ë…¸ì„  ìŠ¤íƒ€ì¼ - 8ì„ í˜• ê·œì¹™ */
    .line{fill:none;stroke-linecap:round;stroke-linejoin:round}
    .L1{stroke:var(--L1);stroke-width:6}
    .L2{stroke:var(--L2);stroke-width:6}
    .L3{stroke:var(--L3);stroke-width:6}
    .L4{stroke:var(--L4);stroke-width:6}
    .L5{stroke:var(--L5);stroke-width:5}
    .L6{stroke:var(--L6);stroke-width:5}
    .L7{stroke:var(--L7);stroke-width:5}
    .L8{stroke:var(--L8);stroke-width:5}
    .L9{stroke:var(--L9);stroke-width:5}
    .LS{stroke:var(--LS);stroke-width:5}
    .LK{stroke:var(--LK);stroke-width:5}
    .LB{stroke:var(--LB);stroke-width:5}
    .LA{stroke:var(--LA);stroke-width:5}
    
    .line-blocked{stroke-dasharray:8,4;animation:blocked 1s infinite}
    @keyframes blocked{0%,100%{opacity:1}50%{opacity:0.4}}
    
    /* í•œê°• */
    .river{fill:none;stroke:var(--river);stroke-width:40;stroke-linecap:round}
    
    /* ì—­ (Event Node) */
    .station{fill:#fff;stroke:#555;stroke-width:2;cursor:pointer;transition:all 0.15s}
    .station:hover{stroke-width:3;filter:drop-shadow(0 0 6px rgba(0,0,0,0.2))}
    .station-current{fill:var(--L2);stroke:var(--L2);stroke-width:3}
    .station-abort{fill:var(--abort);stroke:var(--abort)}
    .station-visited{fill:#ccc;stroke:#999}
    .station-glow{animation:stationPulse 2s infinite}
    @keyframes stationPulse{0%,100%{filter:drop-shadow(0 0 0 rgba(0,168,77,0.6))}50%{filter:drop-shadow(0 0 12px rgba(0,168,77,0.8))}}
    
    /* í™˜ìŠ¹ì—­ (Decision Node) */
    .transfer{fill:#fff;stroke:#333;stroke-width:3;cursor:pointer}
    .transfer:hover{stroke-width:4;filter:drop-shadow(0 0 8px rgba(0,0,0,0.25))}
    
    /* ì—­ëª… */
    .st-name{font-size:9px;fill:#333;font-weight:500;pointer-events:none}
    .st-name-lg{font-size:10px;fill:#222;font-weight:600}
    .st-name-current{fill:var(--L2);font-weight:700}
    .st-sub{font-size:7px;fill:#888}
    
    /* í˜¸ì„  ë¼ë²¨ */
    .line-label{font-size:10px;fill:#fff;font-weight:700;text-anchor:middle;dominant-baseline:central}
    
    /* Physics Overlay */
    .physics-overlay{
      position:absolute;top:0;left:0;right:0;bottom:0;
      pointer-events:none;
    }
    .energy-bar{
      position:absolute;
      width:40px;height:4px;
      background:#ddd;border-radius:2px;
      overflow:hidden;
    }
    .energy-fill{height:100%;background:var(--L2);transition:width 0.3s}
    .entropy-indicator{
      position:absolute;
      width:6px;height:6px;
      border-radius:50%;
      background:var(--L3);
      opacity:0.7;
    }
    
    /* ì´ë™ ë§ˆì»¤ */
    .moving-marker{
      fill:var(--L2);
      filter:drop-shadow(0 0 8px var(--L2));
    }
    
    /* í•˜ë‹¨ íŒ¨ë„ */
    .bottom-panel{
      padding:16px 20px 24px;
      background:#fff;
      border-top:1px solid #e5e5e5;
      flex-shrink:0;
    }
    .panel-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .current-info{display:flex;align-items:center;gap:12px}
    .current-badge{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:#fff}
    .current-name{font-weight:700;font-size:15px}
    .current-meta{font-size:11px;color:#888}
    .physics-display{display:flex;gap:20px}
    .physics-item{text-align:center}
    .physics-value{font-size:18px;font-weight:700;color:#333}
    .physics-label{font-size:9px;color:#888;text-transform:uppercase}
    .action-btn{
      width:100%;padding:14px;
      background:var(--L2);border:none;border-radius:12px;
      color:#fff;font-size:15px;font-weight:600;cursor:pointer;
    }
    
    /* ëª¨ë‹¬ - Decision Branch */
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:200;align-items:flex-end}
    .modal.on{display:flex}
    .modal-c{
      background:#fff;width:100%;max-width:500px;margin:0 auto;
      border-radius:24px 24px 0 0;padding:24px;
      max-height:75vh;overflow-y:auto;
    }
    .modal-h{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
    .modal-title{font-size:20px;font-weight:700}
    .modal-type{font-size:11px;color:#888;background:#f5f5f5;padding:4px 10px;border-radius:12px}
    .modal-x{width:36px;height:36px;border:none;background:#f0f0f0;border-radius:50%;font-size:20px;cursor:pointer}
    .modal-physics{
      display:grid;grid-template-columns:repeat(4,1fr);gap:12px;
      padding:16px;background:#f8f8f8;border-radius:12px;margin-bottom:16px;
    }
    .modal-physics-item{text-align:center}
    .modal-physics-value{font-size:16px;font-weight:700}
    .modal-physics-label{font-size:9px;color:#888}
    
    /* Branch Options */
    .branch-title{font-size:13px;font-weight:600;color:#666;margin-bottom:12px}
    .branch-list{display:flex;flex-direction:column;gap:10px}
    .branch-item{
      display:flex;align-items:center;gap:14px;
      padding:16px;border:2px solid #eee;border-radius:14px;
      cursor:pointer;transition:all 0.15s;
    }
    .branch-item:hover{border-color:#333;background:#fafafa}
    .branch-badge{
      width:48px;height:48px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      font-size:16px;font-weight:700;color:#fff;flex-shrink:0;
    }
    .branch-info{flex:1}
    .branch-name{font-weight:600;font-size:14px;margin-bottom:4px}
    .branch-desc{font-size:12px;color:#888}
    .branch-delta{text-align:right}
    .branch-delta-row{display:flex;align-items:center;gap:6px;justify-content:flex-end;margin-bottom:2px}
    .delta-label{font-size:10px;color:#888}
    .delta-value{font-size:12px;font-weight:600}
    .delta-positive{color:var(--L2)}
    .delta-negative{color:var(--abort)}
    
    /* Abort Overlay */
    .abort-overlay{
      display:none;position:fixed;inset:0;
      background:rgba(0,0,0,0.8);z-index:300;
      align-items:center;justify-content:center;flex-direction:column;
    }
    .abort-overlay.on{display:flex}
    .abort-title{font-size:32px;font-weight:700;color:var(--abort);margin-bottom:12px}
    .abort-sub{font-size:14px;color:#888}
    
    /* Progress Line */
    .progress-line{
      stroke:var(--L2);stroke-width:8;stroke-linecap:round;
      stroke-dasharray:1000;stroke-dashoffset:1000;
      animation:progressDraw 3s ease-out forwards;
    }
    @keyframes progressDraw{to{stroke-dashoffset:0}}
    
    /* Ghost Line (History) */
    .ghost-line{stroke:#ddd;stroke-width:4;stroke-dasharray:4,4;opacity:0.5}
    
    /* Entropy Heatmap */
    .entropy-zone{fill:var(--L3);opacity:0.15}
    .entropy-zone-high{opacity:0.3;animation:entropyPulse 2s infinite}
    @keyframes entropyPulse{0%,100%{opacity:0.3}50%{opacity:0.5}}
  </style>
</head>
<body>
<div class="app">
  <div class="hd">
    <div class="hd-l">
      <button onclick="goBack()">â†</button>
      <span class="hd-title">AUTUS METRO</span>
      <span class="hd-sub">Decision Physics Interface</span>
    </div>
    <div class="hd-r">
      <div class="status-bar">
        <div class="status-item"><div class="status-dot" style="background:var(--L2)"></div>ACTIVE</div>
        <div class="status-item">PNR: <b id="pnrDays">14</b>ì¼</div>
      </div>
      <span class="badge" style="background:var(--L2)" id="subjectBadge">Kim</span>
    </div>
  </div>

  <div class="metro-wrap" id="metroWrap">
    <div class="metro-inner" id="metroInner">
      <svg viewBox="0 0 1600 1200" id="metroSvg">
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             í•œê°• (ì§€ë¦¬ì  ë°°ê²½)
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="river" d="M0,650 Q400,630 600,640 Q800,660 1000,645 Q1200,625 1400,635 L1600,630"/>
        <text x="1400" y="620" style="font-size:14px;fill:#8CC4E8;font-weight:600">í•œê°• Han River</text>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             2í˜¸ì„  (ì´ˆë¡) - ì™„ì „í•œ ì›í˜• ìˆœí™˜ì„ 
             Line_EDUCATION - êµìœ¡ ìˆœí™˜ ë£¨í”„
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <ellipse cx="750" cy="520" rx="320" ry="260" class="line L2" fill="none"/>
        <!-- ì‹ ì •ì§€ì„  -->
        <path class="line L2" d="M430,580 L360,620 L290,660 L220,700"/>
        <!-- ì„±ìˆ˜ì§€ì„  -->
        <path class="line L2" d="M1040,360 L1110,320 L1180,290"/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             1í˜¸ì„  (ë‚¨ìƒ‰) - ë‚¨ë¶ ê´€í†µ
             Line_ENTRY - ì •ì„ ì…êµ­ ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line L1" d="M600,80 L600,160 L580,240 L560,320 L540,400 L520,480 L500,560 L480,640"/>
        <!-- ê²½ë¶€ì„  ë¶„ê¸° -->
        <path class="line L1" d="M480,640 L460,720 L440,800 L420,880 L400,960 L380,1040 L360,1120"/>
        <!-- ê²½ì¸ì„  ë¶„ê¸° -->
        <path class="line L1" d="M480,640 L400,700 L320,760 L240,820 L160,880 L80,940"/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             3í˜¸ì„  (ì£¼í™©) - ë¶ì„œ~ë‚¨ë™ 45Â° ëŒ€ê°ì„ 
             Line_EMPLOY - ì·¨ì—… ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line L3" d="
          M200,160 L280,210 L360,260 L440,310 L520,360 L600,410 L680,460
          L760,520 L840,580 L920,640 L1000,700 L1080,760 L1160,820 L1240,880
        "/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             4í˜¸ì„  (í•˜ëŠ˜) - ë¶ë™~ë‚¨ì„œ ëŒ€ê°ì„ 
             Line_SETTLE - ì •ì°© ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line L4" d="
          M880,80 L860,150 L840,220 L820,290 L780,360 L740,430 L700,500
          L660,570 L620,640 L580,710 L540,780 L500,850 L460,920 L420,990 L380,1060
        "/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             5í˜¸ì„  (ë³´ë¼) - ë™ì„œ ë°©í–¥
             Line_EXPERT - ì „ë¬¸ì§ ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line L5" d="
          M80,450 L170,450 L260,450 L350,450 L440,460 L530,480 L620,500
          L710,530 L800,560 L890,600 L980,650 L1070,710 L1160,780 L1250,860
        "/>
        <!-- ë§ˆì²œì§€ì„  -->
        <path class="line L5" d="M1070,710 L1140,780 L1210,850"/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             6í˜¸ì„  (í™©í† ) - ë¶ìª½ ë°˜ì›
             Line_NETWORK - ë„¤íŠ¸ì›Œí¬ ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line L6" d="
          M320,320 L400,290 L480,270 L560,260 L640,255 L720,255 L800,260
          L880,275 L960,300 L1040,340 L1100,390
        "/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             7í˜¸ì„  (ì˜¬ë¦¬ë¸Œ) - ë¶ë™~ë‚¨ì„œ ê¸´ ëŒ€ê°ì„ 
             Line_TECH - ê¸°ìˆ  ì´ë¯¼ ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line L7" d="
          M1150,120 L1110,190 L1070,260 L1030,330 L990,400 L950,470 L910,540
          L870,610 L830,680 L790,750 L740,810 L680,860 L610,900 L530,930
          L450,950 L370,960 L290,960 L210,950 L130,930
        "/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             8í˜¸ì„  (ë¶„í™) - ë™ìª½ ì§§ì€ ë…¸ì„ 
             Line_EXTEND - í™•ì¥ ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line L8" d="M1120,560 L1100,630 L1080,700 L1060,770 L1040,840 L1020,910"/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             9í˜¸ì„  (ê¸ˆìƒ‰) - í•œê°• ë‚¨ìª½ ë™ì„œ
             Line_EXPRESS - ê¸‰í–‰ íˆ¬ì ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line L9" d="
          M100,720 L200,720 L300,720 L400,740 L500,760 L600,780 L700,810
          L800,850 L900,900 L1000,960 L1100,1030
        "/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             ì‹ ë¶„ë‹¹ì„  (ë¹¨ê°•) - ê°•ë‚¨~ê´‘êµ
             Line_STARTUP - ìŠ¤íƒ€íŠ¸ì—…/íˆ¬ì ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line LS" d="M760,730 L820,810 L880,890 L940,970 L1000,1050"/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             ê³µí•­ì² ë„ (íŒŒë‘) - ì„œìª½
             Line_AIRPORT - ì¶œì…êµ­ ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line LA" d="M40,560 L140,550 L240,540 L340,520 L440,500 L540,480"/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             ê²½ì˜ì¤‘ì•™ì„  (ì²­ë¡) - ì„œë¶~ë™ë‚¨
             Line_CENTRAL - ì¤‘ì•™ ì—°ê²° ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line LK" d="
          M60,350 L160,380 L260,410 L360,440 L460,480 L560,530 L660,590
          L760,660 L860,740 L960,830 L1060,930
        "/>
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             ë¶„ë‹¹ì„  (ë…¸ë‘) - ë™ìª½
             Line_SUBURB - ìˆ˜ë„ê¶Œ ì—°ê²° ê²½ë¡œ
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <path class="line LB" d="
          M640,280 L700,350 L760,420 L820,500 L880,590 L940,690 L1000,800 L1060,920
        "/>
        
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             STATIONS (Event Nodes)
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <g id="stations">
          
          <!-- === 2í˜¸ì„  ìˆœí™˜ === -->
          
          <!-- ì‹œì²­ -->
          <circle class="station" cx="430" cy="480" r="7" data-id="EVT_CITY" onclick="openNode('city')"/>
          <text class="st-name" x="395" y="475">ì‹œì²­</text>
          
          <!-- ì„ì§€ë¡œì…êµ¬ -->
          <circle class="station" cx="500" cy="400" r="6" data-id="EVT_EULJIRO1"/>
          <text class="st-name" x="510" y="395">ì„ì§€ë¡œì…êµ¬</text>
          
          <!-- ì„ì§€ë¡œ3ê°€ -->
          <circle class="station" cx="580" cy="340" r="6" data-id="EVT_EULJIRO3" onclick="openNode('euljiro3')"/>
          <text class="st-name" x="540" y="330">ì„ì§€ë¡œ3ê°€</text>
          
          <!-- ì„ì§€ë¡œ4ê°€ -->
          <circle class="station" cx="660" cy="300" r="6" data-id="EVT_EULJIRO4"/>
          <text class="st-name" x="670" y="295">ì„ì§€ë¡œ4ê°€</text>
          
          <!-- â˜… ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì› - í˜„ì¬ ìœ„ì¹˜ (Current Event) -->
          <circle class="station station-current station-glow" cx="760" cy="300" r="10" data-id="EVT_DDP" onclick="openNode('ddp')"/>
          <text class="st-name-lg st-name-current" x="780" y="290">ë™ëŒ€ë¬¸ì—­ì‚¬</text>
          <text class="st-sub" x="780" y="305" style="fill:var(--L2)">í˜„ì¬ ìœ„ì¹˜ Â· EVENT_ACTIVE</text>
          
          <!-- ì‹ ë‹¹ -->
          <circle class="station" cx="860" cy="320" r="6" data-id="EVT_SINDANG"/>
          <text class="st-name" x="875" y="318">ì‹ ë‹¹</text>
          
          <!-- ìƒì™•ì‹­ë¦¬ -->
          <circle class="station" cx="940" cy="360" r="6" data-id="EVT_SANGWANG"/>
          <text class="st-name" x="955" y="358">ìƒì™•ì‹­ë¦¬</text>
          
          <!-- ì™•ì‹­ë¦¬ (Decision Node) -->
          <circle class="transfer" cx="1000" cy="420" r="12" data-id="DEC_WANGSIMNI" onclick="openNode('wangsimni')"/>
          <text class="st-name-lg" x="1020" y="415">ì™•ì‹­ë¦¬</text>
          <text class="st-sub" x="1020" y="430">DECISION Â· 2Â·5Â·ê²½ì˜Â·ë¶„ë‹¹</text>
          
          <!-- í•œì–‘ëŒ€ -->
          <circle class="station" cx="1040" cy="480" r="6" data-id="EVT_HANYANG"/>
          <text class="st-name" x="1055" y="478">í•œì–‘ëŒ€</text>
          
          <!-- ëšì„¬ -->
          <circle class="station" cx="1060" cy="540" r="6" data-id="EVT_TTUKSEOM"/>
          <text class="st-name" x="1075" y="538">ëšì„¬</text>
          
          <!-- ì„±ìˆ˜ -->
          <circle class="station" cx="1060" cy="600" r="7" data-id="EVT_SEONGSU" onclick="openNode('seongsu')"/>
          <text class="st-name" x="1075" y="598">ì„±ìˆ˜</text>
          
          <!-- ê±´ëŒ€ì…êµ¬ -->
          <circle class="transfer" cx="1040" cy="660" r="10" data-id="DEC_KONKUK" onclick="openNode('konkuk')"/>
          <text class="st-name-lg" x="1055" y="658">ê±´ëŒ€ì…êµ¬</text>
          <text class="st-sub" x="1055" y="673">DECISION Â· 2Â·7</text>
          
          <!-- êµ¬ì˜ -->
          <circle class="station" cx="1000" cy="720" r="6" data-id="EVT_GUUI"/>
          <text class="st-name" x="1015" y="718">êµ¬ì˜</text>
          
          <!-- ê°•ë³€ -->
          <circle class="station" cx="960" cy="760" r="6" data-id="EVT_GANGBYEON"/>
          <text class="st-name" x="920" y="765">ê°•ë³€</text>
          
          <!-- ì ì‹¤ë‚˜ë£¨ -->
          <circle class="station" cx="920" cy="780" r="6" data-id="EVT_JAMSILNARU"/>
          <text class="st-name" x="880" y="795">ì ì‹¤ë‚˜ë£¨</text>
          
          <!-- ì ì‹¤ (Decision Node) -->
          <circle class="transfer" cx="880" cy="760" r="11" data-id="DEC_JAMSIL" onclick="openNode('jamsil')"/>
          <text class="st-name-lg" x="845" y="785">ì ì‹¤</text>
          <text class="st-sub" x="845" y="800">DECISION Â· 2Â·8</text>
          
          <!-- ì¢…í•©ìš´ë™ì¥ -->
          <circle class="transfer" cx="820" cy="740" r="9" data-id="DEC_SPORTS" onclick="openNode('sports')"/>
          <text class="st-name" x="770" y="755">ì¢…í•©ìš´ë™ì¥</text>
          
          <!-- ì‚¼ì„± -->
          <circle class="station" cx="780" cy="720" r="7" data-id="EVT_SAMSUNG"/>
          <text class="st-name" x="785" y="740">ì‚¼ì„±</text>
          
          <!-- ì„ ë¦‰ -->
          <circle class="transfer" cx="740" cy="710" r="8" data-id="DEC_SEOLLEUNG" onclick="openNode('seolleung')"/>
          <text class="st-name" x="700" y="725">ì„ ë¦‰</text>
          
          <!-- â˜… ê°•ë‚¨ (Major Decision Node) -->
          <circle class="transfer" cx="700" cy="700" r="13" data-id="DEC_GANGNAM" onclick="openNode('gangnam')"/>
          <text class="st-name-lg" x="650" y="720">ê°•ë‚¨</text>
          <text class="st-sub" x="650" y="735">DECISION Â· 2Â·ì‹ ë¶„ë‹¹</text>
          
          <!-- ì—­ì‚¼ -->
          <circle class="station" cx="660" cy="690" r="6" data-id="EVT_YEOKSAM"/>
          <text class="st-name" x="620" y="695">ì—­ì‚¼</text>
          
          <!-- êµëŒ€ (Decision Node) -->
          <circle class="transfer" cx="620" cy="680" r="9" data-id="DEC_GYODAE" onclick="openNode('gyodae')"/>
          <text class="st-name" x="575" y="695">êµëŒ€</text>
          
          <!-- ì„œì´ˆ -->
          <circle class="station" cx="580" cy="670" r="6" data-id="EVT_SEOCHO"/>
          <text class="st-name" x="540" y="680">ì„œì´ˆ</text>
          
          <!-- ë°©ë°° -->
          <circle class="station" cx="540" cy="660" r="6" data-id="EVT_BANGBAE"/>
          <text class="st-name" x="500" y="670">ë°©ë°°</text>
          
          <!-- ì‚¬ë‹¹ (Decision Node) -->
          <circle class="transfer" cx="500" cy="650" r="10" data-id="DEC_SADANG" onclick="openNode('sadang')"/>
          <text class="st-name-lg" x="455" y="665">ì‚¬ë‹¹</text>
          <text class="st-sub" x="455" y="680">DECISION Â· 2Â·4</text>
          
          <!-- ë‚™ì„±ëŒ€ -->
          <circle class="station" cx="460" cy="620" r="6" data-id="EVT_NAKSEONGDAE"/>
          <text class="st-name" x="415" y="625">ë‚™ì„±ëŒ€</text>
          
          <!-- ì„œìš¸ëŒ€ì…êµ¬ -->
          <circle class="station" cx="440" cy="580" r="6" data-id="EVT_SNU"/>
          <text class="st-name" x="390" y="585">ì„œìš¸ëŒ€ì…êµ¬</text>
          
          <!-- ì‹ ë„ë¦¼ (Decision Node) -->
          <circle class="transfer" cx="430" cy="540" r="11" data-id="DEC_SINDORIM" onclick="openNode('sindorim')"/>
          <text class="st-name-lg" x="375" y="545">ì‹ ë„ë¦¼</text>
          <text class="st-sub" x="375" y="560">DECISION Â· 1Â·2</text>
          
          <!-- ì˜ë“±í¬êµ¬ì²­ -->
          <circle class="transfer" cx="450" cy="500" r="8" data-id="DEC_YOUNGDEUNGPO"/>
          <text class="st-name" x="395" y="500">ì˜ë“±í¬êµ¬ì²­</text>
          
          <!-- ë‹¹ì‚° -->
          <circle class="transfer" cx="420" cy="460" r="8" data-id="DEC_DANGSAN" onclick="openNode('dangsan')"/>
          <text class="st-name" x="375" y="455">ë‹¹ì‚°</text>
          
          <!-- í•©ì • (Decision Node) -->
          <circle class="transfer" cx="400" cy="420" r="9" data-id="DEC_HAPJEONG" onclick="openNode('hapjeong')"/>
          <text class="st-name" x="355" y="415">í•©ì •</text>
          
          <!-- í™ëŒ€ì…êµ¬ (Major Decision Node) -->
          <circle class="transfer" cx="400" cy="380" r="11" data-id="DEC_HONGDAE" onclick="openNode('hongdae')"/>
          <text class="st-name-lg" x="345" y="370">í™ëŒ€ì…êµ¬</text>
          <text class="st-sub" x="345" y="385">DECISION Â· 2Â·AÂ·ê²½ì˜</text>
          
          <!-- ì‹ ì´Œ -->
          <circle class="station" cx="430" cy="350" r="6" data-id="EVT_SINCHON"/>
          <text class="st-name" x="440" y="345">ì‹ ì´Œ</text>
          
          <!-- ì´ëŒ€ -->
          <circle class="station" cx="460" cy="330" r="6" data-id="EVT_EWHA"/>
          <text class="st-name" x="470" y="325">ì´ëŒ€</text>
          
          <!-- ì•„í˜„ -->
          <circle class="station" cx="480" cy="320" r="5" data-id="EVT_AHYEON"/>
          <text class="st-name" x="490" y="315">ì•„í˜„</text>
          
          
          <!-- === ì£¼ìš” í™˜ìŠ¹ì—­ === -->
          
          <!-- â˜… ì„œìš¸ì—­ (Major Decision Node) -->
          <circle class="transfer" cx="520" cy="480" r="13" data-id="DEC_SEOUL" onclick="openNode('seoul')"/>
          <text class="st-name-lg" x="540" y="475">ì„œìš¸ì—­</text>
          <text class="st-sub" x="540" y="490">DECISION Â· 1Â·4Â·AÂ·ê²½ì˜</text>
          
          <!-- â˜… ê³ ì†í„°ë¯¸ë„ (Major Decision Node) -->
          <circle class="transfer" cx="660" cy="760" r="12" data-id="DEC_EXPRESS" onclick="openNode('gosok')"/>
          <text class="st-name-lg" x="600" y="780">ê³ ì†í„°ë¯¸ë„</text>
          <text class="st-sub" x="600" y="795">DECISION Â· 3Â·7Â·9</text>
          
          <!-- ì¢…ë¡œ3ê°€ (Decision Node) -->
          <circle class="transfer" cx="560" cy="400" r="10" data-id="DEC_JONGNO3" onclick="openNode('jongno3')"/>
          <text class="st-name-lg" x="510" y="395">ì¢…ë¡œ3ê°€</text>
          <text class="st-sub" x="510" y="410">DECISION Â· 1Â·3Â·5</text>
          
          <!-- ê³µë• (Major Decision Node) -->
          <circle class="transfer" cx="380" cy="480" r="11" data-id="DEC_GONGDEOK" onclick="openNode('gongdeok')"/>
          <text class="st-name-lg" x="320" y="495">ê³µë•</text>
          <text class="st-sub" x="320" y="510">DECISION Â· 5Â·6Â·AÂ·ê²½ì˜</text>
          
          <!-- ì—¬ì˜ë„ -->
          <circle class="transfer" cx="450" cy="720" r="9" data-id="DEC_YEOUIDO" onclick="openNode('yeouido')"/>
          <text class="st-name" x="400" y="735">ì—¬ì˜ë„</text>
          
          <!-- ë…¸ì› (Decision Node) -->
          <circle class="transfer" cx="1020" cy="220" r="10" data-id="DEC_NOWON" onclick="openNode('nowon')"/>
          <text class="st-name-lg" x="1040" y="215">ë…¸ì›</text>
          <text class="st-sub" x="1040" y="230">DECISION Â· 4Â·7</text>
          
          <!-- ì²­ëŸ‰ë¦¬ -->
          <circle class="transfer" cx="700" cy="260" r="9" data-id="DEC_CHEONGNYANGNI"/>
          <text class="st-name" x="715" y="255">ì²­ëŸ‰ë¦¬</text>
          
          <!-- ìˆ˜ì„œ -->
          <circle class="transfer" cx="980" cy="820" r="9" data-id="DEC_SUSEO" onclick="openNode('suseo')"/>
          <text class="st-name" x="995" y="818">ìˆ˜ì„œ</text>
          
          <!-- ê°€ì‚°ë””ì§€í„¸ë‹¨ì§€ -->
          <circle class="transfer" cx="350" cy="800" r="9" data-id="DEC_GASAN" onclick="openNode('gasan')"/>
          <text class="st-name" x="285" y="815">ê°€ì‚°ë””ì§€í„¸ë‹¨ì§€</text>
          
          
          <!-- === ABORT NODES (í•˜ì°¨ = í¬ê¸°) === -->
          
          <!-- â˜… ê¹€í¬ê³µí•­ (Abort Node) -->
          <circle class="station station-abort" cx="160" cy="550" r="11" data-id="ABORT_GIMPO" onclick="openNode('gimpo')"/>
          <text class="st-name-lg" x="100" y="545" style="fill:var(--abort)">ê¹€í¬ê³µí•­</text>
          <text class="st-sub" x="100" y="560" style="fill:var(--abort)">âš ï¸ ABORT_EXIT</text>
          
          <!-- ì¸ì²œê³µí•­ (Entry Point) -->
          <circle class="station" cx="40" cy="560" r="9" data-id="EVT_INCHEON" onclick="openNode('incheon')"/>
          <text class="st-name-lg" x="20" y="540">ì¸ì²œê³µí•­</text>
          <text class="st-sub" x="20" y="555">ENTRY_POINT</text>
          
        </g>
        
        
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             LINE LABELS
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <g id="lineLabels">
          <circle cx="600" cy="120" r="16" fill="var(--L1)"/><text class="line-label" x="600" y="120">1</text>
          <circle cx="260" cy="700" r="16" fill="var(--L2)"/><text class="line-label" x="260" y="700">2</text>
          <circle cx="240" cy="180" r="16" fill="var(--L3)"/><text class="line-label" x="240" y="180">3</text>
          <circle cx="860" cy="120" r="16" fill="var(--L4)"/><text class="line-label" x="860" y="120">4</text>
          <circle cx="120" cy="450" r="16" fill="var(--L5)"/><text class="line-label" x="120" y="450">5</text>
          <circle cx="360" cy="300" r="14" fill="var(--L6)"/><text class="line-label" x="360" y="300">6</text>
          <circle cx="1120" cy="160" r="14" fill="var(--L7)"/><text class="line-label" x="1120" y="160">7</text>
          <circle cx="1120" cy="600" r="14" fill="var(--L8)"/><text class="line-label" x="1120" y="600">8</text>
          <circle cx="140" cy="720" r="14" fill="var(--L9)"/><text class="line-label" x="140" y="720">9</text>
          <circle cx="960" cy="1010" r="12" fill="var(--LS)"/><text class="line-label" x="960" y="1010" style="font-size:8px">ì‹ </text>
          <circle cx="100" cy="380" r="12" fill="var(--LK)"/><text class="line-label" x="100" y="380" style="font-size:8px">ê²½ì˜</text>
          <circle cx="60" cy="560" r="12" fill="var(--LA)"/><text class="line-label" x="60" y="560" style="font-size:8px">A</text>
          <circle cx="680" cy="300" r="12" fill="var(--LB)"/><text class="line-label" x="680" y="300" style="font-size:8px">ë¶„ë‹¹</text>
        </g>
        
        <!-- Goal Marker -->
        <g id="goal">
          <text x="1350" y="150" style="font-size:40px">ğŸ¯</text>
          <text class="st-name-lg" x="1400" y="145">ì •ì°© ì™„ë£Œ</text>
          <text class="st-sub" x="1400" y="162">GOAL_STATE Â· PNR #24</text>
        </g>
        
      </svg>
    </div>
  </div>

  <div class="bottom-panel">
    <div class="panel-row">
      <div class="current-info">
        <div class="current-badge" style="background:var(--L2)">2</div>
        <div>
          <div class="current-name">ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì›</div>
          <div class="current-meta">EVENT_ACTIVE Â· 2Â·4Â·5í˜¸ì„ </div>
        </div>
      </div>
      <div class="physics-display">
        <div class="physics-item">
          <div class="physics-value" id="energyValue">0.72</div>
          <div class="physics-label">Energy</div>
        </div>
        <div class="physics-item">
          <div class="physics-value" id="entropyValue">0.38</div>
          <div class="physics-label">Entropy</div>
        </div>
        <div class="physics-item">
          <div class="physics-value" id="riskValue">0.24</div>
          <div class="physics-label">Risk</div>
        </div>
        <div class="physics-item">
          <div class="physics-value" id="velocityValue">1.2</div>
          <div class="physics-label">Velocity</div>
        </div>
      </div>
    </div>
    <button class="action-btn" onclick="goMain()">í˜„ì¬ ì´ë²¤íŠ¸ë¡œ ì´ë™</button>
  </div>
</div>

<!-- Decision Branch Modal -->
<div class="modal" id="modal">
  <div class="modal-c">
    <div class="modal-h">
      <div>
        <div class="modal-title" id="mTitle">Decision Node</div>
        <span class="modal-type" id="mType">DECISION</span>
      </div>
      <button class="modal-x" onclick="closeModal()">Ã—</button>
    </div>
    
    <div class="modal-physics">
      <div class="modal-physics-item">
        <div class="modal-physics-value" id="mEnergy">0.72</div>
        <div class="modal-physics-label">Energy</div>
      </div>
      <div class="modal-physics-item">
        <div class="modal-physics-value" id="mEntropy">0.38</div>
        <div class="modal-physics-label">Entropy</div>
      </div>
      <div class="modal-physics-item">
        <div class="modal-physics-value" id="mRisk">0.24</div>
        <div class="modal-physics-label">Risk</div>
      </div>
      <div class="modal-physics-item">
        <div class="modal-physics-value" id="mTime">3.5</div>
        <div class="modal-physics-label">Time Cost</div>
      </div>
    </div>
    
    <div class="branch-title">FORECAST BRANCH â€” ê²½ë¡œ ì„ íƒ</div>
    <div class="branch-list" id="mList"></div>
  </div>
</div>

<!-- Abort Overlay -->
<div class="abort-overlay" id="abortOverlay">
  <div class="abort-title">MISSION TERMINATED</div>
  <div class="abort-sub">Recovery Time: 6.0 months</div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTUS PHYSICS KERNEL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const PhysicsKernel = {
  // ê¸°ë³¸ ì´ë™ ê³µì‹: Î”t = distance / velocity Ã— (1 + entropy)
  calcTime: (distance, velocity, entropy) => distance / velocity * (1 + entropy),
  
  // ì—ë„ˆì§€ ë³€í™”: Energy(t+1) = Energy(t) - friction - transfer_loss
  updateEnergy: (current, friction, transferLoss = 0) => Math.max(0, current - friction - transferLoss),
  
  // ì—”íŠ¸ë¡œí”¼ ì¦ê°€: Entropy(t+1) = Entropy(t) + complexity Ã— uncertainty
  updateEntropy: (current, complexity, uncertainty) => Math.min(1, current + complexity * uncertainty),
  
  // ë¦¬ìŠ¤í¬ ëˆ„ì : Risk = 1 - e^(-Î£(shock_i))
  calcRisk: (shocks) => 1 - Math.exp(-shocks.reduce((a, b) => a + b, 0)),
  
  // PNR ê³„ì‚°
  calcPNR: (energy, entropy, risk) => Math.round(30 * energy * (1 - entropy) * (1 - risk))
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NODE DATA (Event / Decision / Abort)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const nodes = {
  // Decision Nodes
  seoul: {
    type: 'DECISION',
    label: 'ì„œìš¸ì—­',
    energy: 0.75, entropy: 0.32, risk: 0.20, time_cost: 2.0,
    options: [
      { line: '1', color: 'var(--L1)', name: 'Line_ENTRY ì •ì„ì…êµ­', desc: 'ë¹„ìâ†’êµìœ¡â†’ì·¨ì—… ë£¨íŠ¸', delta: { energy: -0.08, entropy: +0.05, time: 3.0 }},
      { line: '4', color: 'var(--L4)', name: 'Line_SETTLE ì§ì ‘ì •ì°©', desc: 'íˆ¬ìâ†’ì²´ë¥˜â†’ì˜ì£¼ê¶Œ', delta: { energy: -0.15, entropy: -0.10, time: 2.0 }},
      { line: 'A', color: 'var(--LA)', name: 'Line_AIRPORT ì¶œì…êµ­', desc: 'ê³µí•­ ê²½ìœ ', delta: { energy: -0.02, entropy: +0.02, time: 0.7 }},
      { line: 'ê²½ì˜', color: 'var(--LK)', name: 'Line_CENTRAL ê²½ì˜ì¤‘ì•™', desc: 'ìš©ì‚°/ì²­ëŸ‰ë¦¬ ë°©ë©´', delta: { energy: -0.05, entropy: +0.08, time: 2.0 }}
    ]
  },
  ddp: {
    type: 'EVENT',
    label: 'ë™ëŒ€ë¬¸ì—­ì‚¬ë¬¸í™”ê³µì› (í˜„ì¬)',
    energy: 0.72, entropy: 0.38, risk: 0.24, time_cost: 0,
    options: [
      { line: '2', color: 'var(--L2)', name: 'Line_EDUCATION ìœ ì§€', desc: 'ì™•ì‹­ë¦¬â†’ì„±ìˆ˜â†’ê±´ëŒ€ ë°©ë©´', delta: { energy: -0.05, entropy: +0.03, time: 3.0 }},
      { line: '4', color: 'var(--L4)', name: 'Line_SETTLE í™˜ìŠ¹', desc: 'ì¶©ë¬´ë¡œâ†’ì„œìš¸ì—­ ë°©ë©´', delta: { energy: -0.08, entropy: +0.05, time: 2.0 }},
      { line: '5', color: 'var(--L5)', name: 'Line_EXPERT í™˜ìŠ¹', desc: 'ê´‘í™”ë¬¸â†’ì—¬ì˜ë„ ë°©ë©´', delta: { energy: -0.10, entropy: +0.08, time: 4.0 }}
    ]
  },
  gangnam: {
    type: 'DECISION',
    label: 'ê°•ë‚¨ì—­',
    energy: 0.68, entropy: 0.42, risk: 0.28, time_cost: 3.5,
    options: [
      { line: '2', color: 'var(--L2)', name: 'Line_EDUCATION ìœ ì§€', desc: 'êµìœ¡ ìˆœí™˜ ê³„ì†', delta: { energy: -0.08, entropy: +0.05, time: 6.0 }},
      { line: 'ì‹ ', color: 'var(--LS)', name: 'Line_STARTUP í™˜ìŠ¹', desc: 'ìŠ¤íƒ€íŠ¸ì—…/íˆ¬ì ê²½ë¡œ', delta: { energy: -0.20, entropy: +0.15, time: 12.0 }}
    ]
  },
  gosok: {
    type: 'DECISION',
    label: 'ê³ ì†í„°ë¯¸ë„ì—­',
    energy: 0.65, entropy: 0.45, risk: 0.30, time_cost: 4.0,
    options: [
      { line: '3', color: 'var(--L3)', name: 'Line_EMPLOY ì·¨ì—…', desc: 'ì •ê·œì§ ì·¨ì—… ë£¨íŠ¸', delta: { energy: -0.05, entropy: -0.08, time: 6.0 }},
      { line: '7', color: 'var(--L7)', name: 'Line_TECH ê¸°ìˆ ì´ë¯¼', desc: 'IT/ì—”ì§€ë‹ˆì–´ ê²½ë¡œ', delta: { energy: -0.12, entropy: +0.10, time: 12.0 }},
      { line: '9', color: 'var(--L9)', name: 'Line_EXPRESS ê¸‰í–‰', desc: 'íˆ¬ìì´ë¯¼ ê¸‰í–‰', delta: { energy: -0.25, entropy: -0.15, time: 3.0 }}
    ]
  },
  gimpo: {
    type: 'ABORT',
    label: 'ê¹€í¬ê³µí•­ì—­',
    energy: 0, entropy: 1.0, risk: 1.0, time_cost: 0,
    penalty: { energy: -0.25, recovery_time: 6.0 },
    options: [
      { line: 'âœ•', color: 'var(--abort)', name: 'ABORT í•˜ì°¨(ê·€êµ­)', desc: 'âŒ ë¯¸ì…˜ ì¢…ë£Œ', delta: { energy: -1.0, entropy: +1.0, time: 0 }},
      { line: '9', color: 'var(--L9)', name: 'Line_EXPRESS ìœ ì§€', desc: 'ê°•ë‚¨ ë°©ë©´ ì§„í–‰', delta: { energy: -0.03, entropy: +0.02, time: 1.0 }},
      { line: 'A', color: 'var(--LA)', name: 'Line_AIRPORT', desc: 'ì¸ì²œê³µí•­ ë°©ë©´', delta: { energy: -0.02, entropy: +0.01, time: 0.3 }}
    ]
  },
  wangsimni: {
    type: 'DECISION',
    label: 'ì™•ì‹­ë¦¬ì—­',
    energy: 0.70, entropy: 0.40, risk: 0.26, time_cost: 2.5,
    options: [
      { line: '2', color: 'var(--L2)', name: 'Line_EDUCATION', desc: 'ìˆœí™˜ì„  ìœ ì§€', delta: { energy: -0.04, entropy: +0.03, time: 2.0 }},
      { line: '5', color: 'var(--L5)', name: 'Line_EXPERT', desc: 'ê´‘í™”ë¬¸/ì—¬ì˜ë„', delta: { energy: -0.08, entropy: +0.06, time: 3.0 }},
      { line: 'ê²½ì˜', color: 'var(--LK)', name: 'Line_CENTRAL', desc: 'ìš©ì‚°/ë¬¸ì‚° ë°©ë©´', delta: { energy: -0.10, entropy: +0.08, time: 4.0 }},
      { line: 'ë¶„ë‹¹', color: 'var(--LB)', name: 'Line_SUBURB', desc: 'ê°•ë‚¨/ìˆ˜ì› ë°©ë©´', delta: { energy: -0.12, entropy: +0.10, time: 5.0 }}
    ]
  },
  hongdae: {
    type: 'DECISION',
    label: 'í™ëŒ€ì…êµ¬ì—­',
    energy: 0.73, entropy: 0.35, risk: 0.22, time_cost: 1.5,
    options: [
      { line: '2', color: 'var(--L2)', name: 'Line_EDUCATION', desc: 'ì‹ ì´Œ/ì‹œì²­ ë°©ë©´', delta: { energy: -0.03, entropy: +0.02, time: 1.0 }},
      { line: 'A', color: 'var(--LA)', name: 'Line_AIRPORT', desc: 'ê¹€í¬/ì¸ì²œê³µí•­', delta: { energy: -0.05, entropy: +0.03, time: 0.7 }},
      { line: 'ê²½ì˜', color: 'var(--LK)', name: 'Line_CENTRAL', desc: 'íŒŒì£¼/ë¬¸ì‚° ë°©ë©´', delta: { energy: -0.08, entropy: +0.06, time: 3.0 }}
    ]
  },
  incheon: {
    type: 'EVENT',
    label: 'ì¸ì²œê³µí•­ì—­',
    energy: 1.0, entropy: 0.10, risk: 0.05, time_cost: 0,
    options: [
      { line: 'A', color: 'var(--LA)', name: 'Line_AIRPORT ì§í†µ', desc: 'ì„œìš¸ì—­ ì§í–‰', delta: { energy: -0.05, entropy: +0.02, time: 0.7 }},
      { line: 'A', color: 'var(--LA)', name: 'Line_AIRPORT ì¼ë°˜', desc: 'ê¹€í¬ê³µí•­ ê²½ìœ ', delta: { energy: -0.03, entropy: +0.03, time: 1.0 }}
    ]
  }
};

// ê¸°ë³¸ ë…¸ë“œ ì¶”ê°€
['city','euljiro3','sindorim','hapjeong','dangsan','seongsu','konkuk','jamsil','sports','seolleung',
'gyodae','sadang','jongno3','gongdeok','yeouido','nowon','suseo','gasan'].forEach(id => {
  if (!nodes[id]) {
    nodes[id] = {
      type: 'EVENT',
      label: id,
      energy: 0.70, entropy: 0.35, risk: 0.25, time_cost: 1.5,
      options: [{ line: 'â†’', color: '#555', name: 'ê³„ì† ì§„í–‰', desc: 'í˜„ì¬ ê²½ë¡œ ìœ ì§€', delta: { energy: -0.02, entropy: +0.01, time: 1.0 }}]
    };
  }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UI FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let currentEnergy = 0.72;
let currentEntropy = 0.38;
let currentRisk = 0.24;
let scale = 1;

function openNode(id) {
  const node = nodes[id];
  if (!node) return;
  
  document.getElementById('mTitle').textContent = node.label;
  document.getElementById('mType').textContent = node.type;
  document.getElementById('mEnergy').textContent = node.energy.toFixed(2);
  document.getElementById('mEntropy').textContent = node.entropy.toFixed(2);
  document.getElementById('mRisk').textContent = node.risk.toFixed(2);
  document.getElementById('mTime').textContent = node.time_cost.toFixed(1);
  
  document.getElementById('mList').innerHTML = node.options.map(o => `
    <div class="branch-item" onclick="selectBranch('${o.line}', '${node.label}', ${JSON.stringify(o.delta).replace(/"/g, '&quot;')})">
      <div class="branch-badge" style="background:${o.color}">${o.line}</div>
      <div class="branch-info">
        <div class="branch-name">${o.name}</div>
        <div class="branch-desc">${o.desc}</div>
      </div>
      <div class="branch-delta">
        <div class="branch-delta-row">
          <span class="delta-label">Î”E</span>
          <span class="delta-value ${o.delta.energy >= 0 ? 'delta-positive' : 'delta-negative'}">${o.delta.energy >= 0 ? '+' : ''}${o.delta.energy.toFixed(2)}</span>
        </div>
        <div class="branch-delta-row">
          <span class="delta-label">Î”S</span>
          <span class="delta-value ${o.delta.entropy <= 0 ? 'delta-positive' : 'delta-negative'}">${o.delta.entropy >= 0 ? '+' : ''}${o.delta.entropy.toFixed(2)}</span>
        </div>
        <div class="branch-delta-row">
          <span class="delta-label">Î”t</span>
          <span class="delta-value">${o.delta.time}mo</span>
        </div>
      </div>
    </div>
  `).join('');
  
  document.getElementById('modal').classList.add('on');
}

function selectBranch(line, station, delta) {
  if (line === 'âœ•') {
    if (confirm('âš ï¸ ABORT í™•ì¸\n\nì •ë§ í•˜ì°¨(ê·€êµ­)í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ê²°ì •ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
      document.getElementById('abortOverlay').classList.add('on');
      // ë…¸ì„  íšŒìƒ‰í™”
      document.querySelectorAll('.line').forEach(l => l.style.stroke = '#ccc');
    }
  } else {
    // ë¬¼ë¦¬ ê³„ì‚° ì ìš©
    currentEnergy = PhysicsKernel.updateEnergy(currentEnergy, Math.abs(delta.energy));
    currentEntropy = PhysicsKernel.updateEntropy(currentEntropy, 0.1, Math.abs(delta.entropy) * 10);
    currentRisk = PhysicsKernel.calcRisk([currentRisk, Math.abs(delta.entropy) * 0.5]);
    
    // UI ì—…ë°ì´íŠ¸
    document.getElementById('energyValue').textContent = currentEnergy.toFixed(2);
    document.getElementById('entropyValue').textContent = currentEntropy.toFixed(2);
    document.getElementById('riskValue').textContent = currentRisk.toFixed(2);
    document.getElementById('pnrDays').textContent = PhysicsKernel.calcPNR(currentEnergy, currentEntropy, currentRisk);
    
    alert(`${line} ì„ íƒë¨ (${station})\n\nÎ”Energy: ${delta.energy}\nÎ”Entropy: ${delta.entropy}\nTime: ${delta.time}ê°œì›”`);
  }
  closeModal();
}

function closeModal() {
  document.getElementById('modal').classList.remove('on');
}

function goBack() { history.back(); }
function goMain() { location.href = 'main.html'; }

function zoom(f) {
  scale *= f;
  scale = Math.max(0.4, Math.min(2.5, scale));
  document.getElementById('metroInner').style.transform = `scale(${scale})`;
  document.getElementById('metroInner').style.transformOrigin = 'top left';
}

function resetZoom() {
  scale = 1;
  document.getElementById('metroInner').style.transform = 'scale(1)';
}

// ë“œë˜ê·¸ ìŠ¤í¬ë¡¤
const wrap = document.getElementById('metroWrap');
let isDragging = false, startX, startY, scrollLeft, scrollTop;

wrap.addEventListener('mousedown', e => {
  if (e.target.closest('.station, .transfer')) return;
  isDragging = true;
  startX = e.pageX - wrap.offsetLeft;
  startY = e.pageY - wrap.offsetTop;
  scrollLeft = wrap.scrollLeft;
  scrollTop = wrap.scrollTop;
  wrap.style.cursor = 'grabbing';
});

wrap.addEventListener('mouseleave', () => { isDragging = false; wrap.style.cursor = 'grab'; });
wrap.addEventListener('mouseup', () => { isDragging = false; wrap.style.cursor = 'grab'; });
wrap.addEventListener('mousemove', e => {
  if (!isDragging) return;
  e.preventDefault();
  wrap.scrollLeft = scrollLeft - (e.pageX - wrap.offsetLeft - startX);
  wrap.scrollTop = scrollTop - (e.pageY - wrap.offsetTop - startY);
});

wrap.style.cursor = 'grab';
document.getElementById('modal').onclick = e => { if (e.target.id === 'modal') closeModal(); };
</script>
</body>
</html>
