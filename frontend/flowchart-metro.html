<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=1920, height=1080, initial-scale=1.0">
  <title>AUTUS â€” Flowchart Metro (ëŒ€ì²´ ë…¸ì„ )</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --bg-dark: #0a0a0a;
      --bg-panel: #1a1a1a;
      --bg-card: #252525;
      --border: #3a3a3a;
      --text-primary: #ffffff;
      --text-secondary: #888888;
      --text-dim: #666666;
      
      /* Line Colors */
      --line-main: #3e8ae1;
      --line-exit: #888888;
      --line-research: #ff8c00;
      --line-edit: #9c27b0;
      
      /* Station Colors */
      --station-origin: #32cd32;
      --station-decision: #3e8ae1;
      --station-exit: #888888;
      --station-destination: #ffd700;
    }
    
    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: var(--bg-dark);
      color: var(--text-primary);
      font-family: -apple-system, 'SF Pro Display', sans-serif;
    }
    
    .app {
      width: 100%;
      height: 100%;
      display: flex;
    }
    
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SIDEBAR
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .sidebar {
      width: 320px;
      background: var(--bg-panel);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid var(--border);
    }
    
    .sidebar-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    
    .sidebar-subtitle {
      font-size: 12px;
      color: var(--text-secondary);
    }
    
    .legend {
      padding: 20px;
      border-bottom: 1px solid var(--border);
    }
    
    .legend-title {
      font-size: 12px;
      color: var(--text-dim);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 8px 0;
    }
    
    .legend-line {
      width: 40px;
      height: 4px;
      border-radius: 2px;
    }
    
    .legend-line.solid { background: var(--line-main); }
    .legend-line.dashed { 
      background: repeating-linear-gradient(90deg, var(--line-research), var(--line-research) 6px, transparent 6px, transparent 12px);
    }
    .legend-line.exit { background: var(--line-exit); }
    
    .legend-label {
      font-size: 13px;
      color: var(--text-secondary);
    }
    
    .legend-station {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: 700;
    }
    
    /* Station Info Panel */
    .station-info {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }
    
    .info-card {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 12px;
    }
    
    .info-card-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }
    
    .info-card-icon {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: 700;
    }
    
    .info-card-title {
      font-size: 16px;
      font-weight: 600;
    }
    
    .info-card-type {
      font-size: 11px;
      color: var(--text-dim);
      text-transform: uppercase;
    }
    
    .info-card-desc {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.5;
    }
    
    .physics-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      margin-top: 12px;
    }
    
    .physics-item {
      background: var(--bg-dark);
      padding: 8px 12px;
      border-radius: 6px;
      text-align: center;
    }
    
    .physics-label {
      font-size: 10px;
      color: var(--text-dim);
      text-transform: uppercase;
    }
    
    .physics-value {
      font-size: 16px;
      font-weight: 600;
      margin-top: 2px;
    }
    
    .physics-value.positive { color: #32cd32; }
    .physics-value.negative { color: #e82127; }
    
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAP AREA
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .map-area {
      flex: 1;
      position: relative;
      overflow: hidden;
    }
    
    .map-svg {
      width: 100%;
      height: 100%;
    }
    
    /* Lines */
    .line-path {
      fill: none;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    
    .line-path.solid {
      stroke-width: 8;
    }
    
    .line-path.dashed {
      stroke-width: 5;
      stroke-dasharray: 12 8;
      opacity: 0.8;
    }
    
    .line-path.exit {
      stroke-width: 6;
      opacity: 0.6;
    }
    
    .line-path.loop {
      animation: loopPulse 2s ease-in-out infinite;
    }
    
    @keyframes loopPulse {
      0%, 100% { opacity: 0.6; stroke-width: 5; }
      50% { opacity: 1; stroke-width: 7; }
    }
    
    /* Arrow markers */
    .arrow-marker {
      fill: var(--line-research);
    }
    
    /* Stations */
    .station {
      cursor: pointer;
      transition: transform 0.2s;
    }
    
    .station:hover {
      transform: scale(1.15);
    }
    
    .station-circle {
      stroke: white;
      stroke-width: 3;
    }
    
    .station-circle.origin { fill: var(--station-origin); }
    .station-circle.decision { fill: var(--station-decision); }
    .station-circle.exit { fill: var(--station-exit); }
    .station-circle.destination { fill: var(--station-destination); }
    .station-circle.progress { fill: var(--bg-panel); stroke: var(--line-main); stroke-width: 4; }
    .station-circle.research { fill: var(--bg-panel); stroke: var(--line-research); stroke-width: 4; }
    
    .station-diamond {
      fill: var(--station-decision);
      stroke: white;
      stroke-width: 3;
    }
    
    .station-label {
      font-size: 12px;
      font-weight: 600;
      fill: white;
      text-anchor: middle;
      pointer-events: none;
    }
    
    .station-name {
      font-size: 13px;
      fill: var(--text-primary);
      font-weight: 500;
    }
    
    .station-desc {
      font-size: 11px;
      fill: var(--text-secondary);
    }
    
    /* Condition Labels */
    .condition-label {
      font-size: 11px;
      fill: white;
      font-weight: 600;
    }
    
    .condition-bg {
      rx: 4;
      ry: 4;
    }
    
    /* Loop indicator */
    .loop-arrow {
      fill: none;
      stroke: var(--line-research);
      stroke-width: 3;
      stroke-linecap: round;
      marker-end: url(#arrowhead);
    }
    
    /* Current position */
    .current-marker {
      animation: currentPulse 2s ease-in-out infinite;
    }
    
    @keyframes currentPulse {
      0%, 100% { r: 8; opacity: 1; }
      50% { r: 12; opacity: 0.6; }
    }
    
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CONTROLS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .controls {
      position: absolute;
      top: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .control-btn {
      width: 44px;
      height: 44px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    
    .control-btn:hover {
      background: var(--line-main);
    }
    
    /* Physics Panel */
    .physics-panel {
      position: absolute;
      bottom: 20px;
      left: 340px;
      right: 20px;
      background: var(--bg-panel);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px 24px;
      display: flex;
      justify-content: space-around;
      align-items: center;
    }
    
    .physics-stat {
      text-align: center;
    }
    
    .physics-stat-value {
      font-size: 32px;
      font-weight: 300;
    }
    
    .physics-stat-label {
      font-size: 11px;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .physics-stat-bar {
      width: 80px;
      height: 6px;
      background: var(--bg-card);
      border-radius: 3px;
      margin-top: 8px;
      overflow: hidden;
    }
    
    .physics-stat-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.5s;
    }
    
    .physics-stat-fill.energy { background: linear-gradient(90deg, #e82127, #32cd32); }
    .physics-stat-fill.risk { background: linear-gradient(90deg, #32cd32, #e82127); }
    .physics-stat-fill.success { background: var(--line-main); }
  </style>
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-title">AUTUS Flowchart Metro</div>
        <div class="sidebar-subtitle">ëŒ€ì²´ ë…¸ì„  = ì¡°ê±´ë¶€ ë¶„ê¸°</div>
      </div>
      
      <div class="legend">
        <div class="legend-title">ë…¸ì„  ë²”ë¡€</div>
        <div class="legend-item">
          <div class="legend-line solid"></div>
          <span class="legend-label">ì •ìƒ ë…¸ì„  (Main Line)</span>
        </div>
        <div class="legend-item">
          <div class="legend-line dashed"></div>
          <span class="legend-label">ëŒ€ì²´ ë…¸ì„  (Alternate)</span>
        </div>
        <div class="legend-item">
          <div class="legend-line exit"></div>
          <span class="legend-label">ì‹¤íŒ¨ ë…¸ì„  (Exit)</span>
        </div>
        
        <div class="legend-title" style="margin-top: 16px;">ì—­ ë²”ë¡€</div>
        <div class="legend-item">
          <div class="legend-station" style="background: var(--station-origin);">S</div>
          <span class="legend-label">ì‹œì‘ (Origin)</span>
        </div>
        <div class="legend-item">
          <div class="legend-station" style="background: var(--station-decision);">â¦¿</div>
          <span class="legend-label">íŒë‹¨ (Decision/í™˜ìŠ¹)</span>
        </div>
        <div class="legend-item">
          <div class="legend-station" style="background: var(--station-destination);">â˜…</div>
          <span class="legend-label">ëª©ì ì§€ (Destination)</span>
        </div>
        <div class="legend-item">
          <div class="legend-station" style="background: var(--station-exit);">âŠ˜</div>
          <span class="legend-label">í•˜ì°¨ (Exit)</span>
        </div>
      </div>
      
      <div class="station-info" id="stationInfo">
        <div class="info-card">
          <div class="info-card-header">
            <div class="info-card-icon" style="background: var(--line-research);">?</div>
            <div>
              <div class="info-card-title">ì—­ì„ ì„ íƒí•˜ì„¸ìš”</div>
              <div class="info-card-type">Click a station</div>
            </div>
          </div>
          <div class="info-card-desc">
            ë…¸ì„ ë„ì˜ ì—­ì„ í´ë¦­í•˜ë©´ ìƒì„¸ ì •ë³´ì™€ ë¬¼ë¦¬ ìˆ˜ì¹˜ê°€ í‘œì‹œë©ë‹ˆë‹¤.
          </div>
        </div>
        
        <div class="info-card">
          <div class="info-card-header">
            <div class="info-card-icon" style="background: var(--line-research);">ğŸ’¡</div>
            <div>
              <div class="info-card-title">ëŒ€ì²´ ë…¸ì„  ê·œì¹™</div>
              <div class="info-card-type">Alternate Line Rules</div>
            </div>
          </div>
          <div class="info-card-desc">
            <strong>í™œì„±í™” ì¡°ê±´:</strong><br>
            â€¢ Confidence &lt; 60%<br>
            â€¢ Info &lt; 50%<br>
            â€¢ Risk &gt; 70%
          </div>
          <div class="physics-grid">
            <div class="physics-item">
              <div class="physics-label">Time</div>
              <div class="physics-value negative">â†‘</div>
            </div>
            <div class="physics-item">
              <div class="physics-label">Energy</div>
              <div class="physics-value negative">â†“</div>
            </div>
            <div class="physics-item">
              <div class="physics-label">Friction</div>
              <div class="physics-value negative">â†‘</div>
            </div>
            <div class="physics-item">
              <div class="physics-label">Success</div>
              <div class="physics-value positive">â†‘</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Map Area -->
    <div class="map-area">
      <svg class="map-svg" viewBox="0 0 800 800">
        <defs>
          <!-- Arrow marker -->
          <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="var(--line-research)" />
          </marker>
          <marker id="arrowhead-edit" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="var(--line-edit)" />
          </marker>
        </defs>
        
        <!-- Main Line -->
        <path class="line-path solid" stroke="var(--line-main)"
              d="M400,100 L400,200 L400,320 L400,450 L400,550 L400,700" />
        
        <!-- Exit Line (Aì•ˆ: ì‹¤íŒ¨ ë…¸ì„ ) -->
        <path class="line-path exit" stroke="var(--line-exit)"
              d="M400,320 Q300,370 200,420" />
        
        <!-- Research Loop (Bì•ˆ: ëŒ€ì²´ ë…¸ì„ ) -->
        <path class="line-path dashed loop" stroke="var(--line-research)"
              d="M400,320 Q500,370 600,420" />
        <path class="line-path dashed loop" stroke="var(--line-research)"
              d="M600,420 Q650,350 600,280 Q550,250 500,280 Q450,310 400,320"
              marker-end="url(#arrowhead)" />
        
        <!-- Edit Loop -->
        <path class="line-path dashed" stroke="var(--line-edit)"
              d="M400,550 Q325,585 250,620" />
        <path class="line-path dashed" stroke="var(--line-edit)"
              d="M250,620 Q200,580 200,540 Q200,500 250,500 Q300,500 350,530 Q380,545 400,550"
              marker-end="url(#arrowhead-edit)" />
        
        <!-- Condition Labels -->
        <g transform="translate(300, 350)">
          <rect class="condition-bg" x="-25" y="-10" width="50" height="20" fill="var(--line-exit)" />
          <text class="condition-label" x="0" y="4" text-anchor="middle">ì•„ë‹ˆì˜¤</text>
        </g>
        
        <g transform="translate(500, 350)">
          <rect class="condition-bg" x="-35" y="-10" width="70" height="20" fill="var(--line-research)" />
          <text class="condition-label" x="0" y="4" text-anchor="middle">ì •ë³´ ë¶€ì¡±</text>
        </g>
        
        <g transform="translate(400, 385)">
          <rect class="condition-bg" x="-15" y="-10" width="30" height="20" fill="var(--line-main)" />
          <text class="condition-label" x="0" y="4" text-anchor="middle">ì˜ˆ</text>
        </g>
        
        <g transform="translate(325, 570)">
          <rect class="condition-bg" x="-35" y="-10" width="70" height="20" fill="var(--line-edit)" />
          <text class="condition-label" x="0" y="4" text-anchor="middle">ìˆ˜ì • í•„ìš”</text>
        </g>
        
        <g transform="translate(400, 620)">
          <rect class="condition-bg" x="-20" y="-10" width="40" height="20" fill="var(--line-main)" />
          <text class="condition-label" x="0" y="4" text-anchor="middle">ìŠ¹ì¸</text>
        </g>
        
        <!-- Stations -->
        <!-- Origin -->
        <g class="station" onclick="selectStation('S_ORIGIN')" transform="translate(400, 100)">
          <circle class="station-circle origin" r="18" />
          <text class="station-label" y="5">S</text>
          <text class="station-name" x="30" y="5">Origin</text>
          <text class="station-desc" x="30" y="20">í”„ë¡œì íŠ¸ ì œì•ˆ</text>
        </g>
        
        <!-- Progress -->
        <g class="station" onclick="selectStation('S_PROGRESS')" transform="translate(400, 200)">
          <circle class="station-circle progress" r="14" />
          <text class="station-name" x="25" y="5">Progress</text>
          <text class="station-desc" x="25" y="20">ì•„ì´ë””ì–´ í† ë¡ </text>
        </g>
        
        <!-- Decision (í™˜ìŠ¹ì—­) -->
        <g class="station" onclick="selectStation('S_DECISION')" transform="translate(400, 320)">
          <rect class="station-diamond" x="-18" y="-18" width="36" height="36" rx="4" 
                transform="rotate(45)" />
          <text class="station-label" y="5">â¦¿</text>
          <text class="station-name" x="35" y="0">Decision</text>
          <text class="station-desc" x="35" y="15">íŒë‹¨ (í™˜ìŠ¹ì—­)</text>
        </g>
        
        <!-- Drop (Exit) -->
        <g class="station" onclick="selectStation('S_DROP')" transform="translate(200, 420)">
          <circle class="station-circle exit" r="16" />
          <text class="station-label" y="5">âŠ˜</text>
          <text class="station-name" x="-60" y="5" text-anchor="end">Drop</text>
          <text class="station-desc" x="-60" y="20" text-anchor="end">ì•„ì´ë””ì–´ ì·¨ì†Œ</text>
        </g>
        
        <!-- Research -->
        <g class="station" onclick="selectStation('S_RESEARCH')" transform="translate(600, 420)">
          <circle class="station-circle research" r="14" />
          <text class="station-name" x="25" y="5">Research</text>
          <text class="station-desc" x="25" y="20">ì¶”ê°€ ì¡°ì‚¬</text>
        </g>
        
        <!-- Draft -->
        <g class="station" onclick="selectStation('S_DRAFT')" transform="translate(400, 450)">
          <circle class="station-circle progress" r="14" />
          <text class="station-name" x="25" y="5">Draft</text>
          <text class="station-desc" x="25" y="20">ì œì•ˆì„œ ì‘ì„±</text>
        </g>
        
        <!-- Review (í™˜ìŠ¹ì—­) -->
        <g class="station" onclick="selectStation('S_REVIEW')" transform="translate(400, 550)">
          <rect class="station-diamond" x="-16" y="-16" width="32" height="32" rx="4"
                transform="rotate(45)" />
          <text class="station-label" y="5">â¦¿</text>
          <text class="station-name" x="30" y="0">Review</text>
          <text class="station-desc" x="30" y="15">ê²€í† </text>
        </g>
        
        <!-- Edit -->
        <g class="station" onclick="selectStation('S_EDIT')" transform="translate(250, 620)">
          <circle class="station-circle" r="12" style="fill: var(--bg-panel); stroke: var(--line-edit); stroke-width: 4;" />
          <text class="station-name" x="-25" y="5" text-anchor="end">Edit</text>
          <text class="station-desc" x="-25" y="20" text-anchor="end">ìˆ˜ì •</text>
        </g>
        
        <!-- Final Approval (Destination) -->
        <g class="station" onclick="selectStation('S_APPROVAL')" transform="translate(400, 700)">
          <circle class="station-circle destination" r="20" />
          <text class="station-label" y="6">â˜…</text>
          <text class="station-name" x="35" y="5">Final Approval</text>
          <text class="station-desc" x="35" y="20">ìµœì¢… ìŠ¹ì¸</text>
        </g>
        
        <!-- Current Position Marker -->
        <circle class="current-marker" id="currentMarker" cx="400" cy="200" r="8" fill="#00ff00" opacity="0.8" />
      </svg>
      
      <!-- Controls -->
      <div class="controls">
        <button class="control-btn" onclick="resetView()" title="Reset">ğŸ”„</button>
        <button class="control-btn" onclick="toggleSimulation()" title="Simulate">â–¶ï¸</button>
        <button class="control-btn" onclick="showAlternate()" title="Show Alternate">ğŸ”€</button>
      </div>
      
      <!-- Physics Panel -->
      <div class="physics-panel">
        <div class="physics-stat">
          <div class="physics-stat-value" id="stat-time">0d</div>
          <div class="physics-stat-label">Time Spent</div>
        </div>
        <div class="physics-stat">
          <div class="physics-stat-value" id="stat-energy">100%</div>
          <div class="physics-stat-label">Energy</div>
          <div class="physics-stat-bar">
            <div class="physics-stat-fill energy" id="bar-energy" style="width: 100%"></div>
          </div>
        </div>
        <div class="physics-stat">
          <div class="physics-stat-value" id="stat-risk">0%</div>
          <div class="physics-stat-label">Risk</div>
          <div class="physics-stat-bar">
            <div class="physics-stat-fill risk" id="bar-risk" style="width: 0%"></div>
          </div>
        </div>
        <div class="physics-stat">
          <div class="physics-stat-value" id="stat-success">50%</div>
          <div class="physics-stat-label">Success Prob</div>
          <div class="physics-stat-bar">
            <div class="physics-stat-fill success" id="bar-success" style="width: 50%"></div>
          </div>
        </div>
        <div class="physics-stat">
          <div class="physics-stat-value" id="stat-path">Main</div>
          <div class="physics-stat-label">Current Path</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Station data
    const stations = {
      S_ORIGIN: { name: 'Origin', type: 'origin', desc: 'íŒ€ êµ¬ì„±ì›ì´ í”„ë¡œì íŠ¸ ì œì•ˆ', x: 400, y: 100 },
      S_PROGRESS: { name: 'Progress', type: 'progress', desc: 'íŒ€ íšŒì˜ì—ì„œ ì•„ì´ë””ì–´ í† ë¡ ', x: 400, y: 200 },
      S_DECISION: { name: 'Decision', type: 'decision', desc: 'ì°¸ê°€ìê°€ ì¢‹ì€ ì•„ì´ë””ì–´ì¸ì§€ ê²°ì • (í™˜ìŠ¹ì—­)', x: 400, y: 320 },
      S_DROP: { name: 'Drop', type: 'exit', desc: 'íŒ€ì—ì„œ ì•„ì´ë””ì–´ ì·¨ì†Œ (ì‹¤íŒ¨ ë…¸ì„ )', x: 200, y: 420 },
      S_RESEARCH: { name: 'Research', type: 'research', desc: 'íŒ€ êµ¬ì„±ì›ì´ ë” ë§ì€ ì¡°ì‚¬ ìˆ˜í–‰ (ëŒ€ì²´ ë…¸ì„ )', x: 600, y: 420 },
      S_DRAFT: { name: 'Draft', type: 'progress', desc: 'ì œì•ˆì„œ ì‘ì„±', x: 400, y: 450 },
      S_REVIEW: { name: 'Review', type: 'decision', desc: 'ê²€í†  (í™˜ìŠ¹ì—­)', x: 400, y: 550 },
      S_EDIT: { name: 'Edit', type: 'progress', desc: 'ìˆ˜ì • (ëŒ€ì²´ ë…¸ì„ )', x: 250, y: 620 },
      S_APPROVAL: { name: 'Final Approval', type: 'destination', desc: 'ìµœì¢… ìŠ¹ì¸', x: 400, y: 700 }
    };
    
    // Physics state
    let physics = {
      time: 0,
      energy: 100,
      risk: 0,
      success: 50
    };
    
    // Edge physics
    const edgePhysics = {
      'S_ORIGIN->S_PROGRESS': { dt: 1, dE: -2, dR: 0, dS: 0 },
      'S_PROGRESS->S_DECISION': { dt: 2, dE: -5, dR: 1, dS: 5 },
      'S_DECISION->S_DROP': { dt: 1, dE: -10, dR: 30, dS: -50 },
      'S_DECISION->S_RESEARCH': { dt: 5, dE: -15, dR: -10, dS: 20 },
      'S_RESEARCH->S_DECISION': { dt: 2, dE: -5, dR: -5, dS: 15 },
      'S_DECISION->S_DRAFT': { dt: 1, dE: -2, dR: 0, dS: 5 },
      'S_DRAFT->S_REVIEW': { dt: 3, dE: -8, dR: 2, dS: 5 },
      'S_REVIEW->S_EDIT': { dt: 2, dE: -5, dR: 1, dS: 5 },
      'S_EDIT->S_REVIEW': { dt: 1, dE: -3, dR: -2, dS: 10 },
      'S_REVIEW->S_APPROVAL': { dt: 1, dE: 10, dR: -10, dS: 10 }
    };
    
    let currentStation = 'S_PROGRESS';
    let simulationRunning = false;
    
    function selectStation(id) {
      const station = stations[id];
      if (!station) return;
      
      // Update current marker
      const marker = document.getElementById('currentMarker');
      marker.setAttribute('cx', station.x);
      marker.setAttribute('cy', station.y);
      
      // Calculate physics change
      const edgeKey = `${currentStation}->${id}`;
      const edgePhy = edgePhysics[edgeKey];
      
      if (edgePhy) {
        physics.time += edgePhy.dt;
        physics.energy = Math.max(0, Math.min(100, physics.energy + edgePhy.dE));
        physics.risk = Math.max(0, Math.min(100, physics.risk + edgePhy.dR));
        physics.success = Math.max(0, Math.min(100, physics.success + edgePhy.dS));
      }
      
      currentStation = id;
      updatePhysicsUI();
      updateStationInfo(station, id);
    }
    
    function updatePhysicsUI() {
      document.getElementById('stat-time').textContent = physics.time + 'd';
      document.getElementById('stat-energy').textContent = Math.round(physics.energy) + '%';
      document.getElementById('stat-risk').textContent = Math.round(physics.risk) + '%';
      document.getElementById('stat-success').textContent = Math.round(physics.success) + '%';
      
      document.getElementById('bar-energy').style.width = physics.energy + '%';
      document.getElementById('bar-risk').style.width = physics.risk + '%';
      document.getElementById('bar-success').style.width = physics.success + '%';
      
      // Determine path type
      const pathType = currentStation === 'S_RESEARCH' || currentStation === 'S_EDIT' ? 'Alternate' :
                       currentStation === 'S_DROP' ? 'Exit' : 'Main';
      document.getElementById('stat-path').textContent = pathType;
    }
    
    function updateStationInfo(station, id) {
      const typeColors = {
        origin: 'var(--station-origin)',
        progress: 'var(--line-main)',
        decision: 'var(--station-decision)',
        exit: 'var(--station-exit)',
        research: 'var(--line-research)',
        destination: 'var(--station-destination)'
      };
      
      const typeLabels = {
        origin: 'START',
        progress: 'PROGRESS',
        decision: 'DECISION (í™˜ìŠ¹)',
        exit: 'EXIT (í•˜ì°¨)',
        research: 'ALTERNATE (ëŒ€ì²´)',
        destination: 'DESTINATION'
      };
      
      const infoHtml = `
        <div class="info-card">
          <div class="info-card-header">
            <div class="info-card-icon" style="background: ${typeColors[station.type]};">${station.type === 'decision' ? 'â¦¿' : station.type === 'exit' ? 'âŠ˜' : station.type === 'destination' ? 'â˜…' : 'â—'}</div>
            <div>
              <div class="info-card-title">${station.name}</div>
              <div class="info-card-type">${typeLabels[station.type]}</div>
            </div>
          </div>
          <div class="info-card-desc">${station.desc}</div>
          <div class="physics-grid">
            <div class="physics-item">
              <div class="physics-label">Position</div>
              <div class="physics-value">${id}</div>
            </div>
            <div class="physics-item">
              <div class="physics-label">Type</div>
              <div class="physics-value">${station.type}</div>
            </div>
          </div>
        </div>
      `;
      
      document.getElementById('stationInfo').innerHTML = infoHtml;
    }
    
    function resetView() {
      physics = { time: 0, energy: 100, risk: 0, success: 50 };
      currentStation = 'S_PROGRESS';
      selectStation('S_ORIGIN');
    }
    
    function toggleSimulation() {
      simulationRunning = !simulationRunning;
      if (simulationRunning) {
        runSimulation();
      }
    }
    
    function runSimulation() {
      if (!simulationRunning) return;
      
      const paths = {
        'S_ORIGIN': 'S_PROGRESS',
        'S_PROGRESS': 'S_DECISION',
        'S_DECISION': Math.random() > 0.6 ? 'S_DRAFT' : (Math.random() > 0.5 ? 'S_RESEARCH' : 'S_DROP'),
        'S_RESEARCH': 'S_DECISION',
        'S_DRAFT': 'S_REVIEW',
        'S_REVIEW': Math.random() > 0.4 ? 'S_APPROVAL' : 'S_EDIT',
        'S_EDIT': 'S_REVIEW',
        'S_DROP': 'S_DROP',
        'S_APPROVAL': 'S_APPROVAL'
      };
      
      const next = paths[currentStation];
      if (next && next !== currentStation) {
        selectStation(next);
        setTimeout(runSimulation, 1500);
      } else {
        simulationRunning = false;
      }
    }
    
    function showAlternate() {
      // Highlight alternate lines
      document.querySelectorAll('.line-path.dashed').forEach(el => {
        el.style.strokeWidth = '10';
        el.style.opacity = '1';
        setTimeout(() => {
          el.style.strokeWidth = '';
          el.style.opacity = '';
        }, 2000);
      });
    }
    
    // Initialize
    selectStation('S_ORIGIN');
  </script>
</body>
</html>
