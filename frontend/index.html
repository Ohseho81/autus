<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>AUTUS</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #000; 
            color: #fff; 
            font-family: -apple-system, sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .status-line {
            font-size: 12px;
            letter-spacing: 0.3em;
            opacity: 0.5;
            margin-bottom: 8px;
        }
        .failure-line {
            font-size: 28px;
            font-weight: 200;
            letter-spacing: 0.05em;
            margin-bottom: 64px;
        }
        .failure-line.GREEN { color: #00ff88; }
        .failure-line.YELLOW { color: #ffaa00; }
        .failure-line.RED { color: #ff2244; animation: pulse 0.5s infinite; }
        @keyframes pulse { 50% { opacity: 0.5; } }
        
        .action-label {
            font-size: 10px;
            letter-spacing: 0.4em;
            opacity: 0.3;
            margin-bottom: 12px;
        }
        .action-text {
            font-size: 36px;
            font-weight: 300;
            letter-spacing: 0.1em;
            margin-bottom: 48px;
        }
        .action-text.YELLOW { color: #ffaa00; }
        .action-text.RED { color: #ff2244; }
        .action-text.GREEN { color: #00ff88; }
        
        button {
            background: transparent;
            border: 1px solid #ffaa00;
            color: #ffaa00;
            padding: 18px 64px;
            font-size: 14px;
            letter-spacing: 0.2em;
            cursor: pointer;
            transition: all 0.2s;
        }
        button:hover { background: #ffaa0022; }
        button.RED { border-color: #ff2244; color: #ff2244; }
        button.RED:hover { background: #ff224422; }
        button.hidden { display: none; }
    </style>
</head>
<body>
    <div class="status-line" id="status-line">SYSTEM STABLE</div>
    <div class="failure-line GREEN" id="failure-line">ALL CLEAR</div>
    
    <div class="action-label">ACTION REQUIRED</div>
    <div class="action-text GREEN" id="action-text">NONE</div>
    
    <button id="btn" class="hidden" onclick="exec()">EXECUTE</button>
    
    <script>
        async function get(){
            const r=await fetch('/autus/solar/status',{cache:'no-store'});
            return r.ok?await r.json():null;
        }
        async function exec(){
            await fetch('/execute',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'AUTO_STABILIZE',actor_id:'UI'})});
        }
        function render(s){
            if(!s||!s.output)return;
            const st=s.output.status;
            const fail=s.output.failure_in_ticks;
            const act=s.output.required_action;
            const bn=s.output.bottleneck;
            
            const sl=document.getElementById('status-line');
            const fl=document.getElementById('failure-line');
            const at=document.getElementById('action-text');
            const btn=document.getElementById('btn');
            
            if(st==='GREEN'){
                sl.textContent='SYSTEM STABLE';
                fl.textContent='ALL CLEAR';
                fl.className='failure-line GREEN';
                at.textContent='NONE';
                at.className='action-text GREEN';
                btn.className='hidden';
            }else if(st==='YELLOW'){
                sl.textContent='SYSTEM AT RISK';
                fl.textContent=fail?'FAILURE IN '+fail+' TICKS':'ATTENTION NEEDED';
                fl.className='failure-line YELLOW';
                at.textContent=act==='DECIDE'?'DECIDE NOW':act==='REMOVE'?'REDUCE LOAD':bn!=='NONE'?bn.replace('_',' '):'STABILIZE';
                at.className='action-text YELLOW';
                btn.className='';
            }else{
                sl.textContent='SYSTEM CRITICAL';
                fl.textContent=fail?'FAILURE IN '+fail+' TICKS':'IMMEDIATE ACTION';
                fl.className='failure-line RED';
                at.textContent=act==='DECIDE'?'DECIDE NOW':act==='REMOVE'?'REDUCE LOAD':'STABILIZE NOW';
                at.className='action-text RED';
                btn.className='RED';
            }
        }
        (async function(){while(1){try{render(await get())}catch(e){}await new Promise(r=>setTimeout(r,1000))}})();
    </script>
</body>
</html>
