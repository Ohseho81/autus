<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AUTUS â€” ì‹œì‘ ì„¤ì •</title>
    <link rel="stylesheet" href="css/common.css">
    <style>
        .signup-container {
            min-height: 100vh;
            display: flex;
            position: relative;
            z-index: 1;
        }

        .progress-panel {
            width: 320px;
            background: var(--bg-card);
            border-right: 1px solid var(--border);
            padding: 40px;
            display: flex;
            flex-direction: column;
        }

        @media (max-width: 900px) {
            .progress-panel { display: none; }
            .form-panel { padding: 24px !important; }
        }

        .progress-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 60px;
        }

        .progress-logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #000;
        }

        .progress-logo-text {
            font-size: 16px;
            font-weight: 600;
            letter-spacing: 2px;
        }

        .progress-steps {
            flex: 1;
        }

        .progress-step {
            display: flex;
            align-items: flex-start;
            gap: 16px;
            margin-bottom: 32px;
            opacity: 0.4;
            transition: all 0.3s;
        }

        .progress-step.active {
            opacity: 1;
        }

        .progress-step.completed {
            opacity: 0.7;
        }

        .step-indicator {
            width: 32px;
            height: 32px;
            border: 2px solid var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            flex-shrink: 0;
            transition: all 0.3s;
        }

        .progress-step.active .step-indicator {
            border-color: var(--neon-cyan);
            background: rgba(0, 240, 255, 0.1);
            color: var(--neon-cyan);
        }

        .progress-step.completed .step-indicator {
            border-color: var(--neon-green);
            background: var(--neon-green);
            color: #000;
        }

        .step-content h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .step-content p {
            font-size: 11px;
            color: var(--text-dim);
        }

        .progress-note {
            padding: 16px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            font-size: 11px;
            color: var(--text-dim);
            line-height: 1.6;
        }

        .form-panel {
            flex: 1;
            padding: 60px 80px;
            overflow-y: auto;
        }

        .form-section {
            display: none;
            max-width: 600px;
            animation: fadeIn 0.4s ease;
        }

        .form-section.active {
            display: block;
        }

        .form-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .form-subtitle {
            font-size: 14px;
            color: var(--text-dim);
            margin-bottom: 40px;
        }

        .role-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        @media (max-width: 600px) {
            .role-grid { grid-template-columns: 1fr; }
        }

        .role-card {
            padding: 24px;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .role-card:hover {
            border-color: var(--neon-cyan);
            transform: translateY(-4px);
        }

        .role-card.selected {
            border-color: var(--neon-green);
            background: rgba(0, 255, 136, 0.05);
        }

        .role-card-icon {
            font-size: 40px;
            margin-bottom: 12px;
        }

        .role-card-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .role-card-desc {
            font-size: 11px;
            color: var(--text-dim);
        }

        .affiliation-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-label {
            font-size: 12px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-field {
            padding: 16px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text);
            font-size: 15px;
            transition: all 0.3s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 240, 255, 0.1);
        }

        .input-field::placeholder {
            color: var(--text-muted);
        }

        .capacity-slider {
            padding: 20px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .slider-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--neon-cyan);
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--neon-cyan);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px var(--neon-cyan);
        }

        .pain-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .pain-option {
            padding: 20px 24px;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .pain-option:hover {
            border-color: var(--neon-purple);
        }

        .pain-option.selected {
            border-color: var(--neon-green);
            background: rgba(0, 255, 136, 0.05);
        }

        .pain-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            background: rgba(180, 74, 255, 0.2);
        }

        .pain-text h4 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .pain-text p {
            font-size: 12px;
            color: var(--text-dim);
        }

        .orbit-options {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .orbit-option {
            padding: 24px;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .orbit-option:hover {
            border-color: var(--neon-cyan);
        }

        .orbit-option.selected {
            border-color: var(--neon-green);
            background: rgba(0, 255, 136, 0.05);
        }

        .orbit-option.recommended::after {
            content: 'ì¶”ì²œ';
            position: absolute;
            top: -10px;
            right: 16px;
            padding: 4px 12px;
            background: var(--neon-orange);
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            color: #000;
        }

        .orbit-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 12px;
        }

        .orbit-visual {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .orbit-visual::before {
            content: '';
            position: absolute;
            border: 2px dashed var(--neon-cyan);
            border-radius: 50%;
        }

        .orbit-core .orbit-visual { background: rgba(0, 240, 255, 0.3); }
        .orbit-core .orbit-visual::before { width: 40px; height: 40px; }

        .orbit-mid .orbit-visual { background: rgba(180, 74, 255, 0.2); }
        .orbit-mid .orbit-visual::before { width: 48px; height: 48px; }

        .orbit-outer .orbit-visual { background: rgba(68, 136, 255, 0.2); }
        .orbit-outer .orbit-visual::before { width: 52px; height: 52px; }

        .orbit-dot {
            width: 12px;
            height: 12px;
            background: #fff;
            border-radius: 50%;
            box-shadow: 0 0 10px #fff;
        }

        .orbit-title {
            font-size: 16px;
            font-weight: 600;
        }

        .orbit-subtitle {
            font-size: 12px;
            color: var(--text-dim);
        }

        .orbit-desc {
            font-size: 13px;
            color: var(--text-dim);
            line-height: 1.6;
        }

        .energy-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        @media (max-width: 600px) {
            .energy-options { grid-template-columns: 1fr; }
        }

        .energy-option {
            padding: 24px;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .energy-option:hover {
            border-color: var(--neon-cyan);
        }

        .energy-option.selected {
            border-color: var(--neon-green);
            background: rgba(0, 255, 136, 0.05);
        }

        .energy-icon {
            font-size: 36px;
            margin-bottom: 12px;
        }

        .energy-level {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .energy-desc {
            font-size: 11px;
            color: var(--text-dim);
        }

        .form-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
        }

        .btn-back {
            padding: 14px 28px;
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-dim);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-back:hover {
            border-color: var(--text);
            color: var(--text);
        }

        .btn-next {
            padding: 14px 40px;
            background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple));
            border: none;
            border-radius: 10px;
            color: #000;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-next:hover {
            box-shadow: 0 0 30px rgba(0, 240, 255, 0.4);
            transform: translateY(-2px);
        }

        .btn-next:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-complete {
            background: linear-gradient(135deg, var(--neon-green), #00aa66);
        }

        .reward-preview {
            margin-top: 32px;
            padding: 24px;
            background: linear-gradient(135deg, rgba(0, 240, 255, 0.1), rgba(180, 74, 255, 0.1));
            border: 1px solid var(--neon-cyan);
            border-radius: 16px;
        }

        .reward-preview-label {
            font-size: 10px;
            color: var(--neon-cyan);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }

        .reward-preview-content {
            font-size: 14px;
            line-height: 1.6;
        }

        .reward-preview-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }
    </style>
</head>
<body>
    <div class="bg-grid"></div>

    <div class="signup-container">
        <div class="progress-panel">
            <div class="progress-logo">
                <div class="progress-logo-icon">A</div>
                <span class="progress-logo-text">AUTUS</span>
            </div>

            <div class="progress-steps">
                <div class="progress-step active" data-step="1">
                    <div class="step-indicator">1</div>
                    <div class="step-content">
                        <h4>ì—­í•  ì„ íƒ</h4>
                        <p>ë‹¹ì‹ ì—ê²Œ ë§ëŠ” í™”ë©´ì„ ì¤€ë¹„í•©ë‹ˆë‹¤</p>
                    </div>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="step-indicator">2</div>
                    <div class="step-content">
                        <h4>ì†Œì† ì—°ê²°</h4>
                        <p>í•™ì›/ë°˜/ë‹´ë‹¹ ì •ë³´ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤</p>
                    </div>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="step-indicator">3</div>
                    <div class="step-content">
                        <h4>ìš°ì„  í•´ê²° ê³¼ì œ</h4>
                        <p>ê°€ì¥ ë¨¼ì € í•´ê²°í•˜ê³  ì‹¶ì€ ê²ƒ</p>
                    </div>
                </div>
                <div class="progress-step" data-step="4">
                    <div class="step-indicator">4</div>
                    <div class="step-content">
                        <h4>ìë™í™” ê±°ë¦¬</h4>
                        <p>AI ê°œì… ìˆ˜ì¤€ì„ ì„ íƒí•©ë‹ˆë‹¤</p>
                    </div>
                </div>
                <div class="progress-step" data-step="5">
                    <div class="step-indicator">5</div>
                    <div class="step-content">
                        <h4>í˜„ì¬ ì—ë„ˆì§€</h4>
                        <p>ì˜¤ëŠ˜ì˜ ì»¨ë””ì…˜ì„ ì•Œë ¤ì£¼ì„¸ìš”</p>
                    </div>
                </div>
            </div>

            <div class="progress-note">
                ğŸ”’ ì…ë ¥í•˜ì‹  ì •ë³´ëŠ” ì˜¤ì§ ë‹¹ì‹ ì˜ ê²½í—˜ ìµœì í™”ì—ë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤. 
                ì–¸ì œë“  ìˆ˜ì •í•˜ê±°ë‚˜ ë‚´ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
        </div>

        <div class="form-panel">
            <!-- Step 1: Role -->
            <div class="form-section active" data-step="1">
                <h2 class="form-title">ì–´ë–¤ ì—­í• ì´ì‹ ê°€ìš”?</h2>
                <p class="form-subtitle">ì„ íƒì— ë”°ë¼ ì™„ì „íˆ ë‹¤ë¥¸ í™”ë©´ì´ ì¤€ë¹„ë©ë‹ˆë‹¤.</p>

                <div class="role-grid" id="roleGrid">
                    <div class="role-card" data-role="owner">
                        <div class="role-card-icon">ğŸ‘”</div>
                        <div class="role-card-name">ì˜¤ë„ˆ</div>
                        <div class="role-card-desc">ì „ì²´ ìš´ì˜ê³¼ ì¬ë¬´ ê´€ë¦¬</div>
                    </div>
                    <div class="role-card" data-role="director">
                        <div class="role-card-icon">ğŸ¯</div>
                        <div class="role-card-name">ì›ì¥</div>
                        <div class="role-card-desc">ì§€ì  ìš´ì˜ê³¼ í•™ìƒ ê´€ë¦¬</div>
                    </div>
                    <div class="role-card" data-role="teacher">
                        <div class="role-card-icon">ğŸ‘¨â€ğŸ«</div>
                        <div class="role-card-name">ê°•ì‚¬</div>
                        <div class="role-card-desc">ìˆ˜ì—…ê³¼ í•™ìƒ ì§€ë„</div>
                    </div>
                    <div class="role-card" data-role="staff">
                        <div class="role-card-icon">ğŸ“‹</div>
                        <div class="role-card-name">í–‰ì •</div>
                        <div class="role-card-desc">í–‰ì • ì—…ë¬´ì™€ í•™ë¶€ëª¨ ì‘ëŒ€</div>
                    </div>
                    <div class="role-card" data-role="parent">
                        <div class="role-card-icon">ğŸ‘ª</div>
                        <div class="role-card-name">í•™ë¶€ëª¨</div>
                        <div class="role-card-desc">ìë…€ì˜ í•™ìŠµ í˜„í™© í™•ì¸</div>
                    </div>
                    <div class="role-card" data-role="student">
                        <div class="role-card-icon">ğŸ“</div>
                        <div class="role-card-name">í•™ìƒ</div>
                        <div class="role-card-desc">ë‚˜ì˜ í•™ìŠµê³¼ ì„±ì¥</div>
                    </div>
                </div>

                <div class="form-nav">
                    <button class="btn-back" onclick="location.href='intro.html'">â† ë’¤ë¡œ</button>
                    <button class="btn-next" id="btnNext1" disabled>ë‹¤ìŒ â†’</button>
                </div>
            </div>

            <!-- Step 2: Affiliation -->
            <div class="form-section" data-step="2">
                <h2 class="form-title">ì†Œì†ì„ ì—°ê²°í•´ì£¼ì„¸ìš”</h2>
                <p class="form-subtitle">ì •í™•í•œ ì •ë³´ê°€ ë” ë‚˜ì€ ê²½í—˜ì„ ë§Œë“­ë‹ˆë‹¤.</p>

                <div class="affiliation-form" id="affiliationForm"></div>

                <div class="form-nav">
                    <button class="btn-back" onclick="goToStep(1)">â† ë’¤ë¡œ</button>
                    <button class="btn-next" id="btnNext2" onclick="goToStep(3)">ë‹¤ìŒ â†’</button>
                </div>
            </div>

            <!-- Step 3: Pain Point -->
            <div class="form-section" data-step="3">
                <h2 class="form-title">ê°€ì¥ ë¨¼ì € í•´ê²°í•˜ê³  ì‹¶ì€ ê²ƒì€?</h2>
                <p class="form-subtitle">ì„ íƒí•œ ë¬¸ì œë¶€í„° í•´ê²°í•´ ë“œë¦½ë‹ˆë‹¤.</p>

                <div class="pain-options" id="painOptions"></div>

                <div class="form-nav">
                    <button class="btn-back" onclick="goToStep(2)">â† ë’¤ë¡œ</button>
                    <button class="btn-next" id="btnNext3" disabled>ë‹¤ìŒ â†’</button>
                </div>
            </div>

            <!-- Step 4: Orbit -->
            <div class="form-section" data-step="4">
                <h2 class="form-title">AIê°€ ì–¼ë§ˆë‚˜ ë„ì™€ë“œë¦´ê¹Œìš”?</h2>
                <p class="form-subtitle">ì–¸ì œë“  ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

                <div class="orbit-options">
                    <div class="orbit-option orbit-core" data-orbit="0.2">
                        <div class="orbit-header">
                            <div class="orbit-visual"><div class="orbit-dot"></div></div>
                            <div>
                                <div class="orbit-title">ê°€ê¹Œì´ (í¸í•¨â†‘)</div>
                                <div class="orbit-subtitle">AI ìë™í™” ìµœëŒ€</div>
                            </div>
                        </div>
                        <p class="orbit-desc">AIê°€ ëŒ€ë¶€ë¶„ì„ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤. í™•ì¸/ì‹¤í–‰ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.</p>
                    </div>

                    <div class="orbit-option orbit-mid recommended" data-orbit="0.5">
                        <div class="orbit-header">
                            <div class="orbit-visual"><div class="orbit-dot"></div></div>
                            <div>
                                <div class="orbit-title">ì¤‘ê°„ (ì¶”ì²œ+ì„ íƒ)</div>
                                <div class="orbit-subtitle">AI ì¶”ì²œ + ë‚´ ì„ íƒ</div>
                            </div>
                        </div>
                        <p class="orbit-desc">AIê°€ ì˜µì…˜ì„ ì œì•ˆí•˜ê³ , ë‚´ê°€ ì„ íƒí•©ë‹ˆë‹¤. ê· í˜•ì¡íŒ í˜‘ì—…ì…ë‹ˆë‹¤.</p>
                    </div>

                    <div class="orbit-option orbit-outer" data-orbit="0.8">
                        <div class="orbit-header">
                            <div class="orbit-visual"><div class="orbit-dot"></div></div>
                            <div>
                                <div class="orbit-title">ë©€ë¦¬ (ììœ¨â†‘)</div>
                                <div class="orbit-subtitle">ì •ë³´ ì œê³µë§Œ</div>
                            </div>
                        </div>
                        <p class="orbit-desc">AIëŠ” ë¶„ì„ ê²°ê³¼ë§Œ ì œê³µí•©ë‹ˆë‹¤. ëª¨ë“  íŒë‹¨ì€ ë‚´ê°€ í•©ë‹ˆë‹¤.</p>
                    </div>
                </div>

                <div class="form-nav">
                    <button class="btn-back" onclick="goToStep(3)">â† ë’¤ë¡œ</button>
                    <button class="btn-next" id="btnNext4" disabled>ë‹¤ìŒ â†’</button>
                </div>
            </div>

            <!-- Step 5: Energy -->
            <div class="form-section" data-step="5">
                <h2 class="form-title">ì˜¤ëŠ˜ ì»¨ë””ì…˜ì€ ì–´ë– ì„¸ìš”?</h2>
                <p class="form-subtitle">ì»¨ë””ì…˜ì— ë§ì¶° ì—…ë¬´ëŸ‰ì„ ì¡°ì ˆí•©ë‹ˆë‹¤.</p>

                <div class="energy-options">
                    <div class="energy-option" data-energy="0.3">
                        <div class="energy-icon">ğŸ˜”</div>
                        <div class="energy-level">ë²ˆì•„ì›ƒ/ë‚®ìŒ</div>
                        <div class="energy-desc">ìµœì†Œí•œë§Œ ì²˜ë¦¬í• ê²Œìš”</div>
                    </div>
                    <div class="energy-option" data-energy="0.5">
                        <div class="energy-icon">ğŸ˜</div>
                        <div class="energy-level">ë³´í†µ</div>
                        <div class="energy-desc">ì ë‹¹íˆ ì§„í–‰í• ê²Œìš”</div>
                    </div>
                    <div class="energy-option" data-energy="0.8">
                        <div class="energy-icon">ğŸ˜„</div>
                        <div class="energy-level">ì˜ìš•ì /ë†’ìŒ</div>
                        <div class="energy-desc">ë” ë§ì´ í•´ë³¼ê²Œìš”</div>
                    </div>
                </div>

                <div class="reward-preview" id="rewardPreview" style="display: none;">
                    <div class="reward-preview-label">ğŸ ì²« ë²ˆì§¸ ë³´ìƒ ì¹´ë“œê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤</div>
                    <div class="reward-preview-icon" id="rewardIcon"></div>
                    <div class="reward-preview-content" id="rewardContent"></div>
                </div>

                <div class="form-nav">
                    <button class="btn-back" onclick="goToStep(4)">â† ë’¤ë¡œ</button>
                    <button class="btn-next btn-complete" id="btnComplete" disabled onclick="completeSignup()">
                        ì™„ë£Œí•˜ê³  ì²« ë³´ìƒ ë°›ê¸° ğŸ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/data.js"></script>
    <script>
        const kernelData = {
            role_id: null,
            affiliation_map: {},
            base_capacity: 0,
            pain_point_top1: null,
            sync_orbit: 0.5,
            current_energy: 0.5
        };

        let currentStep = 1;

        const painPoints = {
            owner: [
                { id: 'cashflow', icon: 'ğŸ’°', title: 'ë¯¸ë‚©/í˜„ê¸ˆíë¦„', desc: 'ìˆ˜ë‚© ê´€ë¦¬ì™€ ë¯¸ë‚© ì¶”ì ì´ ì–´ë µë‹¤' },
                { id: 'churn', icon: 'ğŸ“‰', title: 'í‡´ì› ë¦¬ìŠ¤í¬', desc: 'ê°‘ì‘ìŠ¤ëŸ¬ìš´ í‡´ì›ì„ ì˜ˆì¸¡í•˜ê¸° ì–´ë µë‹¤' },
                { id: 'growth', icon: 'ğŸ“Š', title: 'ì„±ì¥ ì •ì²´', desc: 'í•™ì› ì„±ì¥ ë°©í–¥ì„ ì¡ê¸° ì–´ë µë‹¤' }
            ],
            director: [
                { id: 'churn', icon: 'ğŸ“‰', title: 'í‡´ì› ë¦¬ìŠ¤í¬', desc: 'í•™ìƒ ì´íƒˆì„ ë¯¸ë¦¬ ê°ì§€í•˜ê³  ì‹¶ë‹¤' },
                { id: 'staff', icon: 'ğŸ‘¥', title: 'ì§ì› ê´€ë¦¬', desc: 'ê°•ì‚¬/ì§ì› ì—­ëŸ‰ íŒŒì•…ì´ ì–´ë µë‹¤' },
                { id: 'parent', icon: 'ğŸ’¬', title: 'í•™ë¶€ëª¨ ì†Œí†µ', desc: 'í•™ë¶€ëª¨ ë¶ˆë§Œì„ ë¯¸ë¦¬ ì•Œê³  ì‹¶ë‹¤' }
            ],
            teacher: [
                { id: 'admin', icon: 'ğŸ“', title: 'ì¡ë¬´/í–‰ì •', desc: 'ìƒë‹´ ì¼ì§€, ë¦¬í¬íŠ¸ ì‘ì„±ì— ì‹œê°„ì´ ë„ˆë¬´ ë§ì´ ë“ ë‹¤' },
                { id: 'prep', icon: 'ğŸ“š', title: 'ìˆ˜ì—… ì¤€ë¹„', desc: 'í•™ìƒë³„ ë§ì¶¤ ìˆ˜ì—… ì¤€ë¹„ê°€ ë¶€ë‹´ìŠ¤ëŸ½ë‹¤' },
                { id: 'parent', icon: 'ğŸ’¬', title: 'í•™ë¶€ëª¨ ì†Œí†µ', desc: 'ë¯¼ê°í•œ í•™ë¶€ëª¨ ëŒ€ì‘ì´ ìŠ¤íŠ¸ë ˆìŠ¤ë‹¤' }
            ],
            staff: [
                { id: 'emotion', icon: 'ğŸ˜“', title: 'ê°ì • ë…¸ë™', desc: 'í•™ë¶€ëª¨ ì»´í”Œë ˆì¸ ì‘ëŒ€ê°€ í˜ë“¤ë‹¤' },
                { id: 'schedule', icon: 'ğŸ“…', title: 'ì¼ì • ì¡°ìœ¨', desc: 'ìƒë‹´/ë³´ì¶© ì¼ì • ì¡°ìœ¨ì´ ë³µì¡í•˜ë‹¤' },
                { id: 'document', icon: 'ğŸ“‹', title: 'ë¬¸ì„œ ì‘ì—…', desc: 'ë°˜ë³µë˜ëŠ” ì•ˆë‚´ë¬¸/ê³µì§€ ì‘ì„±ì´ ë§ë‹¤' }
            ],
            parent: [
                { id: 'anxiety', icon: 'ğŸ˜°', title: 'í•™ìŠµ ë¶ˆì•ˆ', desc: 'ì•„ì´ê°€ ì œëŒ€ë¡œ ë”°ë¼ê°€ëŠ”ì§€ ê±±ì •ëœë‹¤' },
                { id: 'visibility', icon: 'ğŸ‘€', title: 'ì •ë³´ ë¶€ì¡±', desc: 'ì•„ì´ì˜ í•™ìŠµ ìƒí™©ì„ íŒŒì•…í•˜ê¸° ì–´ë µë‹¤' },
                { id: 'communication', icon: 'ğŸ’¬', title: 'ì†Œí†µ ë§ˆì°°', desc: 'ì„ ìƒë‹˜ê³¼ ì†Œí†µì´ ì›í™œí•˜ì§€ ì•Šë‹¤' }
            ],
            student: [
                { id: 'motivation', icon: 'ğŸ˜´', title: 'ë™ê¸° ë¶€ì¡±', desc: 'ê³µë¶€í•  ì˜ìš•ì´ ì•ˆ ìƒê¸´ë‹¤' },
                { id: 'difficulty', icon: 'ğŸ˜µ', title: 'ì´í•´ ì–´ë ¤ì›€', desc: 'ìˆ˜ì—… ë‚´ìš©ì´ ì–´ë µë‹¤' },
                { id: 'boredom', icon: 'ğŸ˜‘', title: 'ì§€ë£¨í•¨', desc: 'ê³µë¶€ê°€ ì¬ë¯¸ì—†ë‹¤' }
            ]
        };

        const affiliationFields = {
            owner: [
                { id: 'academy_name', label: 'í•™ì›ëª…', placeholder: 'ì˜ˆ: í•´ì˜¤ë¦„ ì˜ì–´í•™ì›' },
                { id: 'branch_count', label: 'ìš´ì˜ ì§€ì  ìˆ˜', type: 'slider', min: 1, max: 10 }
            ],
            director: [
                { id: 'academy_name', label: 'í•™ì›ëª…', placeholder: 'ì˜ˆ: í•´ì˜¤ë¦„ ì˜ì–´í•™ì›' },
                { id: 'branch_name', label: 'ì§€ì ëª…', placeholder: 'ì˜ˆ: ê°•ë‚¨ì ' },
                { id: 'student_count', label: 'ë‹´ë‹¹ í•™ìƒ ìˆ˜', type: 'slider', min: 10, max: 200 }
            ],
            teacher: [
                { id: 'academy_name', label: 'í•™ì›ëª…', placeholder: 'ì˜ˆ: í•´ì˜¤ë¦„ ì˜ì–´í•™ì›' },
                { id: 'subject', label: 'ë‹´ë‹¹ ê³¼ëª©', placeholder: 'ì˜ˆ: ì˜ì–´' },
                { id: 'student_count', label: 'ë‹´ë‹¹ í•™ìƒ ìˆ˜', type: 'slider', min: 5, max: 50 }
            ],
            staff: [
                { id: 'academy_name', label: 'í•™ì›ëª…', placeholder: 'ì˜ˆ: í•´ì˜¤ë¦„ ì˜ì–´í•™ì›' },
                { id: 'department', label: 'ë‹´ë‹¹ ì—…ë¬´', placeholder: 'ì˜ˆ: í–‰ì •/ìƒë‹´/ìˆ˜ë‚©' }
            ],
            parent: [
                { id: 'academy_name', label: 'ìë…€ í•™ì›ëª…', placeholder: 'ì˜ˆ: í•´ì˜¤ë¦„ ì˜ì–´í•™ì›' },
                { id: 'child_name', label: 'ìë…€ ì´ë¦„', placeholder: 'ì˜ˆ: ê¹€ì—°ìš°' },
                { id: 'child_count', label: 'ìë…€ ìˆ˜', type: 'slider', min: 1, max: 4 }
            ],
            student: [
                { id: 'academy_name', label: 'í•™ì›ëª…', placeholder: 'ì˜ˆ: í•´ì˜¤ë¦„ ì˜ì–´í•™ì›' },
                { id: 'grade', label: 'í•™ë…„', placeholder: 'ì˜ˆ: ì¤‘2' },
                { id: 'subject', label: 'ìˆ˜ê°• ê³¼ëª©', placeholder: 'ì˜ˆ: ì˜ì–´, ìˆ˜í•™' }
            ]
        };

        const firstRewards = {
            owner: { icon: 'ğŸ’°', msg: 'ì´ë²ˆ ë‹¬ ë¯¸ë‚© ì˜ˆìƒ ê°€êµ¬ 4ê³³ì„ ì¶”ì¶œí–ˆìŠµë‹ˆë‹¤. ì •ì¤‘í•œ ë‚©ë¶€ ì•ˆë‚´ ë¬¸ì•ˆ 3ì¢…ì„ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤.' },
            director: { icon: 'ğŸ“Š', msg: 'ìµœê·¼ 3ì¼ê°„ í•™ìŠµ ì—ë„ˆì§€ê°€ ê¸‰ê°í•œ í•™ìƒ 2ëª…ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ë§ì¶¤ ëŒ€ì‘ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤.' },
            teacher: { icon: 'ğŸ“', msg: 'ì˜¤ëŠ˜ ìƒë‹´ ì¼ì§€ 5ê±´ì˜ ì´ˆì•ˆì„ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. í‡´ê·¼ ì‹œê°„ì„ 20ë¶„ ì•ë‹¹ê²¨ ë“œë¦´ê²Œìš”.' },
            staff: { icon: 'ğŸ›¡ï¸', msg: 'ê°ì •ì  ë¬¸ì˜ 1ê±´ì˜ í•µì‹¬ ìš”êµ¬ì‚¬í•­ì„ ìš”ì•½í–ˆìŠµë‹ˆë‹¤. ë‹µë³€ ì˜µì…˜ 2ê°œë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.' },
            parent: { icon: 'ğŸŒŸ', msg: 'ì—°ìš°ê°€ ì˜¤ëŠ˜ ê°€ì¥ ì–´ë ¤ì›Œí•˜ë˜ ë¬¸ì œë¥¼ ìŠ¤ìŠ¤ë¡œ í’€ì—ˆìŠµë‹ˆë‹¤! 15ì´ˆ ì„±ì¥ ë¦¬í¬íŠ¸ë¥¼ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤.' },
            student: { icon: 'ğŸ®', msg: 'ì˜¤ëŠ˜ í€˜ìŠ¤íŠ¸ 3ê°œë§Œ ì™„ë£Œí•˜ë©´ "ë‹¨ì–´ ë§ˆìŠ¤í„°" ë°°ì§€ íšë“! ì–´ì œ í‹€ë¦° ë¬¸ì œ ë³µìŠµ ì‹œ ê²½í—˜ì¹˜ 2ë°°!' }
        };

        const preferredRole = localStorage.getItem('autus_preferred_role');
        if (preferredRole) {
            selectRole(preferredRole);
        }

        function goToStep(step) {
            document.querySelectorAll('.progress-step').forEach(s => {
                const stepNum = parseInt(s.dataset.step);
                s.classList.remove('active', 'completed');
                if (stepNum < step) s.classList.add('completed');
                if (stepNum === step) s.classList.add('active');
            });

            document.querySelectorAll('.form-section').forEach(s => {
                s.classList.remove('active');
                if (parseInt(s.dataset.step) === step) s.classList.add('active');
            });

            currentStep = step;
        }

        document.getElementById('roleGrid').addEventListener('click', (e) => {
            const card = e.target.closest('.role-card');
            if (card) {
                selectRole(card.dataset.role);
            }
        });

        function selectRole(role) {
            kernelData.role_id = role;
            
            document.querySelectorAll('.role-card').forEach(c => c.classList.remove('selected'));
            const selectedCard = document.querySelector(`[data-role="${role}"]`);
            if (selectedCard) selectedCard.classList.add('selected');

            document.getElementById('btnNext1').disabled = false;
            document.getElementById('btnNext1').onclick = () => {
                renderAffiliationForm(role);
                goToStep(2);
            };
        }

        function renderAffiliationForm(role) {
            const fields = affiliationFields[role] || [];
            const form = document.getElementById('affiliationForm');

            form.innerHTML = fields.map(field => {
                if (field.type === 'slider') {
                    return `
                        <div class="input-group">
                            <label class="input-label">${field.label}</label>
                            <div class="capacity-slider">
                                <div class="slider-header">
                                    <span>${field.label}</span>
                                    <span class="slider-value" id="${field.id}Value">${field.min}</span>
                                </div>
                                <input type="range" id="${field.id}" min="${field.min}" max="${field.max}" value="${field.min}"
                                    oninput="document.getElementById('${field.id}Value').textContent = this.value; kernelData.base_capacity = parseInt(this.value);">
                            </div>
                        </div>
                    `;
                }
                return `
                    <div class="input-group">
                        <label class="input-label">${field.label}</label>
                        <input type="text" class="input-field" id="${field.id}" 
                            placeholder="${field.placeholder}"
                            oninput="kernelData.affiliation_map['${field.id}'] = this.value;">
                    </div>
                `;
            }).join('');

            renderPainPoints(role);
        }

        function renderPainPoints(role) {
            const pains = painPoints[role] || [];
            const container = document.getElementById('painOptions');

            container.innerHTML = pains.map(pain => `
                <div class="pain-option" data-pain="${pain.id}">
                    <div class="pain-icon">${pain.icon}</div>
                    <div class="pain-text">
                        <h4>${pain.title}</h4>
                        <p>${pain.desc}</p>
                    </div>
                </div>
            `).join('');

            container.querySelectorAll('.pain-option').forEach(opt => {
                opt.addEventListener('click', () => {
                    container.querySelectorAll('.pain-option').forEach(o => o.classList.remove('selected'));
                    opt.classList.add('selected');
                    kernelData.pain_point_top1 = opt.dataset.pain;
                    document.getElementById('btnNext3').disabled = false;
                    document.getElementById('btnNext3').onclick = () => goToStep(4);
                });
            });
        }

        document.querySelectorAll('.orbit-option').forEach(opt => {
            opt.addEventListener('click', () => {
                document.querySelectorAll('.orbit-option').forEach(o => o.classList.remove('selected'));
                opt.classList.add('selected');
                kernelData.sync_orbit = parseFloat(opt.dataset.orbit);
                document.getElementById('btnNext4').disabled = false;
                document.getElementById('btnNext4').onclick = () => goToStep(5);
            });
        });

        document.querySelectorAll('.energy-option').forEach(opt => {
            opt.addEventListener('click', () => {
                document.querySelectorAll('.energy-option').forEach(o => o.classList.remove('selected'));
                opt.classList.add('selected');
                kernelData.current_energy = parseFloat(opt.dataset.energy);
                
                const reward = firstRewards[kernelData.role_id];
                document.getElementById('rewardIcon').textContent = reward.icon;
                document.getElementById('rewardContent').textContent = reward.msg;
                document.getElementById('rewardPreview').style.display = 'block';
                
                document.getElementById('btnComplete').disabled = false;
            });
        });

        function completeSignup() {
            console.log('Event: onSignupCompleted', kernelData);
            console.log('Event: onRoleFixed', kernelData.role_id);
            console.log('Event: onOrbitSet', kernelData.sync_orbit);
            console.log('Event: onFirstRewardIssued');

            localStorage.setItem('autus_kernel', JSON.stringify(kernelData));

            if (typeof AUTUS !== 'undefined') {
                AUTUS.resetData();
            }

            location.href = 'index.html';
        }
    </script>
</body>
</html>
