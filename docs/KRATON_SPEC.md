# 🏛️ KRATON v2 - 기능 명세서

> **Tesla Grade Business Intelligence**  
> https://autus-ai.com

---

## 📋 목차

1. [역할별 기능](#1-역할별-기능)
2. [기능별 플로우 및 와이어프레임](#2-기능별-플로우-및-와이어프레임)
3. [결과값 UI 적용방식과 디자인](#3-결과값-ui-적용방식과-디자인)

---

# 1. 역할별 기능

## 🏛️ 내부 역할 (3-Tier System)

### Tier 1: C-Level (Vision & Resource Director)
> **접근 방식:** 마스터 비밀번호  
> **자동화율:** 20%  
> **핵심 철학:** 전략적 의사결정, 자산 가치 모니터링

| 모듈 | 기능 | 데이터 소스 |
|------|------|------------|
| **Monopoly** | 3대 독점 체제 통합 모니터링 | 전체 시스템 |
| **Analytics** | 매출/V-Index/KPI 분석 | Supabase |
| **Accel** | 시스템 가속도 측정, 자동화 효과 | n8n 워크플로우 |
| **Global** | 한국-필리핀 통합 텔레메트리 | 글로벌 노드 |
| **Viral** | 고객 추천 네트워크, 바이럴 계수 | 추천 데이터 |
| **Auto** | 자동화 규칙 관리, 실행 로그 | n8n |

#### C-Level 핵심 지표
```
V-Index = (M - T) × (1 + s)^t
- M: 매출 (Mint)
- T: 비용 (Tax)
- s: 만족도 지수
- t: 시간 (개월)
```

---

### Tier 2: FSD (Judgment & Allocation Lead)
> **접근 방식:** C-Level 승인 코드  
> **자동화율:** 80%  
> **핵심 철학:** 판단과 배분, 리스크 관리

| 모듈 | 기능 | 흡수된 역할 |
|------|------|------------|
| **Judgment** | 시장/투자자 분석, 트렌드 모니터링 | Ecosystem Observer, Capital Enabler |
| **Principal** | 관리자 위험 알림, 선생님 현황 | - |
| **Retention** | 이탈 방지 시스템, 방어 전략 | - |
| **Risk Queue** | 위기 판단 및 대응 관리 | - |
| **Chemistry** | 실무자-고객 최적 매칭 분석 | - |
| **Mirror** | 학부모 앱 사용 패턴 역추적 | - |

#### FSD 핵심 지표
```
R(t) = Σ(w_i × ΔM_i) / s(t)^α
- w_i: 시간 가중치 (최근 데이터 우선)
- ΔM_i: 성과 변화량
- s(t): 현재 만족도
- α: 만족도 민감도 (1.5)
```

---

### Tier 3: Optimus (Execution Operator)
> **접근 방식:** FSD 승인 코드  
> **자동화율:** 98%  
> **핵심 철학:** 자동 실행, 현장 데이터 수집

| 모듈 | 기능 | 흡수된 역할 |
|------|------|------------|
| **Execution** | 위기 대응, CSR, IR 실행 | Opinion Shaper, Indirect Affected |
| **Quick Tag** | 관계 데이터 즉시 입력 (Vector Tagging) | - |
| **Script AI** | AI 상담 스크립트 자동 생성 | - |
| **Students** | 학생 상세 정보, 상태 관리 | - |
| **Attendance** | 출결 관리 | - |
| **Calendar** | 일정 관리 | - |

#### Optimus 핵심 지표
```
Execution Score = (완료 태스크 / 전체 태스크) × 자동화율
```

---

## 🌐 외부 역할 (Active Users)

### Consumer (Primary Service Consumer)
> **접근 방식:** 바로 접속  
> **대상:** 고객, 학생, 사용자

| 기능 | 설명 |
|------|------|
| V-Index 확인 | 개인 가치 지수 조회 |
| 활동 내역 | 수업, 테스트, 출석 기록 |
| V-포인트 | 적립/교환 내역 |
| AI 추천 | 맞춤형 학습 추천 |

### Regulatory (Regulatory Participant)
> **접근 방식:** 바로 접속  
> **대상:** 정부 담당자, 행정 요원

| 기능 | 설명 |
|------|------|
| 규제 준수 현황 | 법적 요건 충족 상태 |
| 보고서 조회 | 정기 보고서 다운로드 |
| 감사 로그 | 시스템 활동 기록 |

### Partner (Partner Collaborator)
> **접근 방식:** 바로 접속  
> **대상:** 공급자, 파트너사

| 기능 | 설명 |
|------|------|
| 협업 현황 | 파트너십 상태 |
| 정산 내역 | 수익 배분 현황 |
| API 접근 | 시스템 연동 |

---

# 2. 기능별 플로우 및 와이어프레임

## 2.1 로그인 플로우

```
┌─────────────────────────────────────────────────────────┐
│                    AUTUS Control System                  │
│                      역할을 선택하세요                    │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  🏛️ 내부 역할 (검증 대기 승인)                           │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐              │
│  │  Tier 1  │  │  Tier 2  │  │  Tier 3  │              │
│  │ C-Level  │  │   FSD    │  │ Optimus  │              │
│  │  👑 20%  │  │  🎯 80%  │  │  ⚡ 98%  │              │
│  │ 마스터PW │  │ C승인필요 │  │ F승인필요 │              │
│  └──────────┘  └──────────┘  └──────────┘              │
│                                                          │
│  🌐 외부 이용 주체 (바로 접속)                           │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐              │
│  │ Consumer │  │Regulatory│  │ Partner  │              │
│  │   95%    │  │   80%    │  │   90%    │              │
│  └──────────┘  └──────────┘  └──────────┘              │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

### 로그인 승인 체계
```
C-Level ─── 마스터 비밀번호 (4자리 이상)
    │
    ▼ 승인 코드 발급
   FSD ─── C-Level 승인 코드
    │
    ▼ 승인 코드 발급
Optimus ─── FSD 승인 코드
```

---

## 2.2 KRATON Monopoly System

### 데이터 플로우
```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   현장 입력  │     │  n8n 처리   │     │  Supabase   │
│  Quick-Tag  │ ──▶ │ 물리량 변환  │ ──▶ │   저장      │
│  Voice-to-  │     │ R(t) 계산   │     │             │
│  Insight    │     │ V 계산      │     │             │
└─────────────┘     └─────────────┘     └─────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────┐
│                   Monopoly Dashboard                     │
├─────────────────┬─────────────────┬─────────────────────┤
│  👁️ 인지 독점   │  🎯 판단 독점   │   🌐 구조 독점      │
│  Vector Tag    │  FSD Predict   │   Global Pipeline   │
│  847 tags/day  │  87% accuracy  │   0.8s sync         │
├─────────────────┴─────────────────┴─────────────────────┤
│  Live Feed     │  Prediction    │   Global Flow       │
│  이선생→오연우  │  오연우 82%    │   🇰🇷 ₩2.69B       │
│  [s:-20][M:-10]│  14일 예상     │   🇵🇭 ₩23.1B       │
├─────────────────┴─────────────────┴─────────────────────┤
│  🔬 KRATON Physics Engine                               │
│  R(t) = Σ(w_i × ΔM_i) / s(t)^α                         │
│  V = (M - T) × (1 + s)^t                               │
└─────────────────────────────────────────────────────────┘
```

---

## 2.3 FSD Risk Queue 플로우

```
┌─────────────────────────────────────────────────────────┐
│                    Risk Detection                        │
└─────────────────────────────────────────────────────────┘
                           │
        ┌──────────────────┼──────────────────┐
        ▼                  ▼                  ▼
┌───────────────┐  ┌───────────────┐  ┌───────────────┐
│ s-Index < 40% │  │ M 2회 연속 ↓  │  │ Trust Score ↓ │
└───────────────┘  └───────────────┘  └───────────────┘
        │                  │                  │
        └──────────────────┼──────────────────┘
                           ▼
┌─────────────────────────────────────────────────────────┐
│                    Risk Queue                            │
├─────────────────────────────────────────────────────────┤
│  Priority │ Target    │ Context              │ Status   │
├───────────┼───────────┼──────────────────────┼──────────┤
│  CRITICAL │ 오연우    │ 성취도↓ + 학부모불안 │ 신규     │
│  HIGH     │ 박민수    │ 만족도 3주간 -15%   │ 해결됨   │
│  MEDIUM   │ 이영희父  │ Trust Score 감소    │ 처리중   │
│  LOW      │ 김철수    │ 결석 증가 추세      │ 해결됨   │
└─────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────┐
│                  Auto-Actuation                          │
├─────────────────────────────────────────────────────────┤
│  • Safety Mirror → 긍정 리포트 발송                      │
│  • Teacher Console → 특별 케어 액션 생성                 │
│  • Principal Console → 팝업 알림                        │
└─────────────────────────────────────────────────────────┘
```

---

## 2.4 Quick Tag 입력 플로우

```
┌─────────────────────────────────────────────────────────┐
│              Quick Tag Console (Optimus)                 │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  1️⃣ 대상 선택                                           │
│  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐           │
│  │김철수  │ │이영희  │ │박민수  │ │최수진  │           │
│  │72% s  │ │85% s  │ │45% s  │ │68% s  │           │
│  └────────┘ └────────┘ └────────┘ └────────┘           │
│                                                          │
│  2️⃣ 상태 태깅                                           │
│  ┌─────────────────────────────────────────┐            │
│  │ 감정 상태 (s_index)                     │            │
│  │ 😊+20  🙂+10  😐-10  😟-20            │            │
│  ├─────────────────────────────────────────┤            │
│  │ 유대 강도 (Bond)                        │            │
│  │ 🔗강함  ⛓️보통  🧊차가움               │            │
│  ├─────────────────────────────────────────┤            │
│  │ 이슈 트리거                             │            │
│  │ 📚학업  💰비용  🎯진로  😤태도  📅일정  │            │
│  └─────────────────────────────────────────┘            │
│                                                          │
│  3️⃣ Voice-to-Insight                                    │
│  ┌─────────────────────────────────────────┐            │
│  │ 🎙️ "철수 어머니가 비용 걱정을..."       │            │
│  │     ↓ AI 분석                           │            │
│  │ → Capital_Pressure_High 활성화          │            │
│  │ → 관계 지수 -5% 조정                    │            │
│  └─────────────────────────────────────────┘            │
│                                                          │
│  [👁️ 인지 데이터 저장] → n8n Webhook                    │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

---

## 2.5 Chemistry Matching 플로우

```
┌─────────────────────────────────────────────────────────┐
│              Chemistry Matching (FSD)                    │
├─────────────────────────────────────────────────────────┤
│                                                          │
│  👨‍🏫 선생님 Pool              👩‍🎓 학생 Pool              │
│  ┌─────────────┐            ┌─────────────┐             │
│  │ 김선생     │            │ 오연우      │             │
│  │ 엄격/관리형│            │ 자기주도형  │             │
│  │ 성공률 82% │            │ 위험 상태   │             │
│  └─────────────┘            └─────────────┘             │
│         │                          │                    │
│         └──────────┬───────────────┘                    │
│                    ▼                                    │
│  ┌─────────────────────────────────────────┐            │
│  │         Chemistry Analysis              │            │
│  │  ┌───────────────────────────────┐     │            │
│  │  │ 상성 점수: 78%                │     │            │
│  │  │ 예측 V 창출: +₩2.4M          │     │            │
│  │  │ 권장 매칭: ✅ 적합            │     │            │
│  │  └───────────────────────────────┘     │            │
│  │                                         │            │
│  │  📊 과거 데이터 기반 분석              │            │
│  │  • 유사 케이스 성공률: 85%             │            │
│  │  • 평균 관계 지속 기간: 14개월         │            │
│  │  • AI 추천 이유: 성향 보완 관계        │            │
│  └─────────────────────────────────────────┘            │
│                                                          │
│  [매칭 적용] [다른 옵션 보기] [AI 재분석]                │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

---

## 2.6 Global Pipeline 데이터 플로우

```
┌─────────────────────────────────────────────────────────┐
│              Global Data Pipeline                        │
└─────────────────────────────────────────────────────────┘

    🇰🇷 Korea (HQ)                    🇵🇭 Philippines (Clark)
   ┌─────────────────┐              ┌─────────────────┐
   │  Teacher Console│              │  Teacher Console│
   │  Parent App     │              │  Parent App     │
   │  Admin System   │              │  Admin System   │
   └────────┬────────┘              └────────┬────────┘
            │                                 │
            │   Perception Data               │
            │   (Quick-Tag, Voice)            │
            ▼                                 ▼
   ┌─────────────────────────────────────────────────────┐
   │                    n8n Hub                           │
   │  ┌─────────┐  ┌─────────┐  ┌─────────┐             │
   │  │ Churn   │  │Incentive│  │ Global  │             │
   │  │Detection│  │  Loop   │  │V-Consol │             │
   │  └─────────┘  └─────────┘  └─────────┘             │
   └─────────────────────────────────────────────────────┘
                           │
                           ▼
   ┌─────────────────────────────────────────────────────┐
   │                   Supabase                           │
   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │
   │  │relational_  │  │interaction_ │  │physics_     │ │
   │  │nodes        │  │logs         │  │metrics      │ │
   │  └─────────────┘  └─────────────┘  └─────────────┘ │
   └─────────────────────────────────────────────────────┘
                           │
                           ▼
   ┌─────────────────────────────────────────────────────┐
   │              Real-time Distribution                  │
   ├──────────────────┬──────────────────────────────────┤
   │  C-Level         │  Owner Console (V-Curve)         │
   │  FSD             │  Risk Queue, Chemistry           │
   │  Optimus         │  Execution Queue                 │
   │  Consumer        │  My Space (V-Index)              │
   └──────────────────┴──────────────────────────────────┘
```

---

# 3. 결과값 UI 적용방식과 디자인

## 3.1 디자인 시스템

### 컬러 팔레트

```css
/* 배경 */
--bg-primary: #0a0a0f;      /* 메인 배경 */
--bg-secondary: #111118;    /* 카드 배경 */
--bg-tertiary: #1a1a24;     /* 섹션 배경 */

/* 역할별 액센트 */
--c-level: #ffd700;         /* 금색 - C-Level */
--fsd: #00aaff;             /* 시안 - FSD */
--optimus: #00cc66;         /* 녹색 - Optimus */
--consumer: #9966ff;        /* 보라 - External */

/* 상태 */
--success: #10b981;         /* 성공/긍정 */
--warning: #f59e0b;         /* 경고/주의 */
--danger: #ef4444;          /* 위험/긴급 */
--info: #3b82f6;            /* 정보 */

/* 텍스트 */
--text-primary: #ffffff;
--text-secondary: #a0a0a0;
--text-muted: #666666;
```

### 5-Tier 노드 컬러
```css
--tier-1: #ffd700;  /* T1 허브 - 금색 */
--tier-2: #00aaff;  /* T2 커넥터 - 파랑 */
--tier-3: #00cc66;  /* T3 액티브 - 초록 */
--tier-4: #888888;  /* T4 일반 - 회색 */
--tier-ghost: #333333; /* Ghost 비활성 - 진회색 */
```

---

## 3.2 컴포넌트 스타일

### GlassCard (기본 카드)
```jsx
<div className="
  bg-gray-800/30 
  backdrop-blur-xl 
  border border-gray-700/50 
  rounded-2xl 
  p-6
  shadow-lg
">
  {children}
</div>
```

### 메트릭 카드
```
┌─────────────────────────────────┐
│  📊 월 매출              💰     │
│  ┌───────────────────────────┐ │
│  │     ₩285M                 │ │
│  │     +12.0%  ↑             │ │
│  └───────────────────────────┘ │
└─────────────────────────────────┘
```

### 진행률 게이지
```
┌─────────────────────────────────┐
│  자동화율                       │
│  ████████████████░░░░ 73%      │
│                                 │
│  목표 달성률                    │
│  ██████████░░░░░░░░░░ 52%      │
└─────────────────────────────────┘
```

### 위험도 표시
```
┌─────────────────────────────────┐
│  🔴 CRITICAL  오연우            │
│  ├─ 이탈 위험: 82%              │
│  ├─ 예상 이탈: 14일             │
│  └─ 🤖 긍정 리포트 발송 예정    │
│                                 │
│  🟡 HIGH      김민지            │
│  ├─ 이탈 위험: 65%              │
│  ├─ 예상 이탈: 28일             │
│  └─ 🤖 할인 프로모션 준비       │
│                                 │
│  🟢 WATCH     이준혁            │
│  ├─ 이탈 위험: 48%              │
│  └─ 🤖 담당 변경 검토           │
└─────────────────────────────────┘
```

---

## 3.3 데이터 시각화

### V-Curve (시계열 차트)
```
V-Index (₩B)
    │
3.0 │                          ●───
    │                     ●────
2.5 │                ●────
    │           ●────
2.0 │      ●────
    │ ●────
1.5 │────
    └──────────────────────────────
      1월  2월  3월  4월  5월  6월
    
    ─── Korea  ─── Philippines  ─── Total
```

### Retention Funnel
```
┌─────────────────────────────────────────────┐
│  전체 학생                           245명  │
│  █████████████████████████████████████████ │
├─────────────────────────────────────────────┤
│  관찰 대상                            46명  │
│  ████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ │
├─────────────────────────────────────────────┤
│  주의 필요                            18명  │
│  ███░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ │
├─────────────────────────────────────────────┤
│  위험                                  4명  │
│  █░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ │
└─────────────────────────────────────────────┘
```

### 도넛 게이지 (Acceleration)
```
        ╭───────────╮
      ╱             ╲
     │   2.8x       │
     │   System     │
     │ Acceleration │
      ╲             ╱
        ╰───────────╯
     잠재력: 4.2x
```

### 네트워크 그래프 (Relational Map)
```
                    [T1]
                  ● 원장
                 /  |  \
              /     |     \
           /        |        \
        [T2]      [T2]      [T2]
        ● 김선생  ● 이선생  ● 박선생
       / \        / \        / \
     /    \     /    \     /    \
   [T3]  [T3] [T3]  [T3] [T3]  [T3]
   ● 학생A ● 학생B ● 학생C ● 학생D ...
    |       |       |       |
   [T4]    [T4]    [T4]    [T4]
   ● 학부모 ● 학부모 ● 학부모 ● 학부모
   
   ─── 강한 결속 (s > 70%)
   --- 보통 결속 (40% < s < 70%)
   ··· 약한 결속 (s < 40%)
   🔴 위험 노드
```

---

## 3.4 애니메이션 & 인터랙션

### 실시간 펄스 효과
```jsx
// 위험 노드 애니메이션
<motion.div
  animate={{ scale: [1, 1.05, 1] }}
  transition={{ duration: 2, repeat: Infinity }}
  className="bg-red-500/20 border-red-500"
/>
```

### 데이터 로딩 트랜지션
```jsx
// 카드 진입 애니메이션
<motion.div
  initial={{ opacity: 0, y: 20 }}
  animate={{ opacity: 1, y: 0 }}
  transition={{ duration: 0.3 }}
/>
```

### 숫자 카운터 애니메이션
```jsx
// V-Index 숫자 롤링
₩2,690,000,000 → ₩2,695,000,000
(0.5초 동안 부드럽게 증가)
```

### 마우스 호버 효과
```jsx
// 카드 호버
<div className="
  transition-all duration-300
  hover:scale-[1.02]
  hover:border-cyan-500/50
  hover:shadow-lg hover:shadow-cyan-500/10
">
```

---

## 3.5 반응형 레이아웃

### 브레이크포인트
```css
/* Mobile */
@media (max-width: 639px) {
  /* 1열 레이아웃 */
}

/* Tablet */
@media (min-width: 640px) and (max-width: 1023px) {
  /* 2열 레이아웃 */
}

/* Desktop */
@media (min-width: 1024px) {
  /* 3열 레이아웃 */
}

/* Large Desktop */
@media (min-width: 1280px) {
  /* 4열 레이아웃, 사이드바 확장 */
}
```

### 네비게이션 바
```
Desktop (1024px+):
┌─────────────────────────────────────────────────────────┐
│ 🏛️ KRATON │ Monopoly │ Analytics │ Global │ Settings │ │
└─────────────────────────────────────────────────────────┘

Mobile (< 640px):
┌─────────────────────────────────────────────────────────┐
│ 🏛️ KRATON                                    ☰ 메뉴   │
└─────────────────────────────────────────────────────────┘
```

---

## 3.6 알림 & 토스트

### 알림 유형
```
┌─────────────────────────────────────────────┐
│ ✅ 성공                                      │
│ 학생 정보가 저장되었습니다                    │
└─────────────────────────────────────────────┘

┌─────────────────────────────────────────────┐
│ ⚠️ 경고                                      │
│ 오연우 학생의 이탈 위험이 80%를 초과했습니다  │
│                          [확인] [상세보기]   │
└─────────────────────────────────────────────┘

┌─────────────────────────────────────────────┐
│ 🔴 긴급                                      │
│ 즉시 개입이 필요합니다                        │
│ 오연우: 3회 연속 결석, 학부모 앱 미접속 7일   │
│                          [지금 전화] [무시]  │
└─────────────────────────────────────────────┘
```

---

## 3.7 Physics 엔진 시각화

### 수식 표시
```
┌─────────────────────────────────────────────┐
│  🔬 KRATON Physics Engine                   │
│                                              │
│  이탈 위험도                                 │
│  R(t) = Σ(wᵢ × ΔMᵢ) / s(t)^α               │
│                                              │
│  V-Index 계산                               │
│  V = (M - T) × (1 + s)^t                    │
│                                              │
│  퍼포먼스 공식                              │
│  P = (M × I × A) / R                        │
└─────────────────────────────────────────────┘
```

### 변수 설명 툴팁
```
V = (M - T) × (1 + s)^t
     │    │       │   │
     │    │       │   └── 시간 (개월)
     │    │       └────── 만족도 지수 (0~1)
     │    └────────────── 비용 (Tax)
     └─────────────────── 매출 (Mint)
```

---

## 📎 부록

### A. 기술 스택
- **Frontend:** React 18, Vite, Tailwind CSS, Framer Motion
- **Backend:** Next.js API Routes (Vercel)
- **Database:** Supabase (PostgreSQL)
- **Automation:** n8n
- **Hosting:** Vercel (Seoul Region)

### B. API 엔드포인트
| Endpoint | Method | 설명 |
|----------|--------|------|
| `/api/physics` | GET | 물리 엔진 상태 |
| `/api/leaderboard` | GET | V-Index 랭킹 |
| `/api/consensus` | GET | 솔루션 랭킹 |
| `/api/organisms` | GET | 조직 데이터 |
| `/api/rewards` | GET | 보상 내역 |

### C. 주요 Supabase 테이블
| 테이블 | 설명 |
|--------|------|
| `relational_nodes` | 노드 간 관계 정의 |
| `interaction_logs` | 현장 반응 데이터 |
| `physics_metrics` | 실시간 물리 변수 |
| `risk_queue` | 위기 관리 큐 |
| `asset_valuation` | 복리 증식 가치 |

---

*문서 버전: 2.0.0*  
*최종 업데이트: 2026-01-24*  
*https://autus-ai.com*
