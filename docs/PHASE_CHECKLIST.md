# 🔐 올댓바스켓 개발 단계 체크리스트

> Human → Shadow → Auto (LOCKED)

---

## PHASE 0 — 철학·구조 잠금 ✅

| 체크 | 항목 | 상태 |
|------|------|------|
| ✅ | Fact 테이블 = Payment + Attendance 뿐 | 완료 |
| ✅ | 등록/상담/메모/수기수정 테이블 없음 | 완료 (002_phase0_lock.sql) |
| ✅ | 모든 변경 → Event/Intervention Log | 완료 |
| ✅ | notes 필드 제거 | 완료 |
| ✅ | atb_feedback 테이블 삭제 | 완료 |

**통과 조건**: "임시로 추가"할 수 있는 필드가 하나도 없음 ✅

---

## PHASE 1 — HUMAN (현재 단계) 🟡

> 사람이 하고, 시스템은 기록만

### 1-1. Fact 기록

| 체크 | 항목 | 파일 |
|------|------|------|
| ✅ | 결제 성공/실패 → /payments | payment-webhook/index.ts |
| ✅ | 출석 → /attendance/scan(QR) | attendance-chain/index.ts |
| ⏳ | 수기 출석/수정 경로 차단 | 002_phase0_lock.sql |

### 1-2. 개입 기록 (가장 중요!)

| 체크 | 항목 | 파일 |
|------|------|------|
| ✅ | 매니저 "손댄 순간" 감지 | intervention-detector.js |
| ✅ | 수동 메시지 발송 감지 | detectManualMessage() |
| ✅ | 반 이동 시 개입 로그 | detectClassChange() |
| ✅ | 상태 변경 시 개입 로그 | detectStatusChange() |
| ⏳ | Telegram "오늘 N건 개입" 리포트 | getTelegramInterventionReport() |

### PHASE 1 완료 조건

| 항목 | 기준 | 현재 |
|------|------|------|
| 운영 | 불편해도 정상 | ⏳ |
| 로그 | 완전 (누락 0) | ⏳ |
| 자동화 | 0건 | ✅ |

---

## PHASE 2 — SHADOW (대기 중) ⚪

> 시스템이 판단하지만 실행 안 함

### 진입 조건
- [ ] PHASE 1 최소 7일 운영
- [ ] Intervention Log 30건 이상
- [ ] 로그 기반 패턴 분석 가능

### 체크리스트
| 체크 | 항목 |
|------|------|
| ⬜ | 결제 실패 시 "리마인드 했을 것" 로그 생성 |
| ⬜ | 연속 미출석 시 "보호모드 진입 후보" 로그 생성 |
| ⬜ | QR 실패 급증 시 "윈도우 조정 후보" 로그 생성 |
| ⬜ | Shadow 제안 정확도 ≥ 70% |

### 완료 조건
- Shadow 제안 정확도 ≥ 70%
- 운영자가 "대체로 맞다"고 느끼는 수준
- 자동 실행 0건

---

## PHASE 3 — AUTO (대기 중) ⚪

> 저위험 자동 실행

### 진입 조건
- [ ] PHASE 2 Shadow 정확도 70% 이상
- [ ] 운영자 승인

### 허용 액션
| 액션 | AUTO 가능 |
|------|----------|
| 결제 리마인드 자동 발송 | ✅ |
| 출석 윈도우 ±조정 | ✅ |
| 보호모드 ON/OFF | ✅ |
| QR 장애 공지 | ✅ |

### 안전장치
| 체크 | 항목 |
|------|------|
| ⬜ | 모든 AUTO 실행이 /interventions에 기록 |
| ⬜ | Kill Switch 존재 |
| ⬜ | 동일 액션 반복 제한 |

---

## PHASE 4 — APPROVAL (대기 중) ⚪

> 고위험 자동 제안

### 승인 필요 액션
| 액션 | 승인 필수 |
|------|----------|
| 반/시간 변경 | ✅ |
| 강사 교체 | ✅ |
| 환불/연기 | ✅ |

---

## PHASE 5 — STABILIZE (대기 중) ⚪

> 자가 치유

### 체크리스트
| 체크 | 항목 |
|------|------|
| ⬜ | 임계값 자동 미세 조정 |
| ⬜ | 리마인드 타이밍 자동 튜닝 |
| ⬜ | 수동 개입 증가 시 자동 경고 |

---

## PHASE 6 — LOCK (최종 목표) ⚪

> 무인 운영 가능 상태

### 체크리스트
| 체크 | 항목 |
|------|------|
| ⬜ | AUTO 중단 없이 30일 운영 |
| ⬜ | 신규 인원 투입 시 교육 불필요 |
| ⬜ | 예외 발생 시 Approval로만 처리 |

### 최종 통과 조건

> 사람이 "운영을 하고 있다"는 느낌이 사라지고
> 시스템이 "알아서 돌아간다"는 느낌이 들면 성공

---

## ❌ 중단 기준 (어느 단계든)

다음 중 하나라도 발생하면 **즉시 중단**:

1. 수기 입력 경로가 발견됨
2. notes/메모 필드가 사용됨
3. Intervention Log 없이 상태 변경됨
4. QR 외 출석 입력 발생
5. 웹훅 외 결제 입력 발생

---

## 📊 현재 상태

```
PHASE 0: ████████████████████ 100% ✅ 잠금 완료
PHASE 1: ██████░░░░░░░░░░░░░░  30% 🟡 진행 중
PHASE 2: ░░░░░░░░░░░░░░░░░░░░   0% ⚪ 대기
PHASE 3: ░░░░░░░░░░░░░░░░░░░░   0% ⚪ 대기
PHASE 4: ░░░░░░░░░░░░░░░░░░░░   0% ⚪ 대기
PHASE 5: ░░░░░░░░░░░░░░░░░░░░   0% ⚪ 대기
PHASE 6: ░░░░░░░░░░░░░░░░░░░░   0% ⚪ 대기
```

---

## 🔒 최종 잠금 문장

> 올댓바스켓은
> 기능을 만드는 프로젝트가 아니라
> **'사람의 일을 없애는 순서'**를 설계하는 프로젝트다.
