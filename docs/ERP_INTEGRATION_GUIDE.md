# AUTUS x 실제 ERP 연동 전략
## 5가지 성공 사례 기반 구현 아키텍처

---

## 📊 사례 비교

| 사례 | 규모 | ERP | 연동 방식 | AUTUS 적합도 | 비용 | 시간 |
|------|------|-----|---------|------------|------|------|
| **1번** | 200명 | 나라핵 | n8n + CSV 배치 | ⭐⭐⭐⭐⭐ | 월 3~5만원 | 3~5일 |
| **2번** | 150명 | ACA2000 | Excel → Sheets → n8n | ⭐⭐⭐⭐ | 초기 0 | 5~7일 |
| **3번** | 80명 | 클래스팅 | REST API + OAuth | ⭐⭐⭐⭐⭐ | 0 | 2~4일 |
| **4번** | 300명 | 통통통 | CSV + n8n Schedule | ⭐⭐⭐⭐ | 월 3만원 | 4~6일 |
| **5번** | 120명 | 스마트핏 | CSV → Supabase | ⭐⭐⭐⭐ | 0 | 3~5일 |

**추천**: 1번(나라핵) + 3번(클래스팅) 혼합 (한국 학원 80% 사용)

---

## 🏆 사례 1: 나라핵 ERP (200명 규모)

### 데이터 흐름

```
나라핵 ERP → CSV 내보내기 (매일 새벽)
    ↓
로컬 서버 → n8n 워크플로우
    ↓
Supabase + Claude 분석
    ↓
AUTUS UI + 원장 알림톡
```

### 나라핵 CSV 스키마

```csv
학생ID,학생명,보호자명,보호자폰,학년,과목,등록금,미납액,최근출석,지난달출석,숙제제출율
S001,김OO,김엄마,010-1234-5678,중2,수학,800000,0,2024-01-21,85%,90%
S002,이OO,이엄마,010-2345-6789,고1,영어,1000000,150000,2024-01-20,70%,75%
```

### n8n 워크플로우

```yaml
trigger: cron "0 2 * * *"  # 매일 새벽 2시

steps:
  1. CSV 파일 읽기 (EUC-KR)
  2. 데이터 정규화
  3. 위험도 계산:
     - 미납액 > 300,000 → +150점
     - 출석률 < 50% → +150점
     - 숙제제출율 < 50% → +100점
  4. Supabase UPSERT
  5. 원장 알림톡 발송
```

### 구현 일정: 4~5일

---

## 🏆 사례 3: 클래스팅 (80명 규모) — **추천**

### 데이터 흐름 (실시간)

```
클래스팅 API → Webhook (실시간)
    ↓
AUTUS Webhook 리스너
    ↓
Supabase → V-Pulse 즉시 계산
    ↓
AUTUS UI (WebSocket 실시간)
```

### OAuth 연동

```typescript
// 1. 인증 코드 → Access Token
const { access_token } = await fetch('https://www.classting.com/api/oauth/token', {
  method: 'POST',
  body: JSON.stringify({
    grant_type: 'authorization_code',
    code,
    client_id: process.env.CLASSTIN_CLIENT_ID,
    client_secret: process.env.CLASSTIN_CLIENT_SECRET,
  })
});

// 2. 토큰 저장
await supabase.from('academy_integrations').upsert({
  academy_id: 'demo-academy',
  provider: 'classtin',
  access_token: encryptToken(access_token),
});
```

### Webhook 이벤트

| 이벤트 | 설명 | AUTUS 신호 |
|--------|------|-----------|
| `attendance.checked` | 출석 체크 | 출석률 저하 감지 |
| `assignment.submitted` | 과제 제출 | 미제출 카운트 |
| `grade.updated` | 성적 입력 | 성적 변화 감지 |
| `feedback.added` | 학부모 피드백 | 감정 분석 |

### 구현 일정: 2~4일 (가장 빠름!)

---

## 🏗️ 통합 아키텍처

```
┌─────────────────────────────────────────────────────────┐
│              학원 ERP 통합 Hub                           │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  CSV 배치 (나라핵)     API 실시간 (클래스팅)          │
│       ↓                      ↓                         │
│  n8n Workflow          Webhook Listener               │
│                                                         │
│       └──────────────────┬──────────────────┘          │
│                          ↓                             │
│                     Supabase                           │
│                          ↓                             │
│            ┌─────────────┴─────────────┐               │
│            ↓                           ↓               │
│       V-Pulse 계산              신호 감지             │
│            │                           │               │
│            └─────────────┬─────────────┘               │
│                          ↓                             │
│                  AUTUS Reward Center                   │
│                  (D/E/F 고정 통합)                     │
│                          ↓                             │
│                   AUTUS FSD UI                         │
│                          ↓                             │
│              원장 승인 → 카드 발송                     │
└─────────────────────────────────────────────────────────┘
```

---

## 🎯 파일럿 학원 선택 기준

### 추천: 클래스팅 + 나라핵 조합

| 기준 | 클래스팅 | 나라핵 | 조합 점수 |
|------|---------|--------|---------|
| 구현 속도 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 비용 | 무료 | 월 3~5만원 | 매우 저가 |
| 데이터 품질 | 실시간 | 일배치 | 상호보완 |
| 한국 시장 점유율 | 50% | 30% | 80% 커버 |

### 조건
- 규모: 100~200명
- 시스템: 클래스팅 + 나라핵 둘 다 사용
- 원장: 기술에 개방적
- 기간: 4주 (최소)

---

## 📅 배포 일정

### Week 1: 통합 설계 & 개발

| Day | Task |
|-----|------|
| 1 | 파일럿 학원 선정 |
| 2-3 | n8n 워크플로우 (나라핵 CSV) |
| 4 | 클래스팅 OAuth 연동 |
| 5-6 | Webhook 리스너 & V-Pulse |
| 7 | 전체 통합 테스트 |

### Week 2: 파일럿 실행

| Day | Task |
|-----|------|
| 1 | 파일럿 학원 시스템 셋업 |
| 2-3 | 실제 데이터로 테스트 |
| 4-5 | 원장 피드백 수집 & 개선 |
| 6-7 | GO-LIVE |

---

## 💰 비용 & 시간 예상

### 개발 비용

| 항목 | 비용 |
|------|------|
| 개발자 임금 | 2주 × ₩200만 = ₩400만 |
| 클래스팅 API | 무료 |
| n8n 호스팅 | 월 ₩5만 |
| Supabase | 월 ₩10만 |
| **총 초기 비용** | **₩400만** |
| **월간 운영비** | **₩15만** |

### 시간 투입

| 항목 | 시간 |
|------|------|
| 아키텍처 설계 | 1일 |
| n8n 개발 | 2~3일 |
| AUTUS 통합 | 2일 |
| 테스트 & QA | 1일 |
| 원장 교육 | 0.5일 |
| **총 소요** | **6.5일** |

---

## ✅ 즉시 실행 Checklist

### Week 1 (이번주)
- [ ] 파일럿 학원 3곳 컨택
- [ ] 클래스팅 개발자 계정 신청
- [ ] n8n 프로젝트 생성
- [ ] Supabase 테이블 스키마 확정

### Week 2 (다음주)
- [ ] n8n 워크플로우 완성 & 테스트
- [ ] 클래스팅 Webhook 리스너 구현
- [ ] AUTUS FSD UI 실시간 연결
- [ ] 파일럿 학원 선정 확정

### Week 3 (1주일 후)
- [ ] 파일럿 학원 GO-LIVE
- [ ] 실제 데이터 흐름 모니터링
- [ ] 원장 피드백 수집
- [ ] 필요시 즉시 패치

---

## 🎯 최종 권고

### 1순위: 클래스팅 API 연동 (추천)
- **이유**: 실시간, 무료, 빠른 구현
- **시간**: 2~4일
- **위험**: 낮음

### 2순위: 나라핵 n8n 연동 (병행)
- **이유**: CSV 안정성, 자동화, 한국 점유율
- **시간**: 3~5일
- **위험**: 중간

### 3순위: Excel/Google Sheets (폴백)
- **이유**: 모든 학원 가능
- **시간**: 1주
- **위험**: 수동 의존성

**결론**: 클래스팅 우선 → 나라핵 추가 → 2~3주내 완성 가능

---

**Let's Go! 🚀**
